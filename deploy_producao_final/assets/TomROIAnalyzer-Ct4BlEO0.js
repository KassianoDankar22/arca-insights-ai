import{j as o}from"./supabase-vendor-vwXl956e.js";import{R as W,r as D,e as ts}from"./react-vendor-DZvRB87w.js";import{j as fa,C as qe,d as Ht,A as $t,D as ha,t as Ie,F as as,e as st,R as ss,l as rs,g as pa,Z as ga,h as _a,B as Us,T as ns,a as Zs,b as Bs,u as Ws,s as dt,E as xa}from"./index-Df_bSpit.js";import{I as Te}from"./input-BaSgXdNs.js";import{L as Ne}from"./label-DvsDVWlE.js";import{S as Hs,a as Ys,b as Ks,c as Gs,d as va}from"./select-DWYjgQBo.js";import{b as os,d as Js,c as Xs,P as is,e as Qs,f as er}from"./ui-vendor-Dea2Gxwc.js";import{u as tr}from"./index-v7iOeiPF.js";import{T as ar,a as sr,b as ya,c as ba}from"./tabs-CFPvKsOc.js";import{P as sa}from"./progress-UGcfPXjE.js";import{A as rr}from"./arrow-right-DCDztt1h.js";import{L as ls}from"./loader-circle-Dnz5ZzbO.js";import{a as nr,e as or}from"./arca-logo-BzVacjrL.js";import{C as ir}from"./clock-CpRAHura.js";import{S as lr}from"./star-MXFkqCwr.js";import{T as Yt}from"./trending-up-D6UT933U.js";import{A as Na}from"./arrow-down-right-DSoms3Ot.js";import{A as cr}from"./arrow-up-right-C5d9tMAX.js";import{C as ja}from"./calendar-CQNTrNBE.js";import{m as dr}from"./proxy-CqlErGxY.js";var Nt=t=>t.type==="checkbox",Xe=t=>t instanceof Date,Ae=t=>t==null;const cs=t=>typeof t=="object";var fe=t=>!Ae(t)&&!Array.isArray(t)&&cs(t)&&!Xe(t),ds=t=>fe(t)&&t.target?Nt(t.target)?t.target.checked:t.target.value:t,ur=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,us=(t,e)=>t.has(ur(e)),mr=t=>{const e=t.constructor&&t.constructor.prototype;return fe(e)&&e.hasOwnProperty("isPrototypeOf")},ra=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function xe(t){let e;const a=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(ra&&(t instanceof Blob||s))&&(a||fe(t)))if(e=a?[]:{},!a&&!mr(t))e=t;else for(const r in t)t.hasOwnProperty(r)&&(e[r]=xe(t[r]));else return t;return e}var Mt=t=>Array.isArray(t)?t.filter(Boolean):[],me=t=>t===void 0,A=(t,e,a)=>{if(!e||!fe(t))return a;const s=Mt(e.split(/[,[\].]+?/)).reduce((r,n)=>Ae(r)?r:r[n],t);return me(s)||s===t?me(t[e])?a:t[e]:s},ke=t=>typeof t=="boolean",na=t=>/^\w*$/.test(t),ms=t=>Mt(t.replace(/["|']|\]/g,"").split(/\.|\[/)),ee=(t,e,a)=>{let s=-1;const r=na(e)?[e]:ms(e),n=r.length,i=n-1;for(;++s<n;){const l=r[s];let d=a;if(s!==i){const m=t[l];d=fe(m)||Array.isArray(m)?m:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;t[l]=d,t=t[l]}};const Et={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Fe={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},De={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},fs=W.createContext(null),oa=()=>W.useContext(fs),fr=t=>{const{children:e,...a}=t;return W.createElement(fs.Provider,{value:a},e)};var hs=(t,e,a,s=!0)=>{const r={defaultValues:e._defaultValues};for(const n in t)Object.defineProperty(r,n,{get:()=>{const i=n;return e._proxyFormState[i]!==Fe.all&&(e._proxyFormState[i]=!s||Fe.all),a&&(a[i]=!0),t[i]}});return r};const ia=typeof window<"u"?D.useLayoutEffect:D.useEffect;function hr(t){const e=oa(),{control:a=e.control,disabled:s,name:r,exact:n}=t||{},[i,l]=W.useState(a._formState),d=W.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return ia(()=>a._subscribe({name:r,formState:d.current,exact:n,callback:m=>{!s&&l({...a._formState,...m})}}),[r,s,n]),W.useEffect(()=>{d.current.isValid&&a._setValid(!0)},[a]),W.useMemo(()=>hs(i,a,d.current,!1),[i,a])}var $e=t=>typeof t=="string",ps=(t,e,a,s,r)=>$e(t)?(s&&e.watch.add(t),A(a,t,r)):Array.isArray(t)?t.map(n=>(s&&e.watch.add(n),A(a,n))):(s&&(e.watchAll=!0),a);function pr(t){const e=oa(),{control:a=e.control,name:s,defaultValue:r,disabled:n,exact:i}=t||{},l=W.useRef(r),[d,m]=W.useState(a._getWatch(s,l.current));return ia(()=>a._subscribe({name:s,formState:{values:!0},exact:i,callback:h=>!n&&m(ps(s,a._names,h.values||a._formValues,!1,l.current))}),[s,a,n,i]),W.useEffect(()=>a._removeUnmounted()),d}function gr(t){const e=oa(),{name:a,disabled:s,control:r=e.control,shouldUnregister:n}=t,i=us(r._names.array,a),l=pr({control:r,name:a,defaultValue:A(r._formValues,a,A(r._defaultValues,a,t.defaultValue)),exact:!0}),d=hr({control:r,name:a,exact:!0}),m=W.useRef(t),h=W.useRef(r.register(a,{...t.rules,value:l,...ke(t.disabled)?{disabled:t.disabled}:{}})),x=W.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!A(d.errors,a)},isDirty:{enumerable:!0,get:()=>!!A(d.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!A(d.touchedFields,a)},isValidating:{enumerable:!0,get:()=>!!A(d.validatingFields,a)},error:{enumerable:!0,get:()=>A(d.errors,a)}}),[d,a]),g=W.useCallback(C=>h.current.onChange({target:{value:ds(C),name:a},type:Et.CHANGE}),[a]),I=W.useCallback(()=>h.current.onBlur({target:{value:A(r._formValues,a),name:a},type:Et.BLUR}),[a,r._formValues]),S=W.useCallback(C=>{const Z=A(r._fields,a);Z&&C&&(Z._f.ref={focus:()=>C.focus&&C.focus(),select:()=>C.select&&C.select(),setCustomValidity:R=>C.setCustomValidity(R),reportValidity:()=>C.reportValidity()})},[r._fields,a]),p=W.useMemo(()=>({name:a,value:l,...ke(s)||d.disabled?{disabled:d.disabled||s}:{},onChange:g,onBlur:I,ref:S}),[a,s,d.disabled,g,I,S,l]);return W.useEffect(()=>{const C=r._options.shouldUnregister||n;r.register(a,{...m.current.rules,...ke(m.current.disabled)?{disabled:m.current.disabled}:{}});const Z=(R,M)=>{const L=A(r._fields,R);L&&L._f&&(L._f.mount=M)};if(Z(a,!0),C){const R=xe(A(r._options.defaultValues,a));ee(r._defaultValues,a,R),me(A(r._formValues,a))&&ee(r._formValues,a,R)}return!i&&r.register(a),()=>{(i?C&&!r._state.action:C)?r.unregister(a):Z(a,!1)}},[a,r,i,n]),W.useEffect(()=>{r._setDisabledField({disabled:s,name:a})},[s,a,r]),W.useMemo(()=>({field:p,formState:d,fieldState:x}),[p,d,x])}const je=t=>t.render(gr(t));var gs=(t,e,a,s,r)=>e?{...a[t],types:{...a[t]&&a[t].types?a[t].types:{},[s]:r||!0}}:{},_t=t=>Array.isArray(t)?t:[t],Aa=()=>{let t=[];return{get observers(){return t},next:r=>{for(const n of t)n.next&&n.next(r)},subscribe:r=>(t.push(r),{unsubscribe:()=>{t=t.filter(n=>n!==r)}}),unsubscribe:()=>{t=[]}}},Kt=t=>Ae(t)||!cs(t);function Be(t,e){if(Kt(t)||Kt(e))return t===e;if(Xe(t)&&Xe(e))return t.getTime()===e.getTime();const a=Object.keys(t),s=Object.keys(e);if(a.length!==s.length)return!1;for(const r of a){const n=t[r];if(!s.includes(r))return!1;if(r!=="ref"){const i=e[r];if(Xe(n)&&Xe(i)||fe(n)&&fe(i)||Array.isArray(n)&&Array.isArray(i)?!Be(n,i):n!==i)return!1}}return!0}var we=t=>fe(t)&&!Object.keys(t).length,la=t=>t.type==="file",Pe=t=>typeof t=="function",St=t=>{if(!ra)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},_s=t=>t.type==="select-multiple",ca=t=>t.type==="radio",_r=t=>ca(t)||Nt(t),Ut=t=>St(t)&&t.isConnected;function xr(t,e){const a=e.slice(0,-1).length;let s=0;for(;s<a;)t=me(t)?s++:t[e[s++]];return t}function vr(t){for(const e in t)if(t.hasOwnProperty(e)&&!me(t[e]))return!1;return!0}function ge(t,e){const a=Array.isArray(e)?e:na(e)?[e]:ms(e),s=a.length===1?t:xr(t,a),r=a.length-1,n=a[r];return s&&delete s[n],r!==0&&(fe(s)&&we(s)||Array.isArray(s)&&vr(s))&&ge(t,a.slice(0,-1)),t}var xs=t=>{for(const e in t)if(Pe(t[e]))return!0;return!1};function Rt(t,e={}){const a=Array.isArray(t);if(fe(t)||a)for(const s in t)Array.isArray(t[s])||fe(t[s])&&!xs(t[s])?(e[s]=Array.isArray(t[s])?[]:{},Rt(t[s],e[s])):Ae(t[s])||(e[s]=!0);return e}function vs(t,e,a){const s=Array.isArray(t);if(fe(t)||s)for(const r in t)Array.isArray(t[r])||fe(t[r])&&!xs(t[r])?me(e)||Kt(a[r])?a[r]=Array.isArray(t[r])?Rt(t[r],[]):{...Rt(t[r])}:vs(t[r],Ae(e)?{}:e[r],a[r]):a[r]=!Be(t[r],e[r]);return a}var ut=(t,e)=>vs(t,e,Rt(e));const Ca={value:!1,isValid:!1},wa={value:!0,isValid:!0};var ys=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!me(t[0].attributes.value)?me(t[0].value)||t[0].value===""?wa:{value:t[0].value,isValid:!0}:wa:Ca}return Ca},bs=(t,{valueAsNumber:e,valueAsDate:a,setValueAs:s})=>me(t)?t:e?t===""?NaN:t&&+t:a&&$e(t)?new Date(t):s?s(t):t;const ka={isValid:!1,value:null};var Ns=t=>Array.isArray(t)?t.reduce((e,a)=>a&&a.checked&&!a.disabled?{isValid:!0,value:a.value}:e,ka):ka;function Ea(t){const e=t.ref;return la(e)?e.files:ca(e)?Ns(t.refs).value:_s(e)?[...e.selectedOptions].map(({value:a})=>a):Nt(e)?ys(t.refs).value:bs(me(e.value)?t.ref.value:e.value,t)}var yr=(t,e,a,s)=>{const r={};for(const n of t){const i=A(e,n);i&&ee(r,n,i._f)}return{criteriaMode:a,names:[...t],fields:r,shouldUseNativeValidation:s}},Tt=t=>t instanceof RegExp,mt=t=>me(t)?t:Tt(t)?t.source:fe(t)?Tt(t.value)?t.value.source:t.value:t,Sa=t=>({isOnSubmit:!t||t===Fe.onSubmit,isOnBlur:t===Fe.onBlur,isOnChange:t===Fe.onChange,isOnAll:t===Fe.all,isOnTouch:t===Fe.onTouched});const Ra="AsyncFunction";var br=t=>!!t&&!!t.validate&&!!(Pe(t.validate)&&t.validate.constructor.name===Ra||fe(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Ra)),Nr=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Ta=(t,e,a)=>!a&&(e.watchAll||e.watch.has(t)||[...e.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const xt=(t,e,a,s)=>{for(const r of a||Object.keys(t)){const n=A(t,r);if(n){const{_f:i,...l}=n;if(i){if(i.refs&&i.refs[0]&&e(i.refs[0],r)&&!s)return!0;if(i.ref&&e(i.ref,i.name)&&!s)return!0;if(xt(l,e))break}else if(fe(l)&&xt(l,e))break}}};function Va(t,e,a){const s=A(t,a);if(s||na(a))return{error:s,name:a};const r=a.split(".");for(;r.length;){const n=r.join("."),i=A(e,n),l=A(t,n);if(i&&!Array.isArray(i)&&a!==n)return{name:a};if(l&&l.type)return{name:n,error:l};if(l&&l.root&&l.root.type)return{name:`${n}.root`,error:l.root};r.pop()}return{name:a}}var jr=(t,e,a,s)=>{a(t);const{name:r,...n}=t;return we(n)||Object.keys(n).length>=Object.keys(e).length||Object.keys(n).find(i=>e[i]===(!s||Fe.all))},Ar=(t,e,a)=>!t||!e||t===e||_t(t).some(s=>s&&(a?s===e:s.startsWith(e)||e.startsWith(s))),Cr=(t,e,a,s,r)=>r.isOnAll?!1:!a&&r.isOnTouch?!(e||t):(a?s.isOnBlur:r.isOnBlur)?!t:(a?s.isOnChange:r.isOnChange)?t:!0,wr=(t,e)=>!Mt(A(t,e)).length&&ge(t,e),kr=(t,e,a)=>{const s=_t(A(t,a));return ee(s,"root",e[a]),ee(t,a,s),t},wt=t=>$e(t);function Oa(t,e,a="validate"){if(wt(t)||Array.isArray(t)&&t.every(wt)||ke(t)&&!t)return{type:a,message:wt(t)?t:"",ref:e}}var tt=t=>fe(t)&&!Tt(t)?t:{value:t,message:""},Ia=async(t,e,a,s,r,n)=>{const{ref:i,refs:l,required:d,maxLength:m,minLength:h,min:x,max:g,pattern:I,validate:S,name:p,valueAsNumber:C,mount:Z}=t._f,R=A(a,p);if(!Z||e.has(p))return{};const M=l?l[0]:i,L=F=>{r&&M.reportValidity&&(M.setCustomValidity(ke(F)?"":F||""),M.reportValidity())},X={},he=ca(i),U=Nt(i),ye=he||U,le=(C||la(i))&&me(i.value)&&me(R)||St(i)&&i.value===""||R===""||Array.isArray(R)&&!R.length,_e=gs.bind(null,p,s,X),ne=(F,O,se,de=De.maxLength,te=De.minLength)=>{const b=F?O:se;X[p]={type:F?de:te,message:b,ref:i,..._e(F?de:te,b)}};if(n?!Array.isArray(R)||!R.length:d&&(!ye&&(le||Ae(R))||ke(R)&&!R||U&&!ys(l).isValid||he&&!Ns(l).isValid)){const{value:F,message:O}=wt(d)?{value:!!d,message:d}:tt(d);if(F&&(X[p]={type:De.required,message:O,ref:M,..._e(De.required,O)},!s))return L(O),X}if(!le&&(!Ae(x)||!Ae(g))){let F,O;const se=tt(g),de=tt(x);if(!Ae(R)&&!isNaN(R)){const te=i.valueAsNumber||R&&+R;Ae(se.value)||(F=te>se.value),Ae(de.value)||(O=te<de.value)}else{const te=i.valueAsDate||new Date(R),b=Y=>new Date(new Date().toDateString()+" "+Y),_=i.type=="time",V=i.type=="week";$e(se.value)&&R&&(F=_?b(R)>b(se.value):V?R>se.value:te>new Date(se.value)),$e(de.value)&&R&&(O=_?b(R)<b(de.value):V?R<de.value:te<new Date(de.value))}if((F||O)&&(ne(!!F,se.message,de.message,De.max,De.min),!s))return L(X[p].message),X}if((m||h)&&!le&&($e(R)||n&&Array.isArray(R))){const F=tt(m),O=tt(h),se=!Ae(F.value)&&R.length>+F.value,de=!Ae(O.value)&&R.length<+O.value;if((se||de)&&(ne(se,F.message,O.message),!s))return L(X[p].message),X}if(I&&!le&&$e(R)){const{value:F,message:O}=tt(I);if(Tt(F)&&!R.match(F)&&(X[p]={type:De.pattern,message:O,ref:i,..._e(De.pattern,O)},!s))return L(O),X}if(S){if(Pe(S)){const F=await S(R,a),O=Oa(F,M);if(O&&(X[p]={...O,..._e(De.validate,O.message)},!s))return L(O.message),X}else if(fe(S)){let F={};for(const O in S){if(!we(F)&&!s)break;const se=Oa(await S[O](R,a),M,O);se&&(F={...se,..._e(O,se.message)},L(se.message),s&&(X[p]=F))}if(!we(F)&&(X[p]={ref:M,...F},!s))return X}}return L(!0),X};const Er={mode:Fe.onSubmit,reValidateMode:Fe.onChange,shouldFocusError:!0};function Sr(t={}){let e={...Er,...t},a={submitCount:0,isDirty:!1,isReady:!1,isLoading:Pe(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const s={};let r=fe(e.defaultValues)||fe(e.values)?xe(e.defaultValues||e.values)||{}:{},n=e.shouldUnregister?{}:xe(r),i={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},d,m=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let x={...h};const g={array:Aa(),state:Aa()},I=e.criteriaMode===Fe.all,S=c=>u=>{clearTimeout(m),m=setTimeout(c,u)},p=async c=>{if(!e.disabled&&(h.isValid||x.isValid||c)){const u=e.resolver?we((await U()).errors):await le(s,!0);u!==a.isValid&&g.state.next({isValid:u})}},C=(c,u)=>{!e.disabled&&(h.isValidating||h.validatingFields||x.isValidating||x.validatingFields)&&((c||Array.from(l.mount)).forEach(f=>{f&&(u?ee(a.validatingFields,f,u):ge(a.validatingFields,f))}),g.state.next({validatingFields:a.validatingFields,isValidating:!we(a.validatingFields)}))},Z=(c,u=[],f,N,j=!0,y=!0)=>{if(N&&f&&!e.disabled){if(i.action=!0,y&&Array.isArray(A(s,c))){const T=f(A(s,c),N.argA,N.argB);j&&ee(s,c,T)}if(y&&Array.isArray(A(a.errors,c))){const T=f(A(a.errors,c),N.argA,N.argB);j&&ee(a.errors,c,T),wr(a.errors,c)}if((h.touchedFields||x.touchedFields)&&y&&Array.isArray(A(a.touchedFields,c))){const T=f(A(a.touchedFields,c),N.argA,N.argB);j&&ee(a.touchedFields,c,T)}(h.dirtyFields||x.dirtyFields)&&(a.dirtyFields=ut(r,n)),g.state.next({name:c,isDirty:ne(c,u),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else ee(n,c,u)},R=(c,u)=>{ee(a.errors,c,u),g.state.next({errors:a.errors})},M=c=>{a.errors=c,g.state.next({errors:a.errors,isValid:!1})},L=(c,u,f,N)=>{const j=A(s,c);if(j){const y=A(n,c,me(f)?A(r,c):f);me(y)||N&&N.defaultChecked||u?ee(n,c,u?y:Ea(j._f)):se(c,y),i.mount&&p()}},X=(c,u,f,N,j)=>{let y=!1,T=!1;const ae={name:c};if(!e.disabled){if(!f||N){(h.isDirty||x.isDirty)&&(T=a.isDirty,a.isDirty=ae.isDirty=ne(),y=T!==ae.isDirty);const oe=Be(A(r,c),u);T=!!A(a.dirtyFields,c),oe?ge(a.dirtyFields,c):ee(a.dirtyFields,c,!0),ae.dirtyFields=a.dirtyFields,y=y||(h.dirtyFields||x.dirtyFields)&&T!==!oe}if(f){const oe=A(a.touchedFields,c);oe||(ee(a.touchedFields,c,f),ae.touchedFields=a.touchedFields,y=y||(h.touchedFields||x.touchedFields)&&oe!==f)}y&&j&&g.state.next(ae)}return y?ae:{}},he=(c,u,f,N)=>{const j=A(a.errors,c),y=(h.isValid||x.isValid)&&ke(u)&&a.isValid!==u;if(e.delayError&&f?(d=S(()=>R(c,f)),d(e.delayError)):(clearTimeout(m),d=null,f?ee(a.errors,c,f):ge(a.errors,c)),(f?!Be(j,f):j)||!we(N)||y){const T={...N,...y&&ke(u)?{isValid:u}:{},errors:a.errors,name:c};a={...a,...T},g.state.next(T)}},U=async c=>{C(c,!0);const u=await e.resolver(n,e.context,yr(c||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return C(c),u},ye=async c=>{const{errors:u}=await U(c);if(c)for(const f of c){const N=A(u,f);N?ee(a.errors,f,N):ge(a.errors,f)}else a.errors=u;return u},le=async(c,u,f={valid:!0})=>{for(const N in c){const j=c[N];if(j){const{_f:y,...T}=j;if(y){const ae=l.array.has(y.name),oe=j._f&&br(j._f);oe&&h.validatingFields&&C([N],!0);const Re=await Ia(j,l.disabled,n,I,e.shouldUseNativeValidation&&!u,ae);if(oe&&h.validatingFields&&C([N]),Re[y.name]&&(f.valid=!1,u))break;!u&&(A(Re,y.name)?ae?kr(a.errors,Re,y.name):ee(a.errors,y.name,Re[y.name]):ge(a.errors,y.name))}!we(T)&&await le(T,u,f)}}return f.valid},_e=()=>{for(const c of l.unMount){const u=A(s,c);u&&(u._f.refs?u._f.refs.every(f=>!Ut(f)):!Ut(u._f.ref))&&lt(c)}l.unMount=new Set},ne=(c,u)=>!e.disabled&&(c&&u&&ee(n,c,u),!Be(Y(),r)),F=(c,u,f)=>ps(c,l,{...i.mount?n:me(u)?r:$e(c)?{[c]:u}:u},f,u),O=c=>Mt(A(i.mount?n:r,c,e.shouldUnregister?A(r,c,[]):[])),se=(c,u,f={})=>{const N=A(s,c);let j=u;if(N){const y=N._f;y&&(!y.disabled&&ee(n,c,bs(u,y)),j=St(y.ref)&&Ae(u)?"":u,_s(y.ref)?[...y.ref.options].forEach(T=>T.selected=j.includes(T.value)):y.refs?Nt(y.ref)?y.refs.forEach(T=>{(!T.defaultChecked||!T.disabled)&&(Array.isArray(j)?T.checked=!!j.find(ae=>ae===T.value):T.checked=j===T.value||!!j)}):y.refs.forEach(T=>T.checked=T.value===j):la(y.ref)?y.ref.value="":(y.ref.value=j,y.ref.type||g.state.next({name:c,values:xe(n)})))}(f.shouldDirty||f.shouldTouch)&&X(c,j,f.shouldTouch,f.shouldDirty,!0),f.shouldValidate&&V(c)},de=(c,u,f)=>{for(const N in u){if(!u.hasOwnProperty(N))return;const j=u[N],y=c+"."+N,T=A(s,y);(l.array.has(c)||fe(j)||T&&!T._f)&&!Xe(j)?de(y,j,f):se(y,j,f)}},te=(c,u,f={})=>{const N=A(s,c),j=l.array.has(c),y=xe(u);ee(n,c,y),j?(g.array.next({name:c,values:xe(n)}),(h.isDirty||h.dirtyFields||x.isDirty||x.dirtyFields)&&f.shouldDirty&&g.state.next({name:c,dirtyFields:ut(r,n),isDirty:ne(c,y)})):N&&!N._f&&!Ae(y)?de(c,y,f):se(c,y,f),Ta(c,l)&&g.state.next({...a}),g.state.next({name:i.mount?c:void 0,values:xe(n)})},b=async c=>{i.mount=!0;const u=c.target;let f=u.name,N=!0;const j=A(s,f),y=oe=>{N=Number.isNaN(oe)||Xe(oe)&&isNaN(oe.getTime())||Be(oe,A(n,f,oe))},T=Sa(e.mode),ae=Sa(e.reValidateMode);if(j){let oe,Re;const Ct=u.type?Ea(j._f):ds(c),Ue=c.type===Et.BLUR||c.type===Et.FOCUS_OUT,Ds=!Nr(j._f)&&!e.resolver&&!A(a.errors,f)&&!j._f.deps||Cr(Ue,A(a.touchedFields,f),a.isSubmitted,ae,T),qt=Ta(f,l,Ue);ee(n,f,Ct),Ue?(j._f.onBlur&&j._f.onBlur(c),d&&d(0)):j._f.onChange&&j._f.onChange(c);const zt=X(f,Ct,Ue),qs=!we(zt)||qt;if(!Ue&&g.state.next({name:f,type:c.type,values:xe(n)}),Ds)return(h.isValid||x.isValid)&&(e.mode==="onBlur"?Ue&&p():Ue||p()),qs&&g.state.next({name:f,...qt?{}:zt});if(!Ue&&qt&&g.state.next({...a}),e.resolver){const{errors:ua}=await U([f]);if(y(Ct),N){const zs=Va(a.errors,s,f),ma=Va(ua,s,zs.name||f);oe=ma.error,f=ma.name,Re=we(ua)}}else C([f],!0),oe=(await Ia(j,l.disabled,n,I,e.shouldUseNativeValidation))[f],C([f]),y(Ct),N&&(oe?Re=!1:(h.isValid||x.isValid)&&(Re=await le(s,!0)));N&&(j._f.deps&&V(j._f.deps),he(f,Re,oe,zt))}},_=(c,u)=>{if(A(a.errors,u)&&c.focus)return c.focus(),1},V=async(c,u={})=>{let f,N;const j=_t(c);if(e.resolver){const y=await ye(me(c)?c:j);f=we(y),N=c?!j.some(T=>A(y,T)):f}else c?(N=(await Promise.all(j.map(async y=>{const T=A(s,y);return await le(T&&T._f?{[y]:T}:T)}))).every(Boolean),!(!N&&!a.isValid)&&p()):N=f=await le(s);return g.state.next({...!$e(c)||(h.isValid||x.isValid)&&f!==a.isValid?{}:{name:c},...e.resolver||!c?{isValid:f}:{},errors:a.errors}),u.shouldFocus&&!N&&xt(s,_,c?j:l.mount),N},Y=c=>{const u={...i.mount?n:r};return me(c)?u:$e(c)?A(u,c):c.map(f=>A(u,f))},ue=(c,u)=>({invalid:!!A((u||a).errors,c),isDirty:!!A((u||a).dirtyFields,c),error:A((u||a).errors,c),isValidating:!!A(a.validatingFields,c),isTouched:!!A((u||a).touchedFields,c)}),K=c=>{c&&_t(c).forEach(u=>ge(a.errors,u)),g.state.next({errors:c?a.errors:{}})},G=(c,u,f)=>{const N=(A(s,c,{_f:{}})._f||{}).ref,j=A(a.errors,c)||{},{ref:y,message:T,type:ae,...oe}=j;ee(a.errors,c,{...oe,...u,ref:N}),g.state.next({name:c,errors:a.errors,isValid:!1}),f&&f.shouldFocus&&N&&N.focus&&N.focus()},Le=(c,u)=>Pe(c)?g.state.subscribe({next:f=>c(F(void 0,u),f)}):F(c,u,!0),jt=c=>g.state.subscribe({next:u=>{Ar(c.name,u.name,c.exact)&&jr(u,c.formState||h,Oe,c.reRenderRoot)&&c.callback({values:{...n},...a,...u})}}).unsubscribe,Dt=c=>(i.mount=!0,x={...x,...c.formState},jt({...c,formState:x})),lt=(c,u={})=>{for(const f of c?_t(c):l.mount)l.mount.delete(f),l.array.delete(f),u.keepValue||(ge(s,f),ge(n,f)),!u.keepError&&ge(a.errors,f),!u.keepDirty&&ge(a.dirtyFields,f),!u.keepTouched&&ge(a.touchedFields,f),!u.keepIsValidating&&ge(a.validatingFields,f),!e.shouldUnregister&&!u.keepDefaultValue&&ge(r,f);g.state.next({values:xe(n)}),g.state.next({...a,...u.keepDirty?{isDirty:ne()}:{}}),!u.keepIsValid&&p()},At=({disabled:c,name:u})=>{(ke(c)&&i.mount||c||l.disabled.has(u))&&(c?l.disabled.add(u):l.disabled.delete(u))},et=(c,u={})=>{let f=A(s,c);const N=ke(u.disabled)||ke(e.disabled);return ee(s,c,{...f||{},_f:{...f&&f._f?f._f:{ref:{name:c}},name:c,mount:!0,...u}}),l.mount.add(c),f?At({disabled:ke(u.disabled)?u.disabled:e.disabled,name:c}):L(c,!0,u.value),{...N?{disabled:u.disabled||e.disabled}:{},...e.progressive?{required:!!u.required,min:mt(u.min),max:mt(u.max),minLength:mt(u.minLength),maxLength:mt(u.maxLength),pattern:mt(u.pattern)}:{},name:c,onChange:b,onBlur:b,ref:j=>{if(j){et(c,u),f=A(s,c);const y=me(j.value)&&j.querySelectorAll&&j.querySelectorAll("input,select,textarea")[0]||j,T=_r(y),ae=f._f.refs||[];if(T?ae.find(oe=>oe===y):y===f._f.ref)return;ee(s,c,{_f:{...f._f,...T?{refs:[...ae.filter(Ut),y,...Array.isArray(A(r,c))?[{}]:[]],ref:{type:y.type,name:c}}:{ref:y}}}),L(c,!1,void 0,y)}else f=A(s,c,{}),f._f&&(f._f.mount=!1),(e.shouldUnregister||u.shouldUnregister)&&!(us(l.array,c)&&i.action)&&l.unMount.add(c)}}},ct=()=>e.shouldFocusError&&xt(s,_,l.mount),Ge=c=>{ke(c)&&(g.state.next({disabled:c}),xt(s,(u,f)=>{const N=A(s,f);N&&(u.disabled=N._f.disabled||c,Array.isArray(N._f.refs)&&N._f.refs.forEach(j=>{j.disabled=N._f.disabled||c}))},0,!1))},z=(c,u)=>async f=>{let N;f&&(f.preventDefault&&f.preventDefault(),f.persist&&f.persist());let j=xe(n);if(g.state.next({isSubmitting:!0}),e.resolver){const{errors:y,values:T}=await U();a.errors=y,j=T}else await le(s);if(l.disabled.size)for(const y of l.disabled)ee(j,y,void 0);if(ge(a.errors,"root"),we(a.errors)){g.state.next({errors:{}});try{await c(j,f)}catch(y){N=y}}else u&&await u({...a.errors},f),ct(),setTimeout(ct);if(g.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:we(a.errors)&&!N,submitCount:a.submitCount+1,errors:a.errors}),N)throw N},B=(c,u={})=>{A(s,c)&&(me(u.defaultValue)?te(c,xe(A(r,c))):(te(c,u.defaultValue),ee(r,c,xe(u.defaultValue))),u.keepTouched||ge(a.touchedFields,c),u.keepDirty||(ge(a.dirtyFields,c),a.isDirty=u.defaultValue?ne(c,xe(A(r,c))):ne()),u.keepError||(ge(a.errors,c),h.isValid&&p()),g.state.next({...a}))},Q=(c,u={})=>{const f=c?xe(c):r,N=xe(f),j=we(c),y=j?r:N;if(u.keepDefaultValues||(r=f),!u.keepValues){if(u.keepDirtyValues){const T=new Set([...l.mount,...Object.keys(ut(r,n))]);for(const ae of Array.from(T))A(a.dirtyFields,ae)?ee(y,ae,A(n,ae)):te(ae,A(y,ae))}else{if(ra&&me(c))for(const T of l.mount){const ae=A(s,T);if(ae&&ae._f){const oe=Array.isArray(ae._f.refs)?ae._f.refs[0]:ae._f.ref;if(St(oe)){const Re=oe.closest("form");if(Re){Re.reset();break}}}}for(const T of l.mount)te(T,A(y,T))}n=xe(y),g.array.next({values:{...y}}),g.state.next({values:{...y}})}l={mount:u.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!h.isValid||!!u.keepIsValid||!!u.keepDirtyValues,i.watch=!!e.shouldUnregister,g.state.next({submitCount:u.keepSubmitCount?a.submitCount:0,isDirty:j?!1:u.keepDirty?a.isDirty:!!(u.keepDefaultValues&&!Be(c,r)),isSubmitted:u.keepIsSubmitted?a.isSubmitted:!1,dirtyFields:j?{}:u.keepDirtyValues?u.keepDefaultValues&&n?ut(r,n):a.dirtyFields:u.keepDefaultValues&&c?ut(r,c):u.keepDirty?a.dirtyFields:{},touchedFields:u.keepTouched?a.touchedFields:{},errors:u.keepErrors?a.errors:{},isSubmitSuccessful:u.keepIsSubmitSuccessful?a.isSubmitSuccessful:!1,isSubmitting:!1})},re=(c,u)=>Q(Pe(c)?c(n):c,u),ce=(c,u={})=>{const f=A(s,c),N=f&&f._f;if(N){const j=N.refs?N.refs[0]:N.ref;j.focus&&(j.focus(),u.shouldSelect&&Pe(j.select)&&j.select())}},Oe=c=>{a={...a,...c}},be={control:{register:et,unregister:lt,getFieldState:ue,handleSubmit:z,setError:G,_subscribe:jt,_runSchema:U,_focusError:ct,_getWatch:F,_getDirty:ne,_setValid:p,_setFieldArray:Z,_setDisabledField:At,_setErrors:M,_getFieldArray:O,_reset:Q,_resetDefaultValues:()=>Pe(e.defaultValues)&&e.defaultValues().then(c=>{re(c,e.resetOptions),g.state.next({isLoading:!1})}),_removeUnmounted:_e,_disableForm:Ge,_subjects:g,_proxyFormState:h,get _fields(){return s},get _formValues(){return n},get _state(){return i},set _state(c){i=c},get _defaultValues(){return r},get _names(){return l},set _names(c){l=c},get _formState(){return a},get _options(){return e},set _options(c){e={...e,...c}}},subscribe:Dt,trigger:V,register:et,handleSubmit:z,watch:Le,setValue:te,getValues:Y,reset:re,resetField:B,clearErrors:K,unregister:lt,setError:G,setFocus:ce,getFieldState:ue};return{...be,formControl:be}}function js(t={}){const e=W.useRef(void 0),a=W.useRef(void 0),[s,r]=W.useState({isDirty:!1,isValidating:!1,isLoading:Pe(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Pe(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:Sr(t),formState:s},t.formControl&&t.defaultValues&&!Pe(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const n=e.current.control;return n._options=t,ia(()=>{const i=n._subscribe({formState:n._proxyFormState,callback:()=>r({...n._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),n._formState.isReady=!0,i},[n]),W.useEffect(()=>n._disableForm(t.disabled),[n,t.disabled]),W.useEffect(()=>{t.mode&&(n._options.mode=t.mode),t.reValidateMode&&(n._options.reValidateMode=t.reValidateMode)},[n,t.mode,t.reValidateMode]),W.useEffect(()=>{t.errors&&(n._setErrors(t.errors),n._focusError())},[n,t.errors]),W.useEffect(()=>{t.shouldUnregister&&n._subjects.state.next({values:n._getWatch()})},[n,t.shouldUnregister]),W.useEffect(()=>{if(n._proxyFormState.isDirty){const i=n._getDirty();i!==s.isDirty&&n._subjects.state.next({isDirty:i})}},[n,s.isDirty]),W.useEffect(()=>{t.values&&!Be(t.values,a.current)?(n._reset(t.values,n._options.resetOptions),a.current=t.values,r(i=>({...i}))):n._resetDefaultValues()},[n,t.values]),W.useEffect(()=>{n._state.mount||(n._setValid(),n._state.mount=!0),n._state.watch&&(n._state.watch=!1,n._subjects.state.next({...n._formState})),n._removeUnmounted()}),e.current.formState=hs(s,n),e.current}const Fa=(t,e,a)=>{if(t&&"reportValidity"in t){const s=A(a,e);t.setCustomValidity(s&&s.message||""),t.reportValidity()}},As=(t,e)=>{for(const a in e.fields){const s=e.fields[a];s&&s.ref&&"reportValidity"in s.ref?Fa(s.ref,a,t):s.refs&&s.refs.forEach(r=>Fa(r,a,t))}},Rr=(t,e)=>{e.shouldUseNativeValidation&&As(t,e);const a={};for(const s in t){const r=A(e.fields,s),n=Object.assign(t[s]||{},{ref:r&&r.ref});if(Tr(e.names||Object.keys(t),s)){const i=Object.assign({},A(a,s));ee(i,"root",n),ee(a,s,i)}else ee(a,s,n)}return a},Tr=(t,e)=>t.some(a=>a.startsWith(e+"."));var Vr=function(t,e){for(var a={};t.length;){var s=t[0],r=s.code,n=s.message,i=s.path.join(".");if(!a[i])if("unionErrors"in s){var l=s.unionErrors[0].errors[0];a[i]={message:l.message,type:l.code}}else a[i]={message:n,type:r};if("unionErrors"in s&&s.unionErrors.forEach(function(h){return h.errors.forEach(function(x){return t.push(x)})}),e){var d=a[i].types,m=d&&d[s.code];a[i]=gs(i,e,a,r,m?[].concat(m,s.message):s.message)}t.shift()}return a},Or=function(t,e,a){return a===void 0&&(a={}),function(s,r,n){try{return Promise.resolve(function(i,l){try{var d=Promise.resolve(t[a.mode==="sync"?"parse":"parseAsync"](s,e)).then(function(m){return n.shouldUseNativeValidation&&As({},n),{errors:{},values:a.raw?s:m}})}catch(m){return l(m)}return d&&d.then?d.then(void 0,l):d}(0,function(i){if(function(l){return Array.isArray(l==null?void 0:l.errors)}(i))return{values:{},errors:Rr(Vr(i.errors,!n.shouldUseNativeValidation&&n.criteriaMode==="all"),n)};throw i}))}catch(i){return Promise.reject(i)}}},J;(function(t){t.assertEqual=r=>{};function e(r){}t.assertIs=e;function a(r){throw new Error}t.assertNever=a,t.arrayToEnum=r=>{const n={};for(const i of r)n[i]=i;return n},t.getValidEnumValues=r=>{const n=t.objectKeys(r).filter(l=>typeof r[r[l]]!="number"),i={};for(const l of n)i[l]=r[l];return t.objectValues(i)},t.objectValues=r=>t.objectKeys(r).map(function(n){return r[n]}),t.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const n=[];for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&n.push(i);return n},t.find=(r,n)=>{for(const i of r)if(n(i))return i},t.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,n=" | "){return r.map(i=>typeof i=="string"?`'${i}'`:i).join(n)}t.joinValues=s,t.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n})(J||(J={}));var Pa;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Pa||(Pa={}));const k=J.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ze=t=>{switch(typeof t){case"undefined":return k.undefined;case"string":return k.string;case"number":return Number.isNaN(t)?k.nan:k.number;case"boolean":return k.boolean;case"function":return k.function;case"bigint":return k.bigint;case"symbol":return k.symbol;case"object":return Array.isArray(t)?k.array:t===null?k.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?k.promise:typeof Map<"u"&&t instanceof Map?k.map:typeof Set<"u"&&t instanceof Set?k.set:typeof Date<"u"&&t instanceof Date?k.date:k.object;default:return k.unknown}},v=J.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ze extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}format(e){const a=e||function(n){return n.message},s={_errors:[]},r=n=>{for(const i of n.issues)if(i.code==="invalid_union")i.unionErrors.map(r);else if(i.code==="invalid_return_type")r(i.returnTypeError);else if(i.code==="invalid_arguments")r(i.argumentsError);else if(i.path.length===0)s._errors.push(a(i));else{let l=s,d=0;for(;d<i.path.length;){const m=i.path[d];d===i.path.length-1?(l[m]=l[m]||{_errors:[]},l[m]._errors.push(a(i))):l[m]=l[m]||{_errors:[]},l=l[m],d++}}};return r(this),s}static assert(e){if(!(e instanceof ze))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,J.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){const a={},s=[];for(const r of this.issues)r.path.length>0?(a[r.path[0]]=a[r.path[0]]||[],a[r.path[0]].push(e(r))):s.push(e(r));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}}ze.create=t=>new ze(t);const Gt=(t,e)=>{let a;switch(t.code){case v.invalid_type:t.received===k.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case v.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,J.jsonStringifyReplacer)}`;break;case v.unrecognized_keys:a=`Unrecognized key(s) in object: ${J.joinValues(t.keys,", ")}`;break;case v.invalid_union:a="Invalid input";break;case v.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${J.joinValues(t.options)}`;break;case v.invalid_enum_value:a=`Invalid enum value. Expected ${J.joinValues(t.options)}, received '${t.received}'`;break;case v.invalid_arguments:a="Invalid function arguments";break;case v.invalid_return_type:a="Invalid function return type";break;case v.invalid_date:a="Invalid date";break;case v.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:J.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case v.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case v.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case v.custom:a="Invalid input";break;case v.invalid_intersection_types:a="Intersection results could not be merged";break;case v.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case v.not_finite:a="Number must be finite";break;default:a=e.defaultError,J.assertNever(t)}return{message:a}};let Ir=Gt;function Fr(){return Ir}const Pr=t=>{const{data:e,path:a,errorMaps:s,issueData:r}=t,n=[...a,...r.path||[]],i={...r,path:n};if(r.message!==void 0)return{...r,path:n,message:r.message};let l="";const d=s.filter(m=>!!m).slice().reverse();for(const m of d)l=m(i,{data:e,defaultError:l}).message;return{...r,path:n,message:l}};function w(t,e){const a=Fr(),s=Pr({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Gt?void 0:Gt].filter(r=>!!r)});t.common.issues.push(s)}class Ee{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){const s=[];for(const r of a){if(r.status==="aborted")return P;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){const s=[];for(const r of a){const n=await r.key,i=await r.value;s.push({key:n,value:i})}return Ee.mergeObjectSync(e,s)}static mergeObjectSync(e,a){const s={};for(const r of a){const{key:n,value:i}=r;if(n.status==="aborted"||i.status==="aborted")return P;n.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof i.value<"u"||r.alwaysSet)&&(s[n.value]=i.value)}return{status:e.value,value:s}}}const P=Object.freeze({status:"aborted"}),pt=t=>({status:"dirty",value:t}),Ve=t=>({status:"valid",value:t}),$a=t=>t.status==="aborted",Ma=t=>t.status==="dirty",rt=t=>t.status==="valid",Vt=t=>typeof Promise<"u"&&t instanceof Promise;var E;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(E||(E={}));class Ye{constructor(e,a,s,r){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const La=(t,e)=>{if(rt(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const a=new ze(t.common.issues);return this._error=a,this._error}}};function q(t){if(!t)return{};const{errorMap:e,invalid_type_error:a,required_error:s,description:r}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,l)=>{const{message:d}=t;return i.code==="invalid_enum_value"?{message:d??l.defaultError}:typeof l.data>"u"?{message:d??s??l.defaultError}:i.code!=="invalid_type"?{message:l.defaultError}:{message:d??a??l.defaultError}},description:r}}class H{get description(){return this._def.description}_getType(e){return Ze(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:Ze(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ee,ctx:{common:e.parent.common,data:e.data,parsedType:Ze(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const a=this._parse(e);if(Vt(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){const a=this._parse(e);return Promise.resolve(a)}parse(e,a){const s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){const s={common:{issues:[],async:(a==null?void 0:a.async)??!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ze(e)},r=this._parseSync({data:e,path:s.path,parent:s});return La(s,r)}"~validate"(e){var s,r;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ze(e)};if(!this["~standard"].async)try{const n=this._parseSync({data:e,path:[],parent:a});return rt(n)?{value:n.value}:{issues:a.common.issues}}catch(n){(r=(s=n==null?void 0:n.message)==null?void 0:s.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:a}).then(n=>rt(n)?{value:n.value}:{issues:a.common.issues})}async parseAsync(e,a){const s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){const s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ze(e)},r=this._parse({data:e,path:s.path,parent:s}),n=await(Vt(r)?r:Promise.resolve(r));return La(s,n)}refine(e,a){const s=r=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(r):a;return this._refinement((r,n)=>{const i=e(r),l=()=>n.addIssue({code:v.custom,...s(r)});return typeof Promise<"u"&&i instanceof Promise?i.then(d=>d?!0:(l(),!1)):i?!0:(l(),!1)})}refinement(e,a){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof a=="function"?a(s,r):a),!1))}_refinement(e){return new ot({schema:this,typeName:$.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return He.create(this,this._def)}nullable(){return it.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Me.create(this)}promise(){return Pt.create(this,this._def)}or(e){return It.create([this,e],this._def)}and(e){return Ft.create(this,e,this._def)}transform(e){return new ot({...q(this._def),schema:this,typeName:$.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const a=typeof e=="function"?e:()=>e;return new Qt({...q(this._def),innerType:this,defaultValue:a,typeName:$.ZodDefault})}brand(){return new nn({typeName:$.ZodBranded,type:this,...q(this._def)})}catch(e){const a=typeof e=="function"?e:()=>e;return new ea({...q(this._def),innerType:this,catchValue:a,typeName:$.ZodCatch})}describe(e){const a=this.constructor;return new a({...this._def,description:e})}pipe(e){return da.create(this,e)}readonly(){return ta.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const $r=/^c[^\s-]{8,}$/i,Mr=/^[0-9a-z]+$/,Lr=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Dr=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qr=/^[a-z0-9_-]{21}$/i,zr=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ur=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Zr=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Br="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Zt;const Wr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Hr=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Yr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Kr=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Gr=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Jr=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Cs="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Xr=new RegExp(`^${Cs}$`);function ws(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const a=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${a}`}function Qr(t){return new RegExp(`^${ws(t)}$`)}function en(t){let e=`${Cs}T${ws(t)}`;const a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function tn(t,e){return!!((e==="v4"||!e)&&Wr.test(t)||(e==="v6"||!e)&&Yr.test(t))}function an(t,e){if(!zr.test(t))return!1;try{const[a]=t.split("."),s=a.replace(/-/g,"+").replace(/_/g,"/").padEnd(a.length+(4-a.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function sn(t,e){return!!((e==="v4"||!e)&&Hr.test(t)||(e==="v6"||!e)&&Kr.test(t))}class We extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==k.string){const n=this._getOrReturnCtx(e);return w(n,{code:v.invalid_type,expected:k.string,received:n.parsedType}),P}const s=new Ee;let r;for(const n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),w(r,{code:v.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="max")e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),w(r,{code:v.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),s.dirty());else if(n.kind==="length"){const i=e.data.length>n.value,l=e.data.length<n.value;(i||l)&&(r=this._getOrReturnCtx(e,r),i?w(r,{code:v.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):l&&w(r,{code:v.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),s.dirty())}else if(n.kind==="email")Zr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"email",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="emoji")Zt||(Zt=new RegExp(Br,"u")),Zt.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"emoji",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="uuid")Dr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"uuid",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="nanoid")qr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"nanoid",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid")$r.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"cuid",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="cuid2")Mr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"cuid2",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="ulid")Lr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"ulid",code:v.invalid_string,message:n.message}),s.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),w(r,{validation:"url",code:v.invalid_string,message:n.message}),s.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"regex",code:v.invalid_string,message:n.message}),s.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),s.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:{startsWith:n.value},message:n.message}),s.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:{endsWith:n.value},message:n.message}),s.dirty()):n.kind==="datetime"?en(n).test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:"datetime",message:n.message}),s.dirty()):n.kind==="date"?Xr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:"date",message:n.message}),s.dirty()):n.kind==="time"?Qr(n).test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{code:v.invalid_string,validation:"time",message:n.message}),s.dirty()):n.kind==="duration"?Ur.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"duration",code:v.invalid_string,message:n.message}),s.dirty()):n.kind==="ip"?tn(e.data,n.version)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"ip",code:v.invalid_string,message:n.message}),s.dirty()):n.kind==="jwt"?an(e.data,n.alg)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"jwt",code:v.invalid_string,message:n.message}),s.dirty()):n.kind==="cidr"?sn(e.data,n.version)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"cidr",code:v.invalid_string,message:n.message}),s.dirty()):n.kind==="base64"?Gr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"base64",code:v.invalid_string,message:n.message}),s.dirty()):n.kind==="base64url"?Jr.test(e.data)||(r=this._getOrReturnCtx(e,r),w(r,{validation:"base64url",code:v.invalid_string,message:n.message}),s.dirty()):J.assertNever(n);return{status:s.value,value:e.data}}_regex(e,a,s){return this.refinement(r=>e.test(r),{validation:a,code:v.invalid_string,...E.errToObj(s)})}_addCheck(e){return new We({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...E.errToObj(e)})}url(e){return this._addCheck({kind:"url",...E.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...E.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...E.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...E.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...E.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...E.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...E.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...E.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...E.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...E.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...E.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...E.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...E.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...E.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...E.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...E.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...E.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...E.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...E.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...E.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...E.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...E.errToObj(a)})}nonempty(e){return this.min(1,E.errToObj(e))}trim(){return new We({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new We({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new We({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}}We.create=t=>new We({checks:[],typeName:$.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...q(t)});function rn(t,e){const a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=a>s?a:s,n=Number.parseInt(t.toFixed(r).replace(".","")),i=Number.parseInt(e.toFixed(r).replace(".",""));return n%i/10**r}class vt extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==k.number){const n=this._getOrReturnCtx(e);return w(n,{code:v.invalid_type,expected:k.number,received:n.parsedType}),P}let s;const r=new Ee;for(const n of this._def.checks)n.kind==="int"?J.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:v.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):n.kind==="multipleOf"?rn(e.data,n.value)!==0&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),w(s,{code:v.not_finite,message:n.message}),r.dirty()):J.assertNever(n);return{status:r.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,E.toString(a))}gt(e,a){return this.setLimit("min",e,!1,E.toString(a))}lte(e,a){return this.setLimit("max",e,!0,E.toString(a))}lt(e,a){return this.setLimit("max",e,!1,E.toString(a))}setLimit(e,a,s,r){return new vt({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:E.toString(r)}]})}_addCheck(e){return new vt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:E.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:E.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:E.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:E.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:E.toString(e)})}get minValue(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&J.isInteger(e.value))}get isFinite(){let e=null,a=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}}vt.create=t=>new vt({checks:[],typeName:$.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...q(t)});class yt extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==k.bigint)return this._getInvalidInput(e);let s;const r=new Ee;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),w(s,{code:v.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):J.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){const a=this._getOrReturnCtx(e);return w(a,{code:v.invalid_type,expected:k.bigint,received:a.parsedType}),P}gte(e,a){return this.setLimit("min",e,!0,E.toString(a))}gt(e,a){return this.setLimit("min",e,!1,E.toString(a))}lte(e,a){return this.setLimit("max",e,!0,E.toString(a))}lt(e,a){return this.setLimit("max",e,!1,E.toString(a))}setLimit(e,a,s,r){return new yt({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:E.toString(r)}]})}_addCheck(e){return new yt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:E.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:E.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:E.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:E.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:E.toString(a)})}get minValue(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}}yt.create=t=>new yt({checks:[],typeName:$.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...q(t)});class Jt extends H{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==k.boolean){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.boolean,received:s.parsedType}),P}return Ve(e.data)}}Jt.create=t=>new Jt({typeName:$.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...q(t)});class Ot extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==k.date){const n=this._getOrReturnCtx(e);return w(n,{code:v.invalid_type,expected:k.date,received:n.parsedType}),P}if(Number.isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return w(n,{code:v.invalid_date}),P}const s=new Ee;let r;for(const n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),w(r,{code:v.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),s.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),w(r,{code:v.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),s.dirty()):J.assertNever(n);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ot({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:E.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:E.toString(a)})}get minDate(){let e=null;for(const a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}}Ot.create=t=>new Ot({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:$.ZodDate,...q(t)});class Da extends H{_parse(e){if(this._getType(e)!==k.symbol){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.symbol,received:s.parsedType}),P}return Ve(e.data)}}Da.create=t=>new Da({typeName:$.ZodSymbol,...q(t)});class qa extends H{_parse(e){if(this._getType(e)!==k.undefined){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.undefined,received:s.parsedType}),P}return Ve(e.data)}}qa.create=t=>new qa({typeName:$.ZodUndefined,...q(t)});class za extends H{_parse(e){if(this._getType(e)!==k.null){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.null,received:s.parsedType}),P}return Ve(e.data)}}za.create=t=>new za({typeName:$.ZodNull,...q(t)});class Ua extends H{constructor(){super(...arguments),this._any=!0}_parse(e){return Ve(e.data)}}Ua.create=t=>new Ua({typeName:$.ZodAny,...q(t)});class Za extends H{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ve(e.data)}}Za.create=t=>new Za({typeName:$.ZodUnknown,...q(t)});class Ke extends H{_parse(e){const a=this._getOrReturnCtx(e);return w(a,{code:v.invalid_type,expected:k.never,received:a.parsedType}),P}}Ke.create=t=>new Ke({typeName:$.ZodNever,...q(t)});class Ba extends H{_parse(e){if(this._getType(e)!==k.undefined){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.void,received:s.parsedType}),P}return Ve(e.data)}}Ba.create=t=>new Ba({typeName:$.ZodVoid,...q(t)});class Me extends H{_parse(e){const{ctx:a,status:s}=this._processInputParams(e),r=this._def;if(a.parsedType!==k.array)return w(a,{code:v.invalid_type,expected:k.array,received:a.parsedType}),P;if(r.exactLength!==null){const i=a.data.length>r.exactLength.value,l=a.data.length<r.exactLength.value;(i||l)&&(w(a,{code:i?v.too_big:v.too_small,minimum:l?r.exactLength.value:void 0,maximum:i?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&a.data.length<r.minLength.value&&(w(a,{code:v.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&a.data.length>r.maxLength.value&&(w(a,{code:v.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((i,l)=>r.type._parseAsync(new Ye(a,i,a.path,l)))).then(i=>Ee.mergeArray(s,i));const n=[...a.data].map((i,l)=>r.type._parseSync(new Ye(a,i,a.path,l)));return Ee.mergeArray(s,n)}get element(){return this._def.type}min(e,a){return new Me({...this._def,minLength:{value:e,message:E.toString(a)}})}max(e,a){return new Me({...this._def,maxLength:{value:e,message:E.toString(a)}})}length(e,a){return new Me({...this._def,exactLength:{value:e,message:E.toString(a)}})}nonempty(e){return this.min(1,e)}}Me.create=(t,e)=>new Me({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$.ZodArray,...q(e)});function at(t){if(t instanceof pe){const e={};for(const a in t.shape){const s=t.shape[a];e[a]=He.create(at(s))}return new pe({...t._def,shape:()=>e})}else return t instanceof Me?new Me({...t._def,type:at(t.element)}):t instanceof He?He.create(at(t.unwrap())):t instanceof it?it.create(at(t.unwrap())):t instanceof Qe?Qe.create(t.items.map(e=>at(e))):t}class pe extends H{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),a=J.objectKeys(e);return this._cached={shape:e,keys:a},this._cached}_parse(e){if(this._getType(e)!==k.object){const m=this._getOrReturnCtx(e);return w(m,{code:v.invalid_type,expected:k.object,received:m.parsedType}),P}const{status:s,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),l=[];if(!(this._def.catchall instanceof Ke&&this._def.unknownKeys==="strip"))for(const m in r.data)i.includes(m)||l.push(m);const d=[];for(const m of i){const h=n[m],x=r.data[m];d.push({key:{status:"valid",value:m},value:h._parse(new Ye(r,x,r.path,m)),alwaysSet:m in r.data})}if(this._def.catchall instanceof Ke){const m=this._def.unknownKeys;if(m==="passthrough")for(const h of l)d.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(m==="strict")l.length>0&&(w(r,{code:v.unrecognized_keys,keys:l}),s.dirty());else if(m!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const m=this._def.catchall;for(const h of l){const x=r.data[h];d.push({key:{status:"valid",value:h},value:m._parse(new Ye(r,x,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const m=[];for(const h of d){const x=await h.key,g=await h.value;m.push({key:x,value:g,alwaysSet:h.alwaysSet})}return m}).then(m=>Ee.mergeObjectSync(s,m)):Ee.mergeObjectSync(s,d)}get shape(){return this._def.shape()}strict(e){return E.errToObj,new pe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i;const r=((i=(n=this._def).errorMap)==null?void 0:i.call(n,a,s).message)??s.defaultError;return a.code==="unrecognized_keys"?{message:E.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new pe({...this._def,unknownKeys:"strip"})}passthrough(){return new pe({...this._def,unknownKeys:"passthrough"})}extend(e){return new pe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new pe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new pe({...this._def,catchall:e})}pick(e){const a={};for(const s of J.objectKeys(e))e[s]&&this.shape[s]&&(a[s]=this.shape[s]);return new pe({...this._def,shape:()=>a})}omit(e){const a={};for(const s of J.objectKeys(this.shape))e[s]||(a[s]=this.shape[s]);return new pe({...this._def,shape:()=>a})}deepPartial(){return at(this)}partial(e){const a={};for(const s of J.objectKeys(this.shape)){const r=this.shape[s];e&&!e[s]?a[s]=r:a[s]=r.optional()}return new pe({...this._def,shape:()=>a})}required(e){const a={};for(const s of J.objectKeys(this.shape))if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof He;)n=n._def.innerType;a[s]=n}return new pe({...this._def,shape:()=>a})}keyof(){return ks(J.objectKeys(this.shape))}}pe.create=(t,e)=>new pe({shape:()=>t,unknownKeys:"strip",catchall:Ke.create(),typeName:$.ZodObject,...q(e)});pe.strictCreate=(t,e)=>new pe({shape:()=>t,unknownKeys:"strict",catchall:Ke.create(),typeName:$.ZodObject,...q(e)});pe.lazycreate=(t,e)=>new pe({shape:t,unknownKeys:"strip",catchall:Ke.create(),typeName:$.ZodObject,...q(e)});class It extends H{_parse(e){const{ctx:a}=this._processInputParams(e),s=this._def.options;function r(n){for(const l of n)if(l.result.status==="valid")return l.result;for(const l of n)if(l.result.status==="dirty")return a.common.issues.push(...l.ctx.common.issues),l.result;const i=n.map(l=>new ze(l.ctx.common.issues));return w(a,{code:v.invalid_union,unionErrors:i}),P}if(a.common.async)return Promise.all(s.map(async n=>{const i={...a,common:{...a.common,issues:[]},parent:null};return{result:await n._parseAsync({data:a.data,path:a.path,parent:i}),ctx:i}})).then(r);{let n;const i=[];for(const d of s){const m={...a,common:{...a.common,issues:[]},parent:null},h=d._parseSync({data:a.data,path:a.path,parent:m});if(h.status==="valid")return h;h.status==="dirty"&&!n&&(n={result:h,ctx:m}),m.common.issues.length&&i.push(m.common.issues)}if(n)return a.common.issues.push(...n.ctx.common.issues),n.result;const l=i.map(d=>new ze(d));return w(a,{code:v.invalid_union,unionErrors:l}),P}}get options(){return this._def.options}}It.create=(t,e)=>new It({options:t,typeName:$.ZodUnion,...q(e)});function Xt(t,e){const a=Ze(t),s=Ze(e);if(t===e)return{valid:!0,data:t};if(a===k.object&&s===k.object){const r=J.objectKeys(e),n=J.objectKeys(t).filter(l=>r.indexOf(l)!==-1),i={...t,...e};for(const l of n){const d=Xt(t[l],e[l]);if(!d.valid)return{valid:!1};i[l]=d.data}return{valid:!0,data:i}}else if(a===k.array&&s===k.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let n=0;n<t.length;n++){const i=t[n],l=e[n],d=Xt(i,l);if(!d.valid)return{valid:!1};r.push(d.data)}return{valid:!0,data:r}}else return a===k.date&&s===k.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Ft extends H{_parse(e){const{status:a,ctx:s}=this._processInputParams(e),r=(n,i)=>{if($a(n)||$a(i))return P;const l=Xt(n.value,i.value);return l.valid?((Ma(n)||Ma(i))&&a.dirty(),{status:a.value,value:l.data}):(w(s,{code:v.invalid_intersection_types}),P)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([n,i])=>r(n,i)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Ft.create=(t,e,a)=>new Ft({left:t,right:e,typeName:$.ZodIntersection,...q(a)});class Qe extends H{_parse(e){const{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.array)return w(s,{code:v.invalid_type,expected:k.array,received:s.parsedType}),P;if(s.data.length<this._def.items.length)return w(s,{code:v.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),P;!this._def.rest&&s.data.length>this._def.items.length&&(w(s,{code:v.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());const n=[...s.data].map((i,l)=>{const d=this._def.items[l]||this._def.rest;return d?d._parse(new Ye(s,i,s.path,l)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>Ee.mergeArray(a,i)):Ee.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new Qe({...this._def,rest:e})}}Qe.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Qe({items:t,typeName:$.ZodTuple,rest:null,...q(e)})};class Wa extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.map)return w(s,{code:v.invalid_type,expected:k.map,received:s.parsedType}),P;const r=this._def.keyType,n=this._def.valueType,i=[...s.data.entries()].map(([l,d],m)=>({key:r._parse(new Ye(s,l,s.path,[m,"key"])),value:n._parse(new Ye(s,d,s.path,[m,"value"]))}));if(s.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const d of i){const m=await d.key,h=await d.value;if(m.status==="aborted"||h.status==="aborted")return P;(m.status==="dirty"||h.status==="dirty")&&a.dirty(),l.set(m.value,h.value)}return{status:a.value,value:l}})}else{const l=new Map;for(const d of i){const m=d.key,h=d.value;if(m.status==="aborted"||h.status==="aborted")return P;(m.status==="dirty"||h.status==="dirty")&&a.dirty(),l.set(m.value,h.value)}return{status:a.value,value:l}}}}Wa.create=(t,e,a)=>new Wa({valueType:e,keyType:t,typeName:$.ZodMap,...q(a)});class bt extends H{_parse(e){const{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==k.set)return w(s,{code:v.invalid_type,expected:k.set,received:s.parsedType}),P;const r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(w(s,{code:v.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),a.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(w(s,{code:v.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),a.dirty());const n=this._def.valueType;function i(d){const m=new Set;for(const h of d){if(h.status==="aborted")return P;h.status==="dirty"&&a.dirty(),m.add(h.value)}return{status:a.value,value:m}}const l=[...s.data.values()].map((d,m)=>n._parse(new Ye(s,d,s.path,m)));return s.common.async?Promise.all(l).then(d=>i(d)):i(l)}min(e,a){return new bt({...this._def,minSize:{value:e,message:E.toString(a)}})}max(e,a){return new bt({...this._def,maxSize:{value:e,message:E.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}}bt.create=(t,e)=>new bt({valueType:t,minSize:null,maxSize:null,typeName:$.ZodSet,...q(e)});class Ha extends H{get schema(){return this._def.getter()}_parse(e){const{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}}Ha.create=(t,e)=>new Ha({getter:t,typeName:$.ZodLazy,...q(e)});class Ya extends H{_parse(e){if(e.data!==this._def.value){const a=this._getOrReturnCtx(e);return w(a,{received:a.data,code:v.invalid_literal,expected:this._def.value}),P}return{status:"valid",value:e.data}}get value(){return this._def.value}}Ya.create=(t,e)=>new Ya({value:t,typeName:$.ZodLiteral,...q(e)});function ks(t,e){return new nt({values:t,typeName:$.ZodEnum,...q(e)})}class nt extends H{_parse(e){if(typeof e.data!="string"){const a=this._getOrReturnCtx(e),s=this._def.values;return w(a,{expected:J.joinValues(s),received:a.parsedType,code:v.invalid_type}),P}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const a=this._getOrReturnCtx(e),s=this._def.values;return w(a,{received:a.data,code:v.invalid_enum_value,options:s}),P}return Ve(e.data)}get options(){return this._def.values}get enum(){const e={};for(const a of this._def.values)e[a]=a;return e}get Values(){const e={};for(const a of this._def.values)e[a]=a;return e}get Enum(){const e={};for(const a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return nt.create(e,{...this._def,...a})}exclude(e,a=this._def){return nt.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}}nt.create=ks;class Ka extends H{_parse(e){const a=J.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==k.string&&s.parsedType!==k.number){const r=J.objectValues(a);return w(s,{expected:J.joinValues(r),received:s.parsedType,code:v.invalid_type}),P}if(this._cache||(this._cache=new Set(J.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=J.objectValues(a);return w(s,{received:s.data,code:v.invalid_enum_value,options:r}),P}return Ve(e.data)}get enum(){return this._def.values}}Ka.create=(t,e)=>new Ka({values:t,typeName:$.ZodNativeEnum,...q(e)});class Pt extends H{unwrap(){return this._def.type}_parse(e){const{ctx:a}=this._processInputParams(e);if(a.parsedType!==k.promise&&a.common.async===!1)return w(a,{code:v.invalid_type,expected:k.promise,received:a.parsedType}),P;const s=a.parsedType===k.promise?a.data:Promise.resolve(a.data);return Ve(s.then(r=>this._def.type.parseAsync(r,{path:a.path,errorMap:a.common.contextualErrorMap})))}}Pt.create=(t,e)=>new Pt({type:t,typeName:$.ZodPromise,...q(e)});class ot extends H{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:a,ctx:s}=this._processInputParams(e),r=this._def.effect||null,n={addIssue:i=>{w(s,i),i.fatal?a.abort():a.dirty()},get path(){return s.path}};if(n.addIssue=n.addIssue.bind(n),r.type==="preprocess"){const i=r.transform(s.data,n);if(s.common.async)return Promise.resolve(i).then(async l=>{if(a.value==="aborted")return P;const d=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return d.status==="aborted"?P:d.status==="dirty"||a.value==="dirty"?pt(d.value):d});{if(a.value==="aborted")return P;const l=this._def.schema._parseSync({data:i,path:s.path,parent:s});return l.status==="aborted"?P:l.status==="dirty"||a.value==="dirty"?pt(l.value):l}}if(r.type==="refinement"){const i=l=>{const d=r.refinement(l,n);if(s.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?P:(l.status==="dirty"&&a.dirty(),i(l.value),{status:a.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?P:(l.status==="dirty"&&a.dirty(),i(l.value).then(()=>({status:a.value,value:l.value}))))}if(r.type==="transform")if(s.common.async===!1){const i=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!rt(i))return P;const l=r.transform(i.value,n);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(i=>rt(i)?Promise.resolve(r.transform(i.value,n)).then(l=>({status:a.value,value:l})):P);J.assertNever(r)}}ot.create=(t,e,a)=>new ot({schema:t,typeName:$.ZodEffects,effect:e,...q(a)});ot.createWithPreprocess=(t,e,a)=>new ot({schema:e,effect:{type:"preprocess",transform:t},typeName:$.ZodEffects,...q(a)});class He extends H{_parse(e){return this._getType(e)===k.undefined?Ve(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}He.create=(t,e)=>new He({innerType:t,typeName:$.ZodOptional,...q(e)});class it extends H{_parse(e){return this._getType(e)===k.null?Ve(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}it.create=(t,e)=>new it({innerType:t,typeName:$.ZodNullable,...q(e)});class Qt extends H{_parse(e){const{ctx:a}=this._processInputParams(e);let s=a.data;return a.parsedType===k.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}}Qt.create=(t,e)=>new Qt({innerType:t,typeName:$.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...q(e)});class ea extends H{_parse(e){const{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Vt(r)?r.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ze(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ze(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}ea.create=(t,e)=>new ea({innerType:t,typeName:$.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...q(e)});class Ga extends H{_parse(e){if(this._getType(e)!==k.nan){const s=this._getOrReturnCtx(e);return w(s,{code:v.invalid_type,expected:k.nan,received:s.parsedType}),P}return{status:"valid",value:e.data}}}Ga.create=t=>new Ga({typeName:$.ZodNaN,...q(t)});class nn extends H{_parse(e){const{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}}class da extends H{_parse(e){const{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?P:n.status==="dirty"?(a.dirty(),pt(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{const r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?P:r.status==="dirty"?(a.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,a){return new da({in:e,out:a,typeName:$.ZodPipeline})}}class ta extends H{_parse(e){const a=this._def.innerType._parse(e),s=r=>(rt(r)&&(r.value=Object.freeze(r.value)),r);return Vt(a)?a.then(r=>s(r)):s(a)}unwrap(){return this._def.innerType}}ta.create=(t,e)=>new ta({innerType:t,typeName:$.ZodReadonly,...q(e)});var $;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($||($={}));const Ce=We.create,Bt=Jt.create;Ke.create;Me.create;const on=pe.create;It.create;Ft.create;Qe.create;nt.create;Pt.create;He.create;it.create;var Lt="Switch",[ln,ro]=Xs(Lt),[cn,dn]=ln(Lt),Es=D.forwardRef((t,e)=>{const{__scopeSwitch:a,name:s,checked:r,defaultChecked:n,required:i,disabled:l,value:d="on",onCheckedChange:m,form:h,...x}=t,[g,I]=D.useState(null),S=os(e,M=>I(M)),p=D.useRef(!1),C=g?h||!!g.closest("form"):!0,[Z,R]=Js({prop:r,defaultProp:n??!1,onChange:m,caller:Lt});return o.jsxs(cn,{scope:a,checked:Z,disabled:l,children:[o.jsx(is.button,{type:"button",role:"switch","aria-checked":Z,"aria-required":i,"data-state":Vs(Z),"data-disabled":l?"":void 0,disabled:l,value:d,...x,ref:S,onClick:Qs(t.onClick,M=>{R(L=>!L),C&&(p.current=M.isPropagationStopped(),p.current||M.stopPropagation())})}),C&&o.jsx(Ts,{control:g,bubbles:!p.current,name:s,value:d,checked:Z,required:i,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});Es.displayName=Lt;var Ss="SwitchThumb",Rs=D.forwardRef((t,e)=>{const{__scopeSwitch:a,...s}=t,r=dn(Ss,a);return o.jsx(is.span,{"data-state":Vs(r.checked),"data-disabled":r.disabled?"":void 0,...s,ref:e})});Rs.displayName=Ss;var un="SwitchBubbleInput",Ts=D.forwardRef(({__scopeSwitch:t,control:e,checked:a,bubbles:s=!0,...r},n)=>{const i=D.useRef(null),l=os(i,n),d=tr(a),m=er(e);return D.useEffect(()=>{const h=i.current;if(!h)return;const x=window.HTMLInputElement.prototype,I=Object.getOwnPropertyDescriptor(x,"checked").set;if(d!==a&&I){const S=new Event("click",{bubbles:s});I.call(h,a),h.dispatchEvent(S)}},[d,a,s]),o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...r,tabIndex:-1,ref:l,style:{...r.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ts.displayName=un;function Vs(t){return t?"checked":"unchecked"}var Os=Es,mn=Rs;const kt=D.forwardRef(({className:t,...e},a)=>o.jsx(Os,{className:fa("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-arca-main data-[state=unchecked]:bg-input",t),...e,ref:a,children:o.jsx(mn,{className:fa("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));kt.displayName=Os.displayName;const ve=t=>{if(!t)return NaN;const e=String(t).replace(/[^\d.]/g,""),a=e.split(".");let s=e;a.length>2&&(s=a[0]+"."+a.slice(1).join(""));const r=parseFloat(s);return isNaN(r)?NaN:r},gt=(t,e=!1)=>t==null||isNaN(t)?"":new Intl.NumberFormat("en-US",{minimumFractionDigits:e?2:0,maximumFractionDigits:e?2:0}).format(t),fn=t=>{if(!t||t.trim()==="")return"";const e=String(t).replace(/[^\d]/g,"");if(e==="")return"";const a=parseInt(e,10);return isNaN(a)?"":gt(a,!1)},hn=on({condominio:Ce().min(1,"Nome do condomínio é obrigatório"),valor_imovel:Ce().min(1,"Valor do imóvel é obrigatório").refine(t=>{const e=ve(t);return!isNaN(e)&&e>0},{message:"Valor do imóvel deve ser um número positivo válido"}),entrada_valor:Ce().optional(),entrada_percentual:Ce().optional(),localizacao:Ce().optional(),modelo:Ce().optional(),quartos:Ce().optional(),piscina:Bt().optional(),logoUrl:Ce().nullable().optional(),incluir_decoracao:Bt().optional().default(!1),decoracao_valor:Ce().optional(),decoracao_percentual:Ce().optional(),incluir_closing_costs:Bt().optional().default(!1),closing_costs_percentual:Ce().optional(),valor_iptu_anual:Ce().optional(),taxa_juros_anual_financiamento:Ce().optional(),prazo_financiamento_anos:Ce().optional()}).refine(t=>{const e=ve(t.valor_imovel);if(!isNaN(e)&&e>0){const a=t.entrada_valor,s=t.entrada_percentual,r=a&&!isNaN(ve(a))&&ve(a)>=0,n=s&&!isNaN(parseFloat(s.replace("%","")))&&parseFloat(s.replace("%",""))>=0;if(!r&&!n)return!1}return!0},{message:"Preencha o valor ou o percentual da entrada",path:["entrada_valor"]}).refine(t=>{if(t.incluir_decoracao){const e=ve(t.valor_imovel);if(!isNaN(e)&&e>0){const a=t.decoracao_valor,s=t.decoracao_percentual,r=a&&!isNaN(ve(a))&&ve(a)>=0,n=s&&!isNaN(parseFloat(s.replace("%","")))&&parseFloat(s.replace("%",""))>=0;if(!r&&!n)return!1}}return!0},{message:"Preencha o valor ou o percentual da decoração",path:["decoracao_valor"]}).refine(t=>{if(t.incluir_closing_costs){const e=ve(t.valor_imovel);if(!isNaN(e)&&e>0){const a=t.closing_costs_percentual;if(!(a&&!isNaN(parseFloat(a.replace("%","")))&&parseFloat(a.replace("%",""))>=0))return!1}}return!0},{message:"Preencha o percentual dos custos de fechamento",path:["closing_costs_percentual"]}),pn=({onSubmit:t,isFormProcessing:e=!1,isLogoUploading:a=!1,onLogoChange:s,logoPreviewUrl:r,currentStep:n,totalSteps:i,handleNextStep:l,handlePrevStep:d,fieldsToValidatePerStep:m,triggerValidation:h,initialData:x})=>{const{control:g,handleSubmit:I,watch:S,setValue:p,formState:{errors:C,isValid:Z},trigger:R}=js({resolver:Or(hn),defaultValues:{condominio:"",localizacao:"",modelo:"",quartos:"",piscina:!1,valor_imovel:"",entrada_valor:"",entrada_percentual:"",logoUrl:null,incluir_decoracao:!1,decoracao_valor:"",decoracao_percentual:"",incluir_closing_costs:!1,closing_costs_percentual:"",valor_iptu_anual:"",taxa_juros_anual_financiamento:"",prazo_financiamento_anos:""},mode:"onChange"}),M=S("valor_imovel"),L=S("incluir_decoracao"),X=S("incluir_closing_costs"),he=S("prazo_financiamento_anos"),U=S("taxa_juros_anual_financiamento");S("condominio"),S("quartos"),W.useEffect(()=>{L||(p("decoracao_valor","",{shouldValidate:!1,shouldDirty:!1}),p("decoracao_percentual","",{shouldValidate:!1,shouldDirty:!1}),setTimeout(()=>{R(["decoracao_valor","decoracao_percentual"])},100))},[L,p,R]),W.useEffect(()=>{X||p("closing_costs_percentual","",{shouldValidate:!0})},[X,p]),W.useEffect(()=>{const b=parseInt(he,10),_=S("taxa_juros_anual_financiamento");_===""||_===null||typeof _>"u"?b===30?p("taxa_juros_anual_financiamento","7",{shouldValidate:!0}):b===15&&p("taxa_juros_anual_financiamento","6.19",{shouldValidate:!0}):isNaN(b)&&(_==="7"||_==="6.19")&&p("taxa_juros_anual_financiamento","",{shouldValidate:!0})},[he,p,S]),W.useEffect(()=>{const b=parseFloat((U==null?void 0:U.replace("%",""))||""),_=S("prazo_financiamento_anos");_===""||_===null||typeof _>"u"?b===7?p("prazo_financiamento_anos","30",{shouldValidate:!0}):b===6.19&&p("prazo_financiamento_anos","15",{shouldValidate:!0}):isNaN(b)&&(_==="30"||_==="15")&&p("prazo_financiamento_anos","",{shouldValidate:!0})},[U,p,S]);const ye=b=>{t(b)},le=(b,_)=>{if(!_||_.trim()===""){p(b,"",{shouldValidate:!0}),b==="valor_imovel"&&(p("entrada_valor","",{shouldValidate:!0}),p("entrada_percentual","",{shouldValidate:!0}),L&&(p("decoracao_valor","",{shouldValidate:!0}),p("decoracao_percentual","",{shouldValidate:!0})));return}if(b==="valor_imovel"){const ue=parseFloat(String(_).replace(/[^\d.-]/g,""));if(String(_).length>0&&(isNaN(ue)||ue===0&&!/^0*\.?0*$/.test(_)&&_!=="0")){console.warn(`[handleCurrencyInputChange] valor_imovel recebeu valor não numérico ou inválido: "${_}". Forçando para vazio.`),p("valor_imovel","",{shouldValidate:!0}),p("entrada_valor","",{shouldValidate:!0}),p("entrada_percentual","",{shouldValidate:!0}),L&&(p("decoracao_valor","",{shouldValidate:!0}),p("decoracao_percentual","",{shouldValidate:!0}));return}}const V=fn(_);console.log(`[handleCurrencyInputChange] Field: ${b}, Raw: "${_}", FormattedDisplay: "${V}"`),p(b,V,{shouldValidate:!0});const Y=ve(V);if(b==="valor_imovel")if(!isNaN(Y)&&Y>0){const ue=S("entrada_percentual");if(ue){const K=parseFloat(ue.replace("%",""));if(!isNaN(K)&&K>0){const G=Y*(K/100);p("entrada_valor",gt(G,!1),{shouldValidate:!0})}}if(L){const K=S("decoracao_percentual");if(K){const G=parseFloat(K.replace("%",""));if(!isNaN(G)&&G>0){const Le=Y*(G/100);p("decoracao_valor",gt(Le,!1),{shouldValidate:!0})}}}}else p("entrada_valor","",{shouldValidate:!0}),p("entrada_percentual","",{shouldValidate:!0}),L&&(p("decoracao_valor","",{shouldValidate:!0}),p("decoracao_percentual","",{shouldValidate:!0}));else if(b==="entrada_valor"){const ue=S("valor_imovel"),K=ve(ue);if(!isNaN(Y)&&Y>=0&&!isNaN(K)&&K>0){const G=Y/K*100;p("entrada_percentual",G>0?G.toFixed(2)+"%":"",{shouldValidate:!0})}else!isNaN(K)&&K>0&&p("entrada_percentual","",{shouldValidate:!0})}else if(b==="decoracao_valor"){if(!L){p(b,"",{shouldValidate:!0}),p("decoracao_percentual","",{shouldValidate:!0});return}const ue=S("valor_imovel"),K=ve(ue);if(!isNaN(Y)&&Y>=0&&!isNaN(K)&&K>0){const G=Y/K*100;p("decoracao_percentual",G>0?G.toFixed(2)+"%":"",{shouldValidate:!0})}else!isNaN(K)&&K>0&&p("decoracao_percentual","",{shouldValidate:!0})}},[_e,ne]=D.useState({}),F=(b,_)=>{if(console.log(`[PERCENT] Campo: ${b}, Valor recebido: "${_}", IsDeleting: ${_e[b]}`),_e[b]){console.log(`[PERCENT] Modo deletar ativo - permitindo valor: "${_}"`),p(b,_,{shouldValidate:!0}),(_===""||_===null||_===void 0)&&(ne(G=>({...G,[b]:!1})),b==="entrada_percentual"?p("entrada_valor","",{shouldValidate:!0}):b==="decoracao_percentual"&&p("decoracao_valor","",{shouldValidate:!0}));return}if(_===""||_===null||_===void 0){console.log(`[PERCENT] Limpando campo ${b}`),p(b,"",{shouldValidate:!0}),b==="entrada_percentual"?p("entrada_valor","",{shouldValidate:!0}):b==="decoracao_percentual"&&p("decoracao_valor","",{shouldValidate:!0});return}const V=_.replace(/[^\d.]/g,"");if(console.log(`[PERCENT] Números extraídos: "${V}"`),V===""||V==="."){console.log(`[PERCENT] Sem números válidos - limpando ${b}`),p(b,"",{shouldValidate:!0}),b==="entrada_percentual"?p("entrada_valor","",{shouldValidate:!0}):b==="decoracao_percentual"&&p("decoracao_valor","",{shouldValidate:!0});return}const Y=V+"%";console.log(`[PERCENT] Valor final com %: "${Y}"`),p(b,Y,{shouldValidate:!0});const ue=parseFloat(V),K=ve(S("valor_imovel"));if(b==="entrada_percentual"&&!isNaN(ue)&&!isNaN(K)&&K>0){const G=K*(ue/100);p("entrada_valor",gt(G,!1),{shouldValidate:!0})}else if(b==="decoracao_percentual"&&L&&!isNaN(ue)&&!isNaN(K)&&K>0){const G=K*(ue/100);p("decoracao_valor",gt(G,!1),{shouldValidate:!0})}},O=(b,_)=>{const V=S(b)||"",Y=_.target,ue=Y.selectionStart===0&&Y.selectionEnd===V.length,K=Y.selectionStart===V.length;if(console.log(`[KEYDOWN] Campo: ${b}, Tecla: ${_.key}, Valor: "${V}", TodoSelecionado: ${ue}, CursorNoFim: ${K}`),_.key==="Delete"||_.key==="Backspace"){if(ue){console.log(`[KEYDOWN] Todo selecionado - limpando campo ${b}`),_.preventDefault(),p(b,"",{shouldValidate:!0}),ne(G=>({...G,[b]:!1})),b==="entrada_percentual"?p("entrada_valor","",{shouldValidate:!0}):b==="decoracao_percentual"&&p("decoracao_valor","",{shouldValidate:!0});return}if(K&&V.endsWith("%")){console.log("[KEYDOWN] Removendo % do final - ativando modo deletar"),_.preventDefault();const G=V.slice(0,-1);p(b,G,{shouldValidate:!0}),ne(Le=>({...Le,[b]:!0}));return}if(V.length<=2){console.log(`[KEYDOWN] Campo muito curto - limpando ${b}`),_.preventDefault(),p(b,"",{shouldValidate:!0}),ne(G=>({...G,[b]:!1})),b==="entrada_percentual"?p("entrada_valor","",{shouldValidate:!0}):b==="decoracao_percentual"&&p("decoracao_valor","",{shouldValidate:!0});return}ne(G=>({...G,[b]:!0}))}else ne(G=>({...G,[b]:!1}))},se=async()=>{const b=m(n);await R(b.length>0?b:void 0)&&l()},de=b=>{var V;const _=(V=b.target.files)==null?void 0:V[0];if(_&&s){const Y=new FileReader;Y.onloadend=()=>{s(_,Y.result)},Y.readAsDataURL(_)}else s&&s(null,null)},te=()=>{var b;switch(n){case 1:return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{htmlFor:"condominio",children:"Nome do Imóvel/Condomínio"}),o.jsx(je,{name:"condominio",control:g,render:({field:_})=>(console.log("[TomROIForm] condominio field value:",_.value),o.jsx(Te,{id:"condominio",placeholder:"Ex: Solara Resort",..._,disabled:e}))}),C.condominio&&o.jsx("p",{className:"text-sm text-red-500",children:C.condominio.message})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{htmlFor:"valor_imovel",children:"Valor do Imóvel"}),o.jsx(je,{name:"valor_imovel",control:g,render:({field:_})=>(console.log("[TomROIForm] valor_imovel field object:",_),o.jsx(Te,{id:"valor_imovel",placeholder:"Ex: 650.000",..._,value:_.value||"",onChange:V=>le("valor_imovel",V.target.value),disabled:e}))}),C.valor_imovel&&o.jsx("p",{className:"text-sm text-red-500",children:C.valor_imovel.message})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{children:"Entrada"}),o.jsxs(ar,{defaultValue:"valor",className:"w-full mt-1",children:[o.jsxs(sr,{className:"grid w-full grid-cols-2",children:[o.jsx(ya,{value:"valor",children:"Valor ($)"}),o.jsx(ya,{value:"percentual",children:"Percentual (%)"})]}),o.jsxs(ba,{value:"valor",className:"mt-2",children:[o.jsx(je,{name:"entrada_valor",control:g,render:({field:_})=>o.jsx(Te,{id:"entrada_valor",placeholder:"Ex: 90.000",..._,onChange:V=>le("entrada_valor",V.target.value),disabled:e||!M||ve(M)<=0})}),C.entrada_valor&&!C.entrada_percentual&&o.jsx("p",{className:"text-sm text-red-500",children:C.entrada_valor.message})]}),o.jsxs(ba,{value:"percentual",className:"mt-2",children:[o.jsx(je,{name:"entrada_percentual",control:g,render:({field:_})=>o.jsx(Te,{id:"entrada_percentual",placeholder:"Ex: 20",..._,onChange:V=>F("entrada_percentual",V.target.value),onKeyDown:V=>O("entrada_percentual",V),disabled:e||!M||ve(M)<=0})}),C.entrada_percentual&&o.jsx("p",{className:"text-sm text-red-500",children:C.entrada_percentual.message})]})]}),C.entrada_valor&&C.entrada_valor.type==="manual"&&((b=C.entrada_valor.message)==null?void 0:b.includes("Preencha o valor ou o percentual da entrada"))&&o.jsx("p",{className:"text-sm text-red-500 mt-1",children:C.entrada_valor.message})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx(Ne,{htmlFor:"taxa_juros_anual_financiamento",children:"Taxa de Juros Anual (%)"}),o.jsx(je,{name:"taxa_juros_anual_financiamento",control:g,render:({field:_})=>o.jsx(Te,{id:"taxa_juros_anual_financiamento",placeholder:"Ex: 6.5",..._,disabled:e})}),C.taxa_juros_anual_financiamento&&o.jsx("p",{className:"text-sm text-red-500",children:C.taxa_juros_anual_financiamento.message})]}),o.jsxs("div",{children:[o.jsx(Ne,{htmlFor:"prazo_financiamento_anos",children:"Prazo Financiamento (Anos)"}),o.jsx(je,{name:"prazo_financiamento_anos",control:g,render:({field:_})=>o.jsx(Te,{id:"prazo_financiamento_anos",placeholder:"Ex: 30",..._,disabled:e})}),C.prazo_financiamento_anos&&o.jsx("p",{className:"text-sm text-red-500",children:C.prazo_financiamento_anos.message})]})]}),o.jsxs("div",{className:"mb-4 space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(Ne,{htmlFor:"incluir_decoracao",className:"flex flex-col space-y-1",children:[o.jsx("span",{children:"Incluir Custos de Decoração?"}),o.jsx("span",{className:"font-normal leading-snug text-muted-foreground",children:"Adicionar custos de decoração média."})]}),o.jsx(je,{name:"incluir_decoracao",control:g,render:({field:_})=>o.jsx(kt,{id:"incluir_decoracao",checked:_.value??!1,onCheckedChange:_.onChange,disabled:e})})]}),L&&o.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[o.jsxs("div",{children:[o.jsx(Ne,{htmlFor:"decoracao_valor",children:"Valor da Decoração"}),o.jsx(je,{name:"decoracao_valor",control:g,render:({field:_})=>o.jsx(Te,{id:"decoracao_valor",placeholder:"Ex: 10.000",..._,onChange:V=>le("decoracao_valor",V.target.value),disabled:e||!M||ve(M)<=0})}),C.decoracao_valor&&o.jsx("p",{className:"text-sm text-red-500",children:C.decoracao_valor.message})]}),o.jsxs("div",{children:[o.jsx(Ne,{htmlFor:"decoracao_percentual",children:"% sobre V. Imóvel (Decoração)"}),o.jsx(je,{name:"decoracao_percentual",control:g,render:({field:_})=>o.jsx(Te,{id:"decoracao_percentual",placeholder:"Ex: 5",..._,onChange:V=>F("decoracao_percentual",V.target.value),onKeyDown:V=>O("decoracao_percentual",V),disabled:e||!M||ve(M)<=0})}),C.decoracao_percentual&&o.jsx("p",{className:"text-sm text-red-500",children:C.decoracao_percentual.message})]})]})]}),o.jsxs("div",{className:"mb-6 space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(Ne,{htmlFor:"incluir_closing_costs",className:"flex flex-col space-y-1",children:[o.jsx("span",{children:"Incluir Custos de Fechamento (Closing Costs)?"}),o.jsx("span",{className:"font-normal leading-snug text-muted-foreground",children:"Adicione as despesas de transação ao cálculo."})]}),o.jsx(je,{name:"incluir_closing_costs",control:g,render:({field:_})=>o.jsx(kt,{id:"incluir_closing_costs",checked:_.value??!1,onCheckedChange:_.onChange,disabled:e})})]}),X&&o.jsxs("div",{className:"pt-2",children:[o.jsx(Ne,{htmlFor:"closing_costs_percentual",children:"% sobre V. Imóvel (Custos de Fechamento)"}),o.jsx(je,{name:"closing_costs_percentual",control:g,render:({field:_})=>o.jsx(Te,{id:"closing_costs_percentual",placeholder:"Ex: 2",..._,onChange:V=>F("closing_costs_percentual",V.target.value),onKeyDown:V=>O("closing_costs_percentual",V),disabled:e||!M||ve(M)<=0})}),C.closing_costs_percentual&&o.jsx("p",{className:"text-sm text-red-500",children:C.closing_costs_percentual.message})]})]})]});case 2:return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{htmlFor:"localizacao",children:"Localização"}),o.jsx(je,{name:"localizacao",control:g,render:({field:_})=>o.jsx(Te,{id:"localizacao",placeholder:"Ex: Orlando, Florida",..._,disabled:e})}),C.localizacao&&o.jsx("p",{className:"text-sm text-red-500",children:C.localizacao.message})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{htmlFor:"modelo",children:"Modelo do Imóvel"}),o.jsx(je,{name:"modelo",control:g,render:({field:_})=>o.jsx(Te,{id:"modelo",placeholder:"Ex: Casa, Apartamento",..._,disabled:e})}),C.modelo&&o.jsx("p",{className:"text-sm text-red-500",children:C.modelo.message})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx(Ne,{htmlFor:"quartos",children:"Quartos"}),o.jsx(je,{name:"quartos",control:g,render:({field:_})=>o.jsxs(Hs,{onValueChange:_.onChange,value:_.value,disabled:e,children:[o.jsx(Ys,{id:"quartos",children:o.jsx(Ks,{placeholder:"Nº de quartos"})}),o.jsxs(Gs,{children:[[...Array(10)].map((V,Y)=>o.jsxs(va,{value:String(Y+1),children:[Y+1," quarto(s)"]},Y+1)),o.jsx(va,{value:"10+",children:"10+ quartos"})]})]})}),C.quartos&&o.jsx("p",{className:"text-sm text-red-500",children:C.quartos.message})]}),o.jsxs("div",{className:"flex flex-col justify-end",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[o.jsx(je,{name:"piscina",control:g,render:({field:_})=>o.jsx(kt,{id:"piscina",checked:_.value,onCheckedChange:_.onChange,disabled:e})}),o.jsx(Ne,{htmlFor:"piscina",children:"Piscina Privativa?"})]}),C.piscina&&o.jsx("p",{className:"text-sm text-red-500",children:C.piscina.message})]})]})]});case 3:return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"mb-4",children:[o.jsx(Ne,{htmlFor:"logo",children:"Logo do Corretor (Opcional)"}),o.jsx(Te,{id:"logo",type:"file",accept:"image/*",onChange:de,disabled:e||a}),a&&o.jsx("p",{className:"text-sm text-blue-500 mt-1",children:"Enviando logo..."}),r&&o.jsx("div",{className:"mt-4",children:o.jsx("img",{src:r,alt:"Pré-visualização do Logo",className:"max-w-xs h-auto rounded-md border"})})]})});default:return o.jsx("div",{children:"Etapa desconhecida"})}};return D.useEffect(()=>{n===2&&(x!=null&&x.localizacao||p("localizacao",""),x!=null&&x.modelo||p("modelo",""))},[n,p,x]),o.jsx(qe,{className:"w-full max-w-2xl mx-auto",children:o.jsx(Ht,{className:"p-6",children:o.jsxs("form",{onSubmit:I(ye),className:"space-y-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx(sa,{value:n/i*100,className:"w-full"}),o.jsxs("p",{className:"text-sm text-center mt-2 text-gray-600",children:["Etapa ",n," de ",i]})]}),te(),o.jsxs("div",{className:"flex justify-between items-center pt-6",children:[o.jsxs("button",{type:"button",onClick:d,disabled:n===1||e,className:"shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear flex items-center disabled:opacity-50",children:[o.jsx($t,{className:"mr-2 h-4 w-4"})," Anterior"]}),n<i&&o.jsxs("button",{type:"button",onClick:se,className:"ml-auto shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear flex items-center",children:["Próximo ",o.jsx(rr,{size:16,className:"ml-2"})]}),n===i&&o.jsxs("button",{type:"submit",disabled:e||a,className:"w-full sm:w-auto shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear flex items-center justify-center disabled:opacity-50",children:[e?o.jsx(ls,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Analisar ROI"]})]})]})})})},ie=(t,e={})=>{const{showCents:a=!0,abbreviate:s=!1}=e;if(t==null||isNaN(Number(t)))return"$0";const r=typeof t=="string"?parseFloat(t.replace(/[^\d.-]/g,"")):t;if(isNaN(r))return"$0";if(s){if(Math.abs(r)>=1e9)return`$${(r/1e9).toFixed(1)}B`;if(Math.abs(r)>=1e6)return`$${(r/1e6).toFixed(1)}M`;if(Math.abs(r)>=1e3)return`$${(r/1e3).toFixed(1)}K`}return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:a?2:0,maximumFractionDigits:a?2:0}).format(r)},Is=D.forwardRef(({result:t,logoUrl:e,onNewAnalysis:a,showBackButton:s=!0,backPath:r="/",backText:n="Voltar",onBack:i},l)=>{const d=D.useRef(null),m=x=>`${x.toFixed(1)}%`,h=async()=>{if(!d.current){Ie.error("Conteúdo não encontrado para exportação");return}try{const x=`ROI_Analise_${t.projectName||"Propriedade"}.pdf`;await or(d.current,x,e),Ie.success("PDF exportado com sucesso!")}catch(x){console.error("Erro ao exportar PDF:",x),Ie.error("Erro ao exportar PDF",{description:"Não foi possível gerar o arquivo PDF."})}};return o.jsxs("div",{ref:l,className:"max-w-7xl mx-auto p-4 space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-8",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("button",{onClick:i,className:"flex items-center gap-2 shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear",children:[o.jsx($t,{size:16}),"Voltar para Dashboard"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ir,{size:16,className:"text-gray-500"}),o.jsx("span",{className:"text-sm text-gray-500",children:"Resultados em segundos"})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:a,className:"shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear",children:"Nova Análise"}),o.jsx("button",{onClick:h,className:"shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear",children:"Salvar como PDF"})]})]}),o.jsx("div",{ref:d,className:"w-full bg-white",style:{width:"100%",minWidth:"1000px",maxWidth:"1600px",backgroundColor:"#ffffff",boxSizing:"border-box",margin:"0 auto",padding:"24px",fontSize:"14px",lineHeight:"1.4"},children:o.jsxs("div",{className:"space-y-5",children:[o.jsx(qe,{className:"bg-white rounded-lg p-5 shadow-sm border border-gray-200",children:o.jsxs("div",{className:"flex items-center justify-between mb-5",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex-shrink-0",children:e?o.jsx("img",{src:e,alt:"Logo do Corretor",className:"h-12 w-auto object-scale-down",crossOrigin:"anonymous"}):o.jsx("img",{src:nr,alt:"Arca AI Logo",className:"h-12 w-auto object-scale-down",crossOrigin:"anonymous"})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[o.jsx("h1",{className:"text-2xl font-bold",children:t.projectName}),o.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((x,g)=>o.jsx(lr,{size:16,className:"fill-yellow-400 text-yellow-400"},g))}),o.jsx("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded text-sm font-medium",children:"PREMIUM"})]}),o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsx("p",{className:"text-base text-gray-600",children:t.location}),o.jsxs("p",{className:"text-base text-gray-600",children:[t.modelo,", ",t.bedrooms," quartos",t.hasPool?", com piscina":""]})]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Valor:"}),o.jsx("p",{className:"text-2xl font-bold",children:ie(t.purchasePrice)})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5 mt-5",children:[o.jsxs("div",{className:"bg-arca-main p-7 rounded-lg text-white",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(Yt,{size:20}),o.jsx("h2",{className:"text-base font-semibold uppercase",children:"ROI sobre investimento"})]}),o.jsx("p",{className:"text-4xl font-bold mb-2",children:m(t.propertyData.cash_on_cash_return_liquido_antes_ir)}),o.jsx("p",{className:"text-sm text-blue-100",children:"Retorno sobre valor investido"})]}),o.jsxs("div",{className:"bg-green-500 p-7 rounded-lg text-white",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx(ha,{size:20}),o.jsx("h2",{className:"text-base font-semibold uppercase",children:"Retorno anual total"})]}),o.jsx("p",{className:"text-4xl font-bold mb-2",children:ie((t.propertyData.fluxo_caixa_anual_antes_ir||t.propertyData.fluxo_caixa_mensal_antes_ir*12)+t.propertyData.valorizacao_valor_anual_estimado)}),o.jsx("p",{className:"text-sm text-green-100",children:"Aluguel + valorização anual"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-5 mt-5",children:[o.jsxs(qe,{className:"p-5",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[o.jsx(Na,{size:20,className:"text-blue-500"}),"FINANCIAMENTO"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Valor do imóvel"}),o.jsx("p",{className:"text-base font-semibold",children:ie(t.purchasePrice)})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-500",children:["Entrada (",t.downPaymentPercent,"%)"]}),o.jsx("p",{className:"text-base font-semibold",children:ie(t.downPaymentValue)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Parcela mensal"}),o.jsxs("p",{className:"text-base font-semibold text-red-500",children:["-",ie(t.propertyData.parcela_mensal)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Taxa de juros"}),o.jsxs("p",{className:"text-base font-semibold",children:[t.propertyData.taxa_juros_anual_financiamento,"%"]})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-500",children:["Closing Costs (",m(t.propertyData.percentual_closing_costs_aplicado),")"]}),o.jsx("p",{className:"text-base font-semibold",children:ie(t.propertyData.closing_costs_total)})]}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-500",children:["Decoração (",m(t.propertyData.percentual_decoracao_aplicado),")"]}),o.jsx("p",{className:"text-base font-semibold",children:ie(t.propertyData.decoracao_total)})]})]})]}),o.jsxs(qe,{className:"p-5",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[o.jsx(cr,{size:20,className:"text-green-500"}),"RECEITA DE ALUGUEL"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Diária média"}),o.jsx("p",{className:"text-base font-semibold",children:ie(t.propertyData.diaria_media_estimada||t.propertyData.receita_aluguel_mensal/24)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Ocupação"}),o.jsxs("p",{className:"text-base font-semibold",children:[t.annualOccupancyRate,"%"]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Aluguel mensal"}),o.jsxs("p",{className:"text-base font-semibold text-green-500",children:["+",ie(t.propertyData.receita_aluguel_mensal)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-500",children:"Aluguel anual"}),o.jsxs("p",{className:"text-base font-semibold text-green-500",children:["+",ie(t.propertyData.receita_aluguel_mensal*12)]})]})]})]}),o.jsxs(qe,{className:"p-4",children:[o.jsxs("h3",{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[o.jsx(Na,{size:18,className:"text-red-500"}),"DESPESAS MENSAIS"]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-xs text-gray-500",children:["ADMIN (",t.propertyData.percentual_taxa_administracao_mensal,"%)"]}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_taxa_administracao_mensal)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"HOA"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_condominio_mensal)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"ENERGIA"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_energia_mensal)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"ÁGUA"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_agua_mensal)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"IPTU"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_iptu_mensal)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"SEGURO"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_seguro_mensal)})]}),t.hasPool&&o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"PISCINA"}),o.jsx("p",{className:"text-sm font-medium",children:ie(t.propertyData.valor_piscina_mensal||120)})]})]}),o.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[o.jsxs("div",{className:"flex justify-between mb-1",children:[o.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total mensal"}),o.jsxs("p",{className:"text-base font-semibold text-red-500",children:["-",ie(t.propertyData.despesas_operacionais_mensais)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Anual"}),o.jsxs("p",{className:"text-base font-semibold text-red-500",children:["-",ie(t.propertyData.despesas_operacionais_mensais*12)]})]})]})]}),o.jsxs(qe,{className:"p-4",children:[o.jsxs("h3",{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[o.jsx(ha,{size:18,className:"text-blue-500"}),"FLUXO DE CAIXA LÍQUIDO"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Rendimento Mensal (após despesas)"}),o.jsxs("p",{className:"text-base font-semibold text-green-500",children:["+",ie(t.propertyData.receita_aluguel_mensal-t.propertyData.despesas_operacionais_mensais)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Rendimento Anual (após despesas)"}),o.jsxs("p",{className:"text-base font-semibold text-green-500",children:["+",ie((t.propertyData.receita_aluguel_mensal-t.propertyData.despesas_operacionais_mensais)*12)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Parcela Financiamento"}),o.jsxs("p",{className:"text-base font-semibold text-red-500",children:["-",ie(t.propertyData.parcela_mensal)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Sobra Líquida Mensal"}),o.jsx("p",{className:"text-base font-semibold text-blue-600",children:ie(t.propertyData.fluxo_caixa_mensal_antes_ir)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Rendimento Mensal (após financiamento)"}),o.jsx("p",{className:"text-base font-semibold text-blue-600",children:ie(t.propertyData.fluxo_caixa_mensal_antes_ir)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Rendimento Anual (após financiamento)"}),o.jsx("p",{className:"text-base font-semibold text-blue-600",children:ie(t.propertyData.fluxo_caixa_anual_antes_ir||t.propertyData.fluxo_caixa_mensal_antes_ir*12)})]})]})]})]}),o.jsxs(qe,{className:"p-4",children:[o.jsxs("h3",{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[o.jsx(Yt,{size:18,className:"text-yellow-500"}),"VALORIZAÇÃO ANUAL"]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Percentual"}),o.jsx("p",{className:"text-base font-semibold",children:"6%"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-gray-500",children:"Valor anual"}),o.jsxs("p",{className:"text-base font-semibold text-yellow-600",children:["+",ie(t.propertyData.valorizacao_valor_anual_estimado)]})]})]})]}),o.jsx("div",{className:"text-xs text-gray-500 bg-white p-3 rounded-lg mt-4 border border-gray-200",children:o.jsx("p",{children:"* Os valores apresentados são estimativas conservadoras e podem variar conforme sazonalidade e localização."})}),o.jsxs("div",{className:"text-center text-xs text-gray-500 mt-4",children:["Tom Assistant | Análise de ROI gerada com Arca Insights AI - © ",new Date().getFullYear()," Arca Intelligence"]})]})})]})});Is.displayName="TomROIResults";const gn=({stage:t="Analisando dados...",percentage:e=0,onRetry:a})=>{as();const[s,r]=D.useState(0),[n,i]=D.useState(!1),[l,d]=D.useState(!1);D.useEffect(()=>{const I=setInterval(()=>{r(C=>(C+1)%g.length)},5e3),S=setTimeout(()=>{i(!0)},3e4),p=setTimeout(()=>{a&&d(!0)},6e4);return()=>{clearInterval(I),clearTimeout(S),clearTimeout(p)}},[a]);const m=I=>{switch(I){case"creating-thread":return"Iniciando análise...";case"sending-message":return"Enviando dados...";case"running-assistant":return"Analisando propriedade...";case"checking-status":return"Verificando resultados...";case"getting-results":return"Preparando relatório...";case"complete":return"Análise concluída!";default:return"Processando..."}},h=()=>{switch(t){case"creating-thread":return"Estabelecendo conexão com o assistente de análise de ROI";case"sending-message":return"Transmitindo os detalhes do imóvel para análise";case"running-assistant":return"O assistente está processando os dados e calculando retornos";case"checking-status":return e>=85?"Finalizando cálculos e preparando visualizações":e>=75?"Analisando dados de mercado e calculando projeções":"Verificando o progresso da análise (isso pode demorar alguns segundos)";case"getting-results":return"Análise concluída, preparando a exibição dos resultados";case"complete":return"Pronto! Exibindo os resultados da análise";default:return"Inicializando o sistema de análise"}},x=()=>n?"Tempo estimado: pode demorar mais alguns minutos":e<60?"Tempo estimado: cerca de 1 minuto":e<80?"Tempo estimado: mais 30 segundos":e<95?"Quase pronto...":"Finalizando...",g=["A diária média para casas de 3 quartos em Davenport varia entre $180 e $250 dependendo da época do ano.","A valorização média de imóveis na Flórida tem sido acima de 5% ao ano na última década.","Propriedades com piscina têm em média 15% mais ocupação do que propriedades similares sem piscina.","O ROI (Retorno sobre Investimento) médio para casas de temporada na Flórida fica entre 6% e 12% ao ano.","Uma boa administradora de propriedades é essencial para maximizar a ocupação e cuidar da manutenção.","As taxas de condomínio (HOA) em resorts variam bastante, mas geralmente incluem acesso às áreas de lazer.","Considere os custos de manutenção regular e reservas para reparos maiores no seu planejamento financeiro.","A análise está em andamento. Para resultados completos, por favor aguarde até finalizar.","Estamos analisando dados de mercado em tempo real para fornecer a análise mais precisa.","As análises ROI mais precisas dependem de múltiplos fatores, incluindo taxa de ocupação e custos operacionais."];return o.jsx("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:o.jsxs("div",{className:"w-full max-w-md space-y-8",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"w-12 h-12 border-4 border-arca-main border-t-transparent rounded-full animate-spin mb-6"}),o.jsx("h2",{className:"text-2xl font-bold",children:m(t)})]}),o.jsx("div",{children:o.jsx(sa,{value:e,className:"h-2"})}),o.jsx("p",{className:"text-gray-600",children:h()}),o.jsx("p",{className:"text-sm text-gray-500",children:x()}),n&&o.jsx("p",{className:"text-sm text-gray-500",children:g[s]}),l&&a&&o.jsxs(st,{variant:"outline",onClick:a,className:"flex items-center gap-2",children:[o.jsx(ss,{size:16}),"Tentar novamente"]})]})})};function _n(t,e,a){if(console.log("[CALC_PARCELA] Parâmetros recebidos:",{valorFinanciado:t,taxaJurosAnual:e,prazoAnos:a}),t<=0)return console.warn("[CALC_PARCELA] Valor financiado inválido:",t),0;if(isNaN(e)||e<0)return console.warn("[CALC_PARCELA] Taxa de juros inválida:",e),0;if(isNaN(a)||a<=0)return console.warn("[CALC_PARCELA] Prazo inválido:",a),0;const s=e/12,r=a*12;if(console.log("[CALC_PARCELA] Parâmetros convertidos:",{taxaMensal:s,prazoMeses:r}),s===0){const x=t/r;return console.log("[CALC_PARCELA] Financiamento sem juros, parcela:",x),Math.round(x*100)/100}const n=1+s,i=Math.pow(n,r),l=s*i,d=i-1;if(console.log("[CALC_PARCELA] Cálculos intermediários:",{fatorUmMaisTaxa:n,fatorPotencia:i,numerador:l,denominador:d}),d===0||isNaN(d)||!isFinite(d))return console.error("[CALC_PARCELA] Denominador inválido:",d),0;const m=t*(l/d);if(console.log("[CALC_PARCELA] Parcela calculada antes do arredondamento:",m),isNaN(m)||!isFinite(m)||m<0)return console.error("[CALC_PARCELA] Parcela calculada é inválida:",m),0;const h=Math.round(m*100)/100;return console.log("[CALC_PARCELA] Parcela final:",h),h}function xn(t){return t<=2?150:t===3?167:t===4?200:t===5?233:t===6?267:t===7?300:t===8?333:t>=9&&t<=10?367:t>10?400:167}function vn(t,e=!1){const a={2:70,3:80,4:90,5:100,6:110,7:120,8:130,9:140,10:140},s={2:110,3:120,4:130,5:140,6:150,7:160,8:170,9:180,10:180};if(t>10)return e?190:150;const n=(e?s:a)[t];return n||(e?120:80)}const yn=t=>t==null||isNaN(t)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t);function bn(t){if(!t)return console.error("[ERRO] gerarPromptRoiAnalise recebeu propertyData inválido."),"Analise um investimento imobiliário padrão em Orlando, FL, com valor aproximado de $500,000 e 4 quartos. Forneça uma análise de ROI detalhada. (Fallback devido a dados de propriedade ausentes)";try{const e=yn,a=e(t.valor_imovel),s=e(t.valor_entrada),r=(t.percentual_entrada||0).toFixed(1),n=e(t.valor_financiado),i=(t.taxa_juros_anual_financiamento||0).toFixed(2),l=t.prazo_financiamento_anos||30,d=e(t.parcela_mensal),m=e(t.monthlyRent/30.44),h=(t.occupancyRate||0).toFixed(1),x=e(t.receita_aluguel_mensal),g=e(t.annualRent),I=e(t.despesas_totais_mensais),S=t.despesas_totais_mensais*12,p=e(S),C=e(t.fluxo_caixa_mensal_antes_ir),Z=t.fluxo_caixa_mensal_antes_ir*12,R=e(Z),M=(t.valorizacao_percentual_anual_estimada||3).toFixed(1),L=e(t.valorizacao_valor_anual_estimado||t.valor_imovel*.03),X=e(Z+(t.valorizacao_valor_anual_estimado||t.valor_imovel*.03)),he=(t.cash_on_cash_return_liquido_antes_ir||0).toFixed(1),U=`
<s>
Você é Tom, um assistente especializado em análise de investimentos imobiliários para propriedades de temporada na região de Orlando, Kissimmee, Clermont e Davenport, na Flórida.

REGRAS DE CÁLCULO AUTOMÁTICAS APLICADAS:
📋 **Seguro Residencial Mensal:** Calculado automaticamente baseado no número de quartos:
- 2 quartos: $150  • 3 quartos: $167  • 4 quartos: $200  • 5 quartos: $233
- 6 quartos: $267  • 7 quartos: $300  • 8 quartos: $333  • 9-10 quartos: $367  • 10+ quartos: $400

💧 **Água Mensal:** Calculado automaticamente baseado no número de quartos e presença de piscina:
- SEM piscina: 2q: $70 | 3q: $80 | 4q: $90 | 5q: $100 | 6q: $110 | 7q: $120 | 8q: $130 | 9-10q: $140 | 10+q: $150
- COM piscina: 2q: $110 | 3q: $120 | 4q: $130 | 5q: $140 | 6q: $150 | 7q: $160 | 8q: $170 | 9-10q: $180 | 10+q: $190

IMPORTANTE: 
1. Use APENAS os valores numéricos fornecidos abaixo. Não recalcule, não invente novos valores, não altere nenhum número.
2. TODOS os valores monetários devem ser retornados em milhares. Por exemplo:
   - Para um imóvel de $900,000, use "US$ 900,000.00"
   - Para uma diária de $300, use "US$ 300.00"
3. Estes dados já foram calculados de forma precisa e você deve apenas formatá-los e explicá-los de forma clara.
4. Os valores de seguro e água foram calculados automaticamente pelas regras acima.
</s>

Gere uma análise de ROI detalhada para o seguinte imóvel com base nos dados exatos fornecidos:

📍 **Informações do Imóvel**
- Condomínio: ${t.nome_condominio||"Não especificado"}
- Localização: ${t.localizacao_imovel||"Orlando, FL"}
- Modelo: ${t.modelo_imovel||"Padrão"}
- Quartos: ${t.quartos_imovel||"4"}
- Possui piscina: ${t.piscina_imovel?"Sim":"Não"}

💰 **Dados do Investimento**
- Valor do imóvel: ${a}
- Entrada: ${s} (${r}%)
- Financiamento: ${n}
- Taxa de juros: ${i}% a.a.
- Prazo: ${l} anos
- Parcela mensal: ${d}

🏨 **Dados de Aluguel**
- Diária média: ${m}
- Taxa de ocupação: ${h}%
- Receita mensal (líquida de vacância): ${x}
- Receita anual (líquida de vacância): ${g}

💸 **Despesas Operacionais**
- Despesas mensais totais (sem financiamento): ${e(t.despesas_totais_mensais-t.parcela_mensal)} 
- Despesas anuais totais (sem financiamento): ${e((t.despesas_totais_mensais-t.parcela_mensal)*12)}
- Despesas mensais totais (sem parcela de financiamento): ${e(t.despesas_totais_mensais-t.parcela_mensal<0?t.despesas_totais_mensais:t.despesas_totais_mensais-t.parcela_mensal)} 
- Despesas anuais totais (sem parcela de financiamento): ${e((t.despesas_totais_mensais-t.parcela_mensal<0?t.despesas_totais_mensais:t.despesas_totais_mensais-t.parcela_mensal)*12)}
${Object.entries(t.despesas_detalhadas_mensais||{}).map(([ye,le])=>`  - ${ye.replace(/_/g," ").replace(/\b\w/g,_e=>_e.toUpperCase())}: ${e(le)}/mês`).join(`
`)||"  (Detalhes das despesas não disponíveis)"}

📊 **Fluxo de Caixa**
- Fluxo de caixa mensal (após financiamento e despesas): ${C}
- Fluxo de caixa anual (após financiamento e despesas): ${R}

📈 **Valorização e Retorno**
- Valorização anual estimada: ${M}% (${L}/ano)
- Retorno anual total (Fluxo de Caixa Anual + Valorização Anual Estimada): ${X} (Este valor combina o lucro líquido do aluguel com o ganho estimado de valorização do imóvel no ano)
- Cash-on-Cash ROI (sobre o valor da entrada, antes de Imposto de Renda): ${he}% (Este percentual mostra o retorno líquido anual sobre o dinheiro efetivamente investido na entrada)

Forneça uma análise clara e objetiva com base EXATAMENTE nesses números. Explique as vantagens deste investimento, o que o ROI de ${he}% significa na prática, e como este investimento se compara a outras opções de mercado.

Ao final, apresente um RESUMO DO INVESTIMENTO com os valores principais e uma conclusão sobre a qualidade do investimento.
`;return!U||U.trim().length<100?(console.error("[ERRO] Prompt gerado está vazio ou muito curto"),`Analise o investimento imobiliário: Valor ${a}, Entrada ${s}, Aluguel ${x}, ROI ${he}%. (Fallback: prompt curto demais)`):(console.log(`[INFO] Prompt gerado com sucesso: ${U.length} caracteres`),U)}catch(e){return console.error("[ERRO] Exceção ao gerar prompt:",e),`Analise um investimento imobiliário com os seguintes dados aproximados: Valor $500,000, Entrada $100,000, Aluguel Mensal $3,500. (Fallback: exceção ao gerar prompt - ${e.message})`}}const Nn=[{condominio:"Windsor Cay Resort",quartos3:485,quartos4:520,quartos5:560,quartos6Plus:600,localizacao:"Kissimmee"},{condominio:"Windsor Island Resort",quartos3:730,quartos4:760,quartos5:790,quartos6Plus:810,localizacao:"Kissimmee"},{condominio:"Reunion Resort",quartos3:500,quartos4:580,quartos5:640,quartos6Plus:700,localizacao:"Reunion"},{condominio:"Storey Lake Resort",quartos3:350,quartos4:380,quartos5:415,quartos6Plus:450,localizacao:"Kissimmee"},{condominio:"Solara Resort",quartos3:400,quartos4:430,quartos5:465,quartos6Plus:500,localizacao:"Davenport"},{condominio:"Bella Vida Resort",quartos3:250,quartos4:280,quartos5:315,quartos6Plus:350,localizacao:"Kissimmee"},{condominio:"Vila Sol Resort",quartos3:300,quartos4:330,quartos5:365,quartos6Plus:400,localizacao:"Kissimmee"},{condominio:"Champions Gate Resort",quartos3:400,quartos4:430,quartos5:465,quartos6Plus:500,localizacao:"Davenport"},{condominio:"Paradise Palms Resort",quartos3:350,quartos4:380,quartos5:415,quartos6Plus:450,localizacao:"Kissimmee"},{condominio:"Emerald Island Resort",quartos3:300,quartos4:330,quartos5:365,quartos6Plus:400,localizacao:"Kissimmee"},{condominio:"Encantada Resort",quartos3:250,quartos4:280,quartos5:315,quartos6Plus:350,localizacao:"Kissimmee"},{condominio:"Windsor Hills Resort",quartos3:300,quartos4:330,quartos5:365,quartos6Plus:400,localizacao:"Kissimmee"},{condominio:"Windsor Palms Resort",quartos3:350,quartos4:380,quartos5:415,quartos6Plus:450,localizacao:"Kissimmee"},{condominio:"West Lucaya Village Resort",quartos3:400,quartos4:430,quartos5:465,quartos6Plus:500,localizacao:"Kissimmee"},{condominio:"Solterra Resort",quartos3:400,quartos4:430,quartos5:465,quartos6Plus:500,localizacao:"Davenport"},{condominio:"Mystic Dunes Resort",quartos3:350,quartos4:380,quartos5:415,quartos6Plus:450,localizacao:"Kissimmee"},{condominio:"Orange Lake Resort",quartos3:450,quartos4:480,quartos5:515,quartos6Plus:550,localizacao:"Kissimmee"},{condominio:"Champions World Resort",quartos3:300,quartos4:330,quartos5:365,quartos6Plus:400,localizacao:"Davenport"},{condominio:"Reunion Golf Resort",quartos3:500,quartos4:580,quartos5:640,quartos6Plus:700,localizacao:"Reunion"},{condominio:"Terra Verde Resort",quartos3:250,quartos4:280,quartos5:315,quartos6Plus:350,localizacao:"Kissimmee"}],jn=(t,e)=>{const a=t.toLowerCase().replace(/[áàâãä]/g,"a").replace(/[éèêë]/g,"e").replace(/[íìîï]/g,"i").replace(/[óòôõö]/g,"o").replace(/[úùûü]/g,"u").trim(),s=Nn.find(r=>r.condominio.toLowerCase().includes(a)||a.includes(r.condominio.toLowerCase()));if(!s)return null;switch(e){case 3:return s.quartos3;case 4:return s.quartos4;case 5:return s.quartos5;case 6:default:return s.quartos6Plus}},Ja=t=>{const e={3:365,4:395,5:430,6:465};return e[t]||e[6]},ft=(t,e)=>t==null||isNaN(t)?e:t,An=(t,e,a,s,r)=>{console.log("[CALC_FINANC] valorImovel recebido:",t),console.log("[CALC_FINANC] Parâmetros financiamento - taxa:",s,"prazo:",r);let n=25,i=t>0?t*(n/100):0;if(t>0){if(a!=null&&!isNaN(a)&&a>=25)n=a,i=t*(n/100);else if(e!=null&&!isNaN(e)){const g=e/t*100;g>=25&&(i=e,n=g)}}else i=0,n=0;const l=t>0?t*.05:0,d=t>0?t*.15:0;console.log("[CALC_FINANC] closingCosts calculado:",l,"custoDecoracao calculado:",d);const m=Math.max(0,t-i);let h=0;m>0&&(r<=0||isNaN(r)?(console.warn("[CALC_FINANC] Prazo de financiamento inválido:",r),h=0):s<0||isNaN(s)?(console.warn("[CALC_FINANC] Taxa de juros inválida:",s),h=0):(h=_n(m,s/100,r),h<0&&(console.warn("[CALC_FINANC] Parcela calculada é negativa:",h,"Forçando para 0"),h=0)));const x={valorEntrada:i,percentualEntrada:n,closingCosts:l,custoDecoracao:d,valorFinanciado:m,parcelaMensalFinanciamento:h};return console.log("[CALC_FINANC] Objeto FinanciamentoData retornado:",x),x},Cn=t=>{let e=0;switch(t){case 3:e=210;break;case 4:e=235;break;case 5:e=231.33;break;default:e=0,console.warn(`[calcularReceitaEstimada] Número de quartos não usual (${t}), diária estimada será $0.`);break}const a=80,s=30,r=s*(a/100),n=e*r,i=100-a;return console.log("[CALC_RECEITA] Cálculo da receita estimada:",{numeroQuartos:t,diariaMediaEstimada:e,taxaOcupacaoAnual:a+"%",diasNoMes:s,diasOcupadosPorMes:r.toFixed(1),receitaBrutaMensal:"$"+n.toFixed(2),fonte:"padrão por quartos"}),{diariaMediaEstimada:e,taxaOcupacaoAnual:a,receitaBrutaMensal:n,percentualVacanciaAnual:i}},wn=(t,e,a=1,s,r=!1,n=0,i,l,d,m)=>{const h=m&&m>0?m/100:.2,x=t*h;console.log("[CALC_DESPESAS] Aplicando regras automáticas para:",{numeroQuartos:a,temPiscina:r});const g=l&&l>0?l:vn(a,r);let I;I=xn(a),console.log("[CALC_DESPESAS] Valores automáticos aplicados:",{agua:`$${g} (${a} quartos, ${r?"com":"sem"} piscina)`,seguro:`$${I} (${a} quartos)`});const S=75,p=S*a,Z=n*.012/12,R=r?120:0;let M;if(e&&e>0)M=e;else if(s){const X=jn(s,a);X?M=X:M=Ja(a)}else M=Ja(a);const L=x+g+p+I+Z+M+R;return console.log("[CALC_DESPESAS] Detalhamento das despesas mensais:",{adminMensal:"$"+x.toFixed(2)+" ("+(h*100).toFixed(1)+"% - "+(m?"fornecido":"padrão")+")",aguaMensal:"$"+g.toFixed(2)+" (padrão)",energiaMensal:"$"+p.toFixed(2)+" ($"+S+" por quarto - padrão)",seguroMensal:"$"+I.toFixed(2)+" (padrão mensal)",iptuMensal:"$"+Z.toFixed(2)+" (1.2% do valor do imóvel/ano: $"+n.toLocaleString()+")",hoaMensal:"$"+M.toFixed(2),piscinaMensal:"$"+R.toFixed(2)+(r?" (tem piscina)":" (sem piscina)"),totalDespesasOperacionaisMensais:"$"+L.toFixed(2)}),{adminMensal:x,aguaMensal:g,energiaMensal:p,seguroMensal:I,iptuMensal:Z,hoaMensal:M,piscinaMensal:R,totalDespesasOperacionaisMensais:L}},kn=(t,e,a,s,r,n,i,l)=>{const d=a<0;console.log("[CALC_ROI] Parâmetros de entrada:",{receitaBrutaMensal:t,totalDespesasOperacionaisMensais:e,parcelaMensalFinanciamento:a,valorImovel:s,valorEntrada:r,closingCosts:n,custoDecoracao:i,isParcelaNegativa:d,valorizacaoAnualFornecida:l}),d&&(console.error("[CALC_ROI] ⚠️  ALERTA CRÍTICO: Parcela mensal negativa detectada!"),console.error("[CALC_ROI] Valor da parcela:",a),console.error("[CALC_ROI] Isso indica erro crítico nos parâmetros de financiamento."),console.error("[CALC_ROI] FORÇANDO ROI EXTREMAMENTE NEGATIVO..."));const m=t-e-a,h=m*12,x=l&&l>0?l:6,g=s>0?s*(x/100):0,I=r+n+i;let S;if(d){const Z=Math.abs(a)*12;I>0?(S=-(Z/I)*100,S>-100&&(S=-100),S<-500&&(S=-500)):S=-100,console.error("[CALC_ROI] 🔴 ROI NEGATIVO APLICADO:",S.toFixed(2)+"%"),console.error("[CALC_ROI] Razão: Parcela negativa de",ht(a))}else{const Z=h+g;S=I>0?Z/I*100:0,console.log("[CALC_ROI] ✅ ROI calculado normalmente:"),console.log("[CALC_ROI] - Fluxo de Caixa Anual Líquido:",ht(h)),console.log("[CALC_ROI] - Valorização Anual Estimada:",ht(g)),console.log("[CALC_ROI] - Retorno Anual Total:",ht(Z)),console.log("[CALC_ROI] - Custo Total Investimento Inicial:",ht(I)),console.log("[CALC_ROI] - ROI Final:",S.toFixed(2)+"%")}const p=t*12-e*12,C=s>0?p/s*100:0;return console.log("[CALC_ROI] Resultados finais:",{fluxoCaixaMensalLiquido:m,fluxoCaixaAnualLiquido:h,roiEstimado:S.toFixed(2)+"%",capRateLiquidoSobreValorImovel:C.toFixed(2)+"%",custoTotalInvestimentoInicial:I}),{fluxoCaixaMensalLiquido:m,fluxoCaixaAnualLiquido:h,valorizacaoAnualEstimadaValor:g,custoTotalInvestimentoInicial:I,roiEstimado:S,capRateLiquidoSobreValorImovel:C}},ht=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),Xa=t=>{if(!t)return NaN;const e=String(t).replace(/[^\d.-]/g,""),a=parseFloat(e);return isNaN(a)?NaN:a},Qa=t=>{if(t==null||String(t).trim()==="")return;const e=String(t).replace(/[^\d.-]/g,""),a=parseFloat(e);return isNaN(a)?void 0:a},aa=t=>{if(t==null||String(t).trim()==="")return;const e=String(t).replace(/[^\d-]/g,""),a=parseInt(e,10);return isNaN(a)?void 0:a},Wt=18e4,Fs=3,Ps=1e3,$s=15e3,Ms=2,En="2025-05-21-v4",Sn="https://dkykekkdjqajqfyrgqhi.supabase.co",Rn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRreWtla2tkanFhanFmeXJncWhpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU5NjQxNjAsImV4cCI6MjA2MTU0MDE2MH0.iC6tio4Uoj2oxwUAvV9kp6QWQG4MxE6RnhBS9_uFwSY",Ls=t=>new Promise(e=>setTimeout(e,t)),Tn=async(t,e=Fs,a=Ps,s=Ms,r=$s,n)=>{let i=0,l=a;for(;;)try{return i++,await t()}catch(d){if(i>=e)throw console.error(`[RETRY] Todas as ${e} tentativas falharam. Desistindo.`),d;const m=Math.random()*.3+.85;l=Math.min(l*s*m,r),console.log(`[RETRY] Tentativa ${i} falhou. Tentando novamente em ${l}ms...`),n&&n(i,l,d),await Ls(l)}},Je=async(t,e={},a=Fs)=>{console.log(`[FETCH] Chamando Supabase Function '${t}' com payload:`,e);const s=`${Sn}/functions/v1/tom-assistant`;try{return await Tn(async()=>{const n=new AbortController,i=setTimeout(()=>{n.abort(),console.warn(`[FETCH TIMEOUT] Abortando chamada para '${t}' após ${Wt/1e3}s`)},Wt);try{const l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",apikey:Rn},body:JSON.stringify({action:t,version:En,data:e}),signal:n.signal});if(clearTimeout(i),!l.ok){const d=await l.text();throw console.error(`[FETCH ERROR] Erro ${l.status} ao chamar '${t}':`,d),new Error(`Erro HTTP ${l.status}: ${d||l.statusText}`)}return console.log(`[FETCH SUCCESS] Resposta para '${t}'`),await l.json()}catch(l){throw clearTimeout(i),l.name==="AbortError"&&console.error(`[FETCH ABORT] A operação para '${t}' foi abortada (provavelmente timeout).`),l}},a,Ps,Ms,$s,(n,i,l)=>{Ie.warning(`Tentativa ${n} falhou para ${t}. Tentando novamente em ${Math.round(i/1e3)}s...`,{id:`api-retry-${t}`,duration:Math.min(i,5e3)})})}catch(r){throw r.name==="AbortError"?(console.error(`[FETCH TIMEOUT FINAL] A chamada para '${t}' excedeu o tempo limite de ${Wt/1e3}s após retentativas.`),new Error(`Timeout ao chamar a função ${t}. A API demorou muito para responder.`)):(console.error(`[FETCH ERROR FINAL] Erro final ao chamar '${t}':`,r),r)}},Vn=(t,e)=>{console.log("[TRANSFORM] analysisInput.purchasePrice recebido:",t.purchasePrice);const a=ft(t.purchasePrice,5e5);console.log("[TRANSFORM] valorImovel após getValueOrDefault:",a);const r=(g=>g&&g.replace(/\d+$/,"").trim())(t.projectName||""),n=An(a,t.downPaymentValue,t.downPaymentPercent,ft(t.annualInterestRate,7),ft(t.loanTermYears,30)),i=Cn(t.bedrooms),l=wn(i.receitaBrutaMensal,t.condoFeeMonthly,t.bedrooms,t.projectName,t.hasPool||!1,a,void 0,void 0,void 0,t.propertyManagementFeePercent),d=l.totalDespesasOperacionaisMensais+n.parcelaMensalFinanciamento,m=kn(i.receitaBrutaMensal,l.totalDespesasOperacionaisMensais,n.parcelaMensalFinanciamento,a,n.valorEntrada,n.closingCosts,n.custoDecoracao,t.annualAppreciationRate),h=a+n.closingCosts+n.custoDecoracao,x={nome_condominio:r,localizacao_imovel:t.location||"",modelo_imovel:t.modelType||"",quartos_imovel:String(t.bedrooms||"0"),piscina_imovel:t.hasPool||!1,tipo_investimento:n.valorFinanciado>0?"financing":"cash",valor_imovel:a,valor_entrada:n.valorEntrada,percentual_entrada:n.percentualEntrada,valor_financiado:n.valorFinanciado,taxa_juros_anual_financiamento:ft(t.annualInterestRate,7),prazo_financiamento_anos:ft(t.loanTermYears,30),parcela_mensal:n.parcelaMensalFinanciamento,closing_costs_total:n.closingCosts,decoracao_total:n.custoDecoracao,percentual_closing_costs_aplicado:5,percentual_decoracao_aplicado:15,diaria_media_estimada:i.diariaMediaEstimada,receita_aluguel_mensal:i.receitaBrutaMensal,occupancyRate:i.taxaOcupacaoAnual,percentual_vacancia_anual:i.percentualVacanciaAnual,valor_condominio_mensal:l.hoaMensal,valor_iptu_mensal:l.iptuMensal,valor_seguro_mensal:l.seguroMensal,valor_energia_mensal:l.energiaMensal,valor_agua_mensal:l.aguaMensal,percentual_taxa_administracao_mensal:20,valor_taxa_administracao_mensal:l.adminMensal,valor_piscina_mensal:l.piscinaMensal,despesas_operacionais_mensais:l.totalDespesasOperacionaisMensais,despesas_totais_mensais:d,fluxo_caixa_mensal_antes_ir:m.fluxoCaixaMensalLiquido,fluxo_caixa_anual_antes_ir:m.fluxoCaixaAnualLiquido,custo_total_investimento_inicial:m.custoTotalInvestimentoInicial,custo_total_aquisicao:h,cap_rate_liquido_sobre_valor_imovel:m.capRateLiquidoSobreValorImovel,cash_on_cash_return_liquido_antes_ir:m.roiEstimado,valorizacao_percentual_anual_estimada:6,valorizacao_valor_anual_estimado:m.valorizacaoAnualEstimadaValor,monthlyRent:i.receitaBrutaMensal,annualRent:i.receitaBrutaMensal*12,grossIncome:i.receitaBrutaMensal*12,netIncome:m.fluxoCaixaAnualLiquido,roi:m.roiEstimado,capRate:m.capRateLiquidoSobreValorImovel,cashOnCash:m.roiEstimado,texto_analise_ia:null,prompt_utilizado_ia:null,logo_broker_url:e,despesas_detalhadas_mensais:{condominio:l.hoaMensal,iptu:l.iptuMensal,seguro:l.seguroMensal,taxa_administracao:l.adminMensal,agua:l.aguaMensal,energia:l.energiaMensal,piscina:l.piscinaMensal,parcela_financiamento:n.parcelaMensalFinanciamento}};return console.log("[TRANSFORM] PropertyData final (antes de retornar):",x),x},On=t=>{console.log("[CONVERT_INPUT] formValues.valor_imovel ANTES do parse:",t.valor_imovel);const e=Xa(t.valor_imovel);console.log("[CONVERT_INPUT] valorImovelParsed APÓS parseCurrencyUSD:",e);const s=(r=>r&&r.replace(/\d+$/,"").trim())(t.condominio||"");return console.log("[CONVERT_INPUT] Nome do condomínio limpo:",{original:t.condominio,cleaned:s}),{projectName:s,location:t.localizacao||"",modelType:t.modelo||"",modelo:t.modelo||"",bedrooms:aa(t.quartos)||0,hasPool:t.piscina||!1,purchasePrice:e,downPaymentValue:Xa(t.entrada_valor)||0,downPaymentPercent:Qa(t.entrada_percentual)||0,brokerLogoUrl:t.logoUrl||null,annualInterestRate:Qa(t.taxa_juros_anual_financiamento)||7,loanTermYears:aa(t.prazo_financiamento_anos)||30}},In=t=>{var i;const e=t.propertyData;console.log("[EXTRACT_VALUES] Extraindo valores calculados:",e);const a=l=>!l||isNaN(l)?"":Math.round(l).toLocaleString("en-US"),s=l=>!l||isNaN(l)?"":l.toString(),r={valor_condominio_mensal:a(e.valor_condominio_mensal),valor_seguro_anual:a(e.valor_seguro_mensal?e.valor_seguro_mensal*12:void 0),taxa_administracao_percentual:s(e.percentual_taxa_administracao_mensal),taxa_juros_anual_financiamento:s(e.taxa_juros_anual_financiamento),prazo_financiamento_anos:((i=e.prazo_financiamento_anos)==null?void 0:i.toString())||"",valorizacao_anual_estimada_percentual:s(e.valorizacao_percentual_anual_estimada)},n=Object.fromEntries(Object.entries(r).filter(([l,d])=>d!==""));return console.log("[EXTRACT_VALUES] Valores extraídos e formatados:",n),n};function Fn(){const[t,e]=D.useState(!1),[a,s]=D.useState({stage:null,percentage:0}),[r,n]=D.useState(""),[i,l]=D.useState(null),[d,m]=D.useState(!1),h=D.useCallback(async()=>{try{n("Verificando disponibilidade da API..."),console.log("[API_CHECK] Verificando disponibilidade da API..."),await Je("ping"),m(!0),n("API disponível")}catch(g){console.error("[API_CHECK] Erro ao verificar API:",g),m(!1),n("API indisponível ou erro na verificação.")}},[]);D.useEffect(()=>{console.log("[INFO] Verificação inicial da API ao montar o hook."),h()},[h]);const x=D.useCallback(async(g,I,S)=>{try{e(!0),l(null),s({stage:null,percentage:0}),console.log("[ANALYZE_ROI] Dados brutos do formulário recebidos (formValues):",JSON.stringify(g,null,2));const p=On(g);console.log("[ANALYZE_ROI] Dados convertidos para analysisInput:",JSON.stringify(p,null,2));const C=Vn(p,I);console.log("[ANALYZE_ROI] PropertyData calculado (com regras do Tom):",JSON.stringify(C,null,2));const Z="Você é um especialista em análise de investimentos imobiliários internacionais, focado no mercado americano (Florida). Sua análise deve ser detalhada, precisa, e considerar nuances do mercado local. Forneça insights valiosos sobre o potencial de ROI, riscos, e recomendações. Use dólares americanos (USD) para todos os valores monetários.",R=bn(C);console.log(`[ANALYZE_ROI] System Prompt: ${Z.substring(0,100)}... User Prompt: ${R.substring(0,200)}...`),s({stage:"creating-thread",percentage:10});const L=(await Je("createThread")).threadId;s({stage:"sending-message",percentage:20}),await Je("sendMessage",{threadId:L,content:Z}),s({stage:"sending-message",percentage:30}),await Je("sendMessage",{threadId:L,content:R}),s({stage:"running-assistant",percentage:40});const he=(await Je("runAssistant",{threadId:L,instructions:"Analise os dados fornecidos e gere uma análise detalhada do ROI, focando em explicar os resultados financeiros e o potencial do investimento."})).runId;let U="in_progress",ye=0;const le=30;for(;U==="in_progress"&&ye<le&&(s({stage:"checking-status",percentage:40+Math.min(50,Math.round(ye/le*50))}),await Ls(2e3),U=(await Je("checkRunStatus",{threadId:L,runId:he})).status,console.log(`[ANALYZE_ROI] Run status: ${U}, Attempt: ${ye+1}`),U!=="completed");){if(U==="failed"||U==="cancelled"||U==="expired"||U==="requires_action")throw new Error(`A análise da IA falhou ou foi interrompida (status: ${U})`);ye++}if(U!=="completed")throw new Error(`A análise da IA não completou a tempo (status final: ${U}). Tente novamente mais tarde.`);s({stage:"getting-results",percentage:95});const ne=(await Je("getMessages",{threadId:L})).messages.filter(te=>te.role==="assistant"&&te.content&&te.content[0]&&te.content[0].type==="text");if(!ne||ne.length===0||!ne[0].content[0].text.value)throw new Error("Não foi possível obter a análise do assistente ou formato de mensagem inesperado.");const F=ne.map(te=>te.content[0].text.value).join(`

`);console.log("[ANALYZE_ROI] Texto da análise recebido da IA:",F.substring(0,300)+"...");const O={...C,texto_analise_ia:F,prompt_utilizado_ia:R},de={projectName:(te=>te&&te.replace(/\d+$/,"").trim())(O.nome_condominio),location:O.localizacao_imovel,modelType:O.modelo_imovel,modelo:O.modelo_imovel,bedrooms:aa(O.quartos_imovel)??0,hasPool:O.piscina_imovel,purchasePrice:O.valor_imovel,downPaymentValue:O.valor_entrada,downPaymentPercent:O.percentual_entrada||0,annualOccupancyRate:O.occupancyRate,brokerLogoUrl:O.logo_broker_url,resultado_texto:F,propertyData:O,threadId:L,runId:he,statusApi:"success"};return console.log("[ANALYZE_ROI] Resultado final da análise (com regras do Tom):",de),s({stage:"complete",percentage:100}),Ie.success("Análise de ROI Concluída!",{description:"Os resultados estão prontos para visualização."}),S&&S(In(de)),{result:de,propertyData:O}}catch(p){throw console.error("[ANALYZE_ROI] Erro durante análise:",p),l(p),Ie.error("Erro na Análise de ROI",{description:p.message||"Ocorreu um erro desconhecido durante a análise."}),p}finally{e(!1)}},[]);return{isLoading:t,progress:a,apiStatus:r,checkApiStatus:h,analyzeROI:x,currentError:i,isApiAvailable:d}}const Pn=({children:t,onLimitExceeded:e})=>{const a=ts(),{totalLimit:s,used:r,remaining:n,percentage:i,isUnlimited:l,canCreateAnalysis:d,isLoading:m,resetDate:h,planType:x}=rs();return m?o.jsxs("div",{className:"flex items-center justify-center p-8",children:[o.jsx(ls,{className:"w-8 h-8 animate-spin text-blue-600"}),o.jsx("span",{className:"ml-2 text-gray-600",children:"Verificando limites..."})]}):d?o.jsxs("div",{className:"space-y-4",children:[o.jsx(qe,{className:"border-l-4 border-l-blue-500",children:o.jsx(Ht,{className:"p-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[x==="admin"&&o.jsx(pa,{className:"w-5 h-5 text-yellow-500"}),x==="pro"&&o.jsx(ga,{className:"w-5 h-5 text-blue-500"}),x==="free"&&o.jsx(_a,{className:"w-5 h-5 text-gray-500"}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium",children:x==="admin"?"Admin":x==="pro"?"Plano Professional":"Plano Gratuito"}),o.jsx(Us,{variant:"outline",className:"text-xs",children:l?"Ilimitado":`${r}/${s}`})]}),x==="pro"&&h&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[o.jsx(ja,{className:"w-3 h-3"}),o.jsxs("span",{children:["Renova em ",h]})]}),x==="free"&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[n," ",n===1?"análise restante":"análises restantes"]})]})]}),!l&&o.jsxs("div",{className:"text-right",children:[o.jsx(sa,{value:i,className:"w-24 h-2"}),o.jsxs("span",{className:"text-xs text-gray-500 mt-1 block",children:[Math.round(i),"%"]})]})]})})}),t]}):o.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] p-8 text-center",children:o.jsxs(dr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md mx-auto",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(ns,{className:"w-8 h-8 text-orange-600"})}),o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Limite de Análises Atingido"}),o.jsx("p",{className:"text-gray-600 mb-6",children:x==="free"?o.jsxs(o.Fragment,{children:["Você utilizou todas as ",o.jsxs("strong",{children:[s," análises"]})," do seu plano gratuito. Para continuar analisando investimentos, faça upgrade para o plano Professional."]}):o.jsxs(o.Fragment,{children:["Você utilizou todas as ",o.jsxs("strong",{children:[s," análises"]})," deste mês.",h&&o.jsxs("span",{className:"block mt-2 text-sm",children:["Seu limite será renovado em ",o.jsx("strong",{children:h}),"."]})]})})]}),o.jsxs("div",{className:"space-y-4",children:[x==="free"&&o.jsxs(qe,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50",children:[o.jsx(Zs,{className:"pb-3",children:o.jsxs(Bs,{className:"flex items-center gap-2 text-lg",children:[o.jsx(pa,{className:"w-5 h-5 text-blue-600"}),"Plano Professional"]})}),o.jsxs(Ht,{className:"pt-0",children:[o.jsxs("div",{className:"text-left space-y-2 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(Yt,{className:"w-4 h-4 text-green-600"}),o.jsxs("span",{children:[o.jsx("strong",{children:"20 análises"})," por mês"]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(ga,{className:"w-4 h-4 text-blue-600"}),o.jsx("span",{children:"Ferramentas avançadas"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[o.jsx(_a,{className:"w-4 h-4 text-purple-600"}),o.jsx("span",{children:"Relatórios detalhados"})]})]}),o.jsx(st,{onClick:()=>a("/plans"),className:"w-full bg-blue-600 hover:bg-blue-700",children:"Fazer Upgrade - R$ 49,90/mês"})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(st,{variant:"outline",onClick:()=>a("/meus-rois"),className:"flex-1",children:"Ver Minhas Análises"}),x==="pro"&&o.jsx(st,{variant:"outline",onClick:()=>a("/plans"),className:"flex-1",children:"Ver Planos"})]})]}),x==="pro"&&h&&o.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:o.jsxs("div",{className:"flex items-center gap-2 text-blue-800 text-sm",children:[o.jsx(ja,{className:"w-4 h-4"}),o.jsxs("span",{children:["Suas análises serão renovadas automaticamente em ",o.jsx("strong",{children:h})]})]})})]})})},es=3,$n=({error:t,onRetry:e,onBack:a})=>{var i,l,d,m,h,x;const s=((i=t==null?void 0:t.message)==null?void 0:i.includes("Timeout"))||((l=t==null?void 0:t.message)==null?void 0:l.includes("tempo limite")),r=((d=t==null?void 0:t.message)==null?void 0:d.includes("dados insuficientes"))||((m=t==null?void 0:t.message)==null?void 0:m.includes("valor do imóvel")),n=((h=t==null?void 0:t.message)==null?void 0:h.includes("API"))||((x=t==null?void 0:t.message)==null?void 0:x.includes("OpenAI"));return o.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[o.jsx("div",{className:"mb-6 rounded-full p-4 bg-amber-50 text-amber-500",children:o.jsx(ns,{size:48})}),o.jsx("h2",{className:"text-2xl font-bold mb-3",children:s?"Tempo limite excedido":r?"Dados insuficientes para análise":n?"Problema de comunicação com a API":"Não foi possível completar a análise"}),o.jsxs("div",{className:"max-w-md mb-6",children:[o.jsx("p",{className:"text-gray-600 mb-4",children:s?"A API está demorando muito para responder. Isso geralmente acontece quando há muitas solicitações simultâneas.":r?"A OpenAI não conseguiu calcular o ROI porque alguns dados importantes estão faltando.":n?"Ocorreu um problema na comunicação com a OpenAI. Este é um problema temporário.":"Ocorreu um erro inesperado durante a análise do seu investimento."}),o.jsx("p",{className:"text-gray-600 font-medium",children:s?"Tente novamente mais tarde quando o tráfego estiver menor.":r?"Verifique se preencheu todos os campos do formulário com valores realistas.":n?"Aguarde alguns minutos e tente novamente.":"Tente novamente ou contate o suporte se o problema persistir."})]}),o.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[o.jsxs(st,{onClick:a,variant:"outline",className:"flex items-center gap-2",children:[o.jsx($t,{size:16}),"Voltar ao formulário"]}),o.jsxs(st,{onClick:e,variant:"default",className:"flex items-center gap-2",children:[o.jsx(ss,{size:16}),"Tentar novamente"]})]})]})},no=({showBackButton:t=!1,backPath:e="/meus-rois",backText:a="Voltar para Meus ROIs"})=>{const s=as(),r=D.useRef(null),n=ts(),{user:i}=Ws(),{refetchUsage:l}=rs(),{isLoading:d,progress:m,analyzeROI:h}=Fn(),[x,g]=D.useState(!1),[I,S]=D.useState(null),[p,C]=D.useState(null),[Z,R]=D.useState(null),[M,L]=D.useState(null),[X,he]=D.useState(!1),[U,ye]=D.useState(!1),[le,_e]=D.useState(!1),[ne,F]=D.useState(null),[O,se]=D.useState(null),[de,te]=D.useState("offline"),[b,_]=D.useState(1),V=js({defaultValues:{condominio:"",localizacao:"",modelo:"",quartos:"",piscina:!1,valor_imovel:"",entrada_valor:"",entrada_percentual:"",logoUrl:null,incluir_decoracao:!1,decoracao_valor:"",decoracao_percentual:"",incluir_closing_costs:!1,closing_costs_percentual:""}}),{watch:Y,trigger:ue}=V;D.useCallback((z,B)=>{let Q=parseFloat(z.valor_imovel||"0"),re=parseFloat(z.entrada_percentual||"20"),ce=parseFloat(z.entrada_valor||"0");if(B){const f=B.match(/Valor da Propriedade:\s*\$?([\d,.]+)/i);f&&(Q=parseFloat(f[1].replace(/,/g,"")));const N=B.match(/Entrada\s*\(([^)]+)%\):\s*\$?([\d,.]+)/i);N&&(re=parseFloat(N[1]),ce=parseFloat(N[2].replace(/,/g,"")))}ce<=0&&Q>0&&re>0?ce=Q*(re/100):(ce>0&&Q>0&&re<=0||ce>0&&Q>0&&re>0&&Math.abs(Q*(re/100)-ce)>1)&&(re=ce/Q*100);const Oe=Q>ce?Q-ce:0;let Se=7,be=30;if(B){const f=B.match(/Taxa de Juros Anual:?\s*(\d+[.,]?\d*)%/i);f&&(Se=parseFloat(f[1].replace(",",".")));const N=B.match(/Prazo do Financiamento:?\s*(\d+)\s*anos/i);N&&(be=parseInt(N[1]))}const c=Se/100/12,u=be*12;return{valorImovel:Q,entradaValor:ce,entradaPercentual:re,valorFinanciado:Oe,taxaJuros:Se,prazoAnos:be,taxaMensal:c,numPagamentos:u}},[]);const K=async()=>{try{const{data:z,error:B}=await dt.storage.listBuckets();if(B)return console.error("Erro ao listar buckets:",B),!1;const Q=["logos","analises"];for(const re of Q)if(!(z!=null&&z.find(ce=>ce.name===re))){const{error:ce}=await dt.storage.createBucket(re,{public:!1,allowedMimeTypes:["image/*"],fileSizeLimit:2097152});if(ce)return console.error(`Erro ao criar bucket ${re}:`,ce),!1}return!0}catch(z){return console.error("Erro ao verificar/criar buckets:",z),!1}},G=async(z,B)=>{if(he(!0),C(z),R(B),!z){L(null),he(!1);return}if(de==="supabase")try{if(!await K()){Ie.error("Erro ao configurar armazenamento"),he(!1);return}const re=z.name.split(".").pop(),ce=`${Date.now()}_${Math.random().toString(36).substring(7)}.${re}`,{error:Oe,data:Se}=await dt.storage.from("logos").upload(ce,z);if(Oe){console.error("Erro ao fazer upload da logo:",Oe),Ie.error("Erro ao fazer upload da logo"),he(!1);return}const{data:{publicUrl:be}}=dt.storage.from("logos").getPublicUrl(ce);L(be)}catch(Q){console.error("Erro ao processar upload da logo:",Q),Ie.error("Erro ao processar upload da logo")}he(!1)},Le=()=>{S(null),F(null),g(!1),C(null),R(null),L(null),se(null),_e(!1),_(1),V.reset()},jt=()=>{_(z=>Math.min(z+1,es))},Dt=()=>{_(z=>Math.max(z-1,1))},lt=z=>({...z,incluir_decoracao:z.incluir_decoracao||!1,decoracao_valor:z.decoracao_valor||"",decoracao_percentual:z.decoracao_percentual||"",incluir_closing_costs:z.incluir_closing_costs||!1,closing_costs_percentual:z.closing_costs_percentual||""}),At=async z=>{try{g(!0),F(null);const B=Oe=>{console.log("[FORM_UPDATE] Atualizando campos com valores calculados:",Oe),Object.entries(Oe).forEach(([Se,be])=>{be!=null&&be!==""&&V.setValue(Se,be)})},Q=lt(z),re=await h(Q,M||Z,B);if(!(re!=null&&re.result))throw new Error("Não foi possível completar a análise ou a resposta está incompleta");const ce={...re.result,propertyData:re.propertyData};S(ce),r.current&&r.current.scrollIntoView({behavior:"smooth"})}catch(B){console.error("Erro na análise (handleSubmitForm):",B),F(B),Ie.error("Erro ao realizar análise",{description:B.message})}finally{g(!1)}},et=D.useCallback(async()=>{var z;if(I&&!d&&!U&&i&&!le){ye(!0),console.log("Tentando salvar análise no banco...");const B=V.getValues();try{const Q=parseInt(B.quartos||""),re=parseFloat(B.valor_imovel||""),ce=B.entrada_valor?parseFloat(B.entrada_valor):null,Oe=B.entrada_percentual?parseFloat(B.entrada_percentual):null,{data:Se,error:be}=await dt.from("roi_analises").insert([{condominio:B.condominio,usuario_id:i.id,tipo_investimento:B.localizacao?"Temporada":"Residencial",localizacao:B.localizacao||"",modelo:B.modelo||"",quartos:isNaN(Q)?null:Q,piscina:B.piscina||!1,valor_imovel:isNaN(re)?null:re,entrada_valor:ce,entrada_percentual:Oe,resultado_texto:JSON.stringify(I),logo_storage_url:M,user_id:i.id}]).select();be?console.log("Erro de RLS ou permissão detectado ao salvar, mas a análise foi completada com sucesso"):(console.log("Análise salva com sucesso:",Se),se(((z=Se==null?void 0:Se[0])==null?void 0:z.id)||null),Ie.success("Análise salva com sucesso!"),l()),_e(!0)}catch(Q){console.error("Erro ao salvar análise:",Q),_e(!0)}finally{ye(!1)}}},[I,d,U,i,le,V,M,l]);D.useEffect(()=>{if(I&&!d&&!U&&i&&!le){const z=setTimeout(()=>{et()},2e3);return()=>clearTimeout(z)}},[I,d,U,i,le,et]);const ct=z=>{const B=Y();switch(z){case 1:return["condominio","valor_imovel","entrada_valor","entrada_percentual"];case 2:const Q=[];return B.incluir_decoracao&&Q.push("decoracao_valor","decoracao_percentual"),B.incluir_closing_costs&&Q.push("closing_costs_percentual"),Q;case 3:return[];default:return[]}};let Ge;return d?Ge=o.jsx(gn,{stage:m==null?void 0:m.stage,percentage:m==null?void 0:m.percentage}):I?Ge=o.jsx(xa,{children:o.jsx(Is,{result:I,onBack:Le,logoUrl:M||Z||null,onNewAnalysis:Le,showBackButton:!0,backPath:e,backText:"Nova Análise"})}):ne?Ge=o.jsx($n,{error:ne,onRetry:()=>{F(null)},onBack:()=>Le()}):Ge=o.jsxs("div",{className:"flex flex-col items-center mb-8 text-center",children:[o.jsx("img",{src:"/img/tom-avatar.jpg",alt:"Tom, seu assistente IA",className:"w-24 h-24 md:w-32 md:h-32 rounded-full mb-4 object-cover shadow-md"}),o.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Análise de ROI"}),o.jsx("p",{className:"text-gray-600 md:text-lg",children:"Preencha os dados abaixo para que eu possa te ajudar!"}),o.jsx("div",{className:"mt-8 w-full",children:o.jsx(fr,{...V,children:o.jsx(xa,{children:o.jsx(pn,{onSubmit:At,isFormProcessing:x,isLogoUploading:X,onLogoChange:G,logoPreviewUrl:Z,currentStep:b,totalSteps:es,handleNextStep:jt,handlePrevStep:Dt,fieldsToValidatePerStep:ct,triggerValidation:ue})})})})]}),o.jsx(Pn,{children:o.jsxs("div",{ref:r,className:`container mx-auto px-4 py-8 ${s?"pb-24":""}`,children:[t&&!I&&!d&&!ne&&o.jsxs("button",{onClick:()=>n(e||""),className:"mb-6 flex items-center gap-2 shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear",children:[o.jsx($t,{size:16})," ",a]}),Ge]})})};export{no as T};
