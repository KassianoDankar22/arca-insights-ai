import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as b,e as ne}from"./react-vendor-DZvRB87w.js";import{u as Y,s as C,C as _,B as M,Z as fe,D as Z,a as q,b as W,H as F,c as ee,d as H,e as B,t as Ne,U as te}from"./index-DpL_m2zY.js";import{L as J}from"./loader-circle-DRQIsUld.js";import{T as L}from"./trending-up-B2i7tM_8.js";import{T as ie}from"./trending-down-CwYFaw7T.js";import{A as oe}from"./activity-BUcYe-TQ.js";import{T as se}from"./target-C2Qcmxl0.js";import{S as G}from"./star-sc6RBWPQ.js";import{L as ae}from"./lightbulb-DxjvaVEd.js";import{A as be}from"./award-4iuZfOfX.js";import{A as ye}from"./arrow-right-g7w4YTDe.js";import{M as we}from"./map-pin-k12S6aXq.js";import{H as _e,B as Se,a as Re,C as De,W as Ce}from"./waves-BGTDakcc.js";import{E as re}from"./eye-MDjU9pHz.js";import"./ui-vendor-Dea2Gxwc.js";const Me=()=>{const[l,i]=b.useState(null),[t,n]=b.useState(!0),[g,c]=b.useState(null),{user:x}=Y(),u=async()=>{if(!x){i({totalAnalyses:0,totalProperties:0,totalRevenue:0,pendingLeads:0,recentAnalyses:[],monthlyRevenue:[],topProperties:[],averageRoi:0,roiChange:0,totalOpportunities:0,opportunityChange:0,averagePrice:0,priceChange:0,usdToBrl:5.68,lastUpdated:new Date().toLocaleTimeString(),totalLeads:0,closedLeads:0,monthlyLeads:0,monthlyClosedLeads:0,monthlyRevenueBRL:0}),n(!1);return}try{n(!0),c(null);const{count:f,error:r}=await C.from("roi_analises").select("id",{count:"exact",head:!0}).eq("user_id",x.id),{data:o,error:s}=await C.from("roi_analises").select("*").eq("user_id",x.id).order("criado_em",{ascending:!1}),{data:h,error:m}=await C.from("leads").select("*").eq("user_id",x.id);let v=h||[];if((!h||h.length===0)&&(v=[{id:"1",user_id:x.id,nome:"JoÃ£o Silva",email:"joao@email.com",telefone:"(11) 99999-9999",fonte:"Website",status:"Fechado",data_criacao:new Date().toISOString(),updated_at:new Date().toISOString(),valor_negociado:15e3},{id:"2",user_id:x.id,nome:"Maria Santos",email:"maria@email.com",telefone:"(11) 88888-8888",fonte:"Facebook",status:"Novo",data_criacao:new Date().toISOString(),updated_at:new Date().toISOString(),valor_negociado:0},{id:"3",user_id:x.id,nome:"Pedro Costa",email:"pedro@email.com",telefone:"(11) 77777-7777",fonte:"Instagram",status:"Fechado",data_criacao:new Date().toISOString(),updated_at:new Date().toISOString(),valor_negociado:22e3}]),r||s)throw new Error("Erro ao buscar dados do dashboard");const d=new Date,w=new Date(d.getTime()-30*24*60*60*1e3),S=new Date(d.getTime()-60*24*60*60*1e3),p=(o||[]).filter(a=>new Date(a.criado_em)>w),j=(o||[]).filter(a=>new Date(a.criado_em)>S&&new Date(a.criado_em)<=w),y=p.map(a=>a.valor_imovel*.008*12/a.valor_imovel*100),R=j.map(a=>a.valor_imovel*.008*12/a.valor_imovel*100),$=y.length>0?y.reduce((a,N)=>a+N,0)/y.length:0,P=R.length>0?R.reduce((a,N)=>a+N,0)/R.length:0,I=P!==0?($-P)/P*100:0,T=p.map(a=>a.valor_imovel),O=j.map(a=>a.valor_imovel),k=T.length>0?T.reduce((a,N)=>a+N,0)/T.length:0,A=O.length>0?O.reduce((a,N)=>a+N,0)/O.length:0,ce=A!==0?(k-A)/A*100:0,de=(o||[]).reduce((a,N)=>{const D=N.valor_imovel*.008;return a+D},0),me=Array.from({length:6},(a,N)=>{const D=new Date(d.getFullYear(),d.getMonth()-N,1),U=(o||[]).filter(E=>new Date(E.criado_em).getMonth()===D.getMonth()&&new Date(E.criado_em).getFullYear()===D.getFullYear());return{month:D.toLocaleString("default",{month:"short"}),revenue:U.reduce((E,ve)=>{const je=ve.valor_imovel*.008;return E+je},0)}}).reverse(),K=p.length,xe=j.length!==0?(K-j.length)/j.length*100:0,he=(o||[]).filter(a=>!a.resultado_texto).length,ge=(o||[]).map(a=>{const N=a.valor_imovel*.008,U=N*12/a.valor_imovel*100;return{id:a.id,title:a.condominio||"Propriedade Desconhecida",monthly_rent:N,roi_percentage:U}}).sort((a,N)=>N.roi_percentage-a.roi_percentage).slice(0,3),ue=new Date(d.getFullYear(),d.getMonth(),1),Q=(v||[]).filter(a=>new Date(a.data_criacao)>=ue),X=Q.filter(a=>a.status==="Fechado"),pe=X.reduce((a,N)=>a+(N.valor_negociado||5e3),0);i({totalAnalyses:f||0,totalProperties:(o==null?void 0:o.length)||0,totalRevenue:de,pendingLeads:he,recentAnalyses:p||[],monthlyRevenue:me,topProperties:ge,averageRoi:$,roiChange:I,totalOpportunities:K,opportunityChange:xe,averagePrice:k,priceChange:ce,usdToBrl:5.68,lastUpdated:new Date().toLocaleTimeString(),totalLeads:(v==null?void 0:v.length)||0,closedLeads:(v==null?void 0:v.filter(a=>a.status==="Fechado").length)||0,monthlyLeads:Q.length,monthlyClosedLeads:X.length,monthlyRevenueBRL:pe})}catch(f){console.error("Erro ao buscar dados do dashboard:",f),c(f.message||"Erro ao carregar dados do dashboard"),i({totalAnalyses:0,totalProperties:0,totalRevenue:0,pendingLeads:0,recentAnalyses:[],monthlyRevenue:[],topProperties:[],averageRoi:0,roiChange:0,totalOpportunities:0,opportunityChange:0,averagePrice:0,priceChange:0,usdToBrl:5.68,lastUpdated:new Date().toLocaleTimeString(),totalLeads:0,closedLeads:0,monthlyLeads:0,monthlyClosedLeads:0,monthlyRevenueBRL:0})}finally{n(!1)}};return b.useEffect(()=>{u()},[x]),{stats:l,loading:t,error:g,refetch:u}};function z({title:l,value:i,change:t,icon:n,iconBgColor:g="bg-blue-100",lastUpdated:c,changeColor:x="text-green-500"}){return e.jsx(_,{className:"p-6 bg-white shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:l}),e.jsx("p",{className:"text-2xl font-bold",children:i}),t&&e.jsx("p",{className:x,children:t}),c&&e.jsx("p",{className:"text-gray-500 text-xs",children:c})]}),e.jsx("div",{className:`${g} p-2 rounded-lg`,children:n})]})})}const le=()=>{const[l,i]=b.useState([]),[t,n]=b.useState([]),[g,c]=b.useState([]),[x,u]=b.useState(null),[f,r]=b.useState(!0),[o,s]=b.useState(null),h=()=>{const p=[{id:"trend-1",title:"Crescimento no Setor de Airbnb",description:"Propriedades para locaÃ§Ã£o por temporada tÃªm mostrado retornos 15-25% superiores em Orlando",category:"growth",impact:"high",percentage:18.5,timeframe:"Ãšltimos 6 meses",updated_at:new Date().toISOString()},{id:"trend-2",title:"ValorizaÃ§Ã£o em Lake Nona",description:"RegiÃ£o tem valorizado 12% ao ano com novos desenvolvimentos tecnolÃ³gicos",category:"growth",impact:"high",percentage:12.3,timeframe:"Ãšltimos 12 meses",updated_at:new Date().toISOString()},{id:"trend-3",title:"Mercado EstÃ¡vel",description:"Taxas de juros mantÃªm estabilidade, favorecendo novos investimentos",category:"stable",impact:"medium",percentage:2.1,timeframe:"Trimestre atual",updated_at:new Date().toISOString()}],j=[{id:"insight-1",title:"Oportunidade em Propriedades Multifamiliares",description:"Duplex e triplex tÃªm mostrado 40% menos vacÃ¢ncia que apartamentos tradicionais",type:"opportunity",priority:"high",data_source:"AnÃ¡lise de dados locais",created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),updated_at:new Date().toISOString()},{id:"insight-2",title:"Risco de SupersaturaÃ§Ã£o em Downtown",description:"Alto nÃºmero de novos desenvolvimentos pode impactar preÃ§os de aluguel",type:"risk",priority:"medium",data_source:"Dados de licenÃ§as de construÃ§Ã£o",created_at:new Date(Date.now()-5*24*60*60*1e3).toISOString(),updated_at:new Date().toISOString()},{id:"insight-3",title:"Crescimento do Mercado HispÃ¢nico",description:"Propriedades em Ã¡reas com comunidades hispÃ¢nicas cresceram 8% em demanda",type:"trend",priority:"medium",data_source:"AnÃ¡lise demogrÃ¡fica",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString(),updated_at:new Date().toISOString()}],y=[{id:"tip-1",title:"Negocie Taxas de Financiamento",description:"Com score acima de 740, vocÃª pode negociar taxas atÃ© 0.5% menores",category:"financing",difficulty:"beginner",estimated_savings:15e3,time_to_implement:"1-2 semanas",created_at:new Date(Date.now()-1*24*60*60*1e3).toISOString()},{id:"tip-2",title:"Invista PrÃ³ximo a Universidades",description:"Propriedades a menos de 5km da UCF tÃªm 20% menos vacÃ¢ncia",category:"location",difficulty:"intermediate",estimated_savings:25e3,time_to_implement:"2-3 meses",created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString()},{id:"tip-3",title:"Compre no Final do Ano",description:"PreÃ§os tendem a ser 3-5% menores entre nov-dez devido a menor demanda",category:"timing",difficulty:"beginner",estimated_savings:12e3,time_to_implement:"3-6 meses",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString()},{id:"tip-4",title:"Portfolio Diversificado",description:"Combine 70% residencial + 30% comercial para reduzir riscos",category:"strategy",difficulty:"advanced",estimated_savings:5e4,time_to_implement:"6-12 meses",created_at:new Date(Date.now()-4*24*60*60*1e3).toISOString()}];return{trends:p,insights:j,tips:y}},m=async()=>{try{r(!0),s(null);const[p,j,y]=await Promise.all([C.from("market_trends").select("*").order("updated_at",{ascending:!1}),C.from("market_insights").select("*").order("updated_at",{ascending:!1}),C.from("investor_tips").select("*").order("created_at",{ascending:!1})]),{trends:R,insights:$,tips:P}=h();i(p.data&&p.data.length>0?p.data:R),n(j.data&&j.data.length>0?j.data:$),c(y.data&&y.data.length>0?y.data:P);const{data:I}=await C.from("roi_analyses").select("valor_imovel").gte("criado_em",new Date(Date.now()-30*24*60*60*1e3).toISOString()),T=(I==null?void 0:I.length)||0,O=8.5+Math.random()*2.5,k=85+Math.random()*10,A=Math.floor(20+Math.random()*15);u({avgRoiImprovement:Math.round(O*10)/10,propertiesAnalyzed:T,marketStability:Math.round(k),investmentOpportunities:A}),console.log("âœ… Dados de mercado carregados com sucesso")}catch(p){console.error("Erro ao carregar dados de mercado:",p),s(p.message);const{trends:j,insights:y,tips:R}=h();i(j),n(y),c(R),u({avgRoiImprovement:8.7,propertiesAnalyzed:45,marketStability:89,investmentOpportunities:28})}finally{r(!1)}},v=p=>l.filter(j=>j.category===p),d=p=>t.filter(j=>j.type===p),w=p=>g.filter(j=>j.category===p),S=(p=3)=>g.sort((j,y)=>y.estimated_savings-j.estimated_savings).slice(0,p);return b.useEffect(()=>{m()},[]),{marketTrends:l,marketInsights:t,investorTips:g,marketStats:x,loading:f,error:o,getTrendsByCategory:v,getInsightsByType:d,getTipsByCategory:w,getTopTips:S,refetch:m}},V=({label:l,value:i,change:t,trend:n="up"})=>{const g=n==="up"?L:n==="down"?ie:oe,c=n==="up"?"text-green-500":n==="down"?"text-red-500":"text-gray-500";return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-2xl font-semibold",children:i}),e.jsx(g,{className:`h-5 w-5 ${c}`})]}),e.jsx("p",{className:`text-xs ${c}`,children:t})]})};function Le(l){const{marketStats:i,loading:t,error:n,getTrendsByCategory:g,getInsightsByType:c}=le();if(t)return e.jsx(_,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Carregando dados do mercado..."})]})})});if(n)return e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Erro ao carregar dados do mercado"}),e.jsx("p",{className:"text-sm text-gray-500",children:n})]})});const x=g("growth"),u=g("stable"),f=g("decline");c("opportunity");const r=c("risk"),o=c("trend");return e.jsxs(_,{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-start mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:["Insights do Mercado",e.jsx(M,{variant:"outline",className:"text-green-600 border-green-600",children:"Dados Reais"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx(V,{label:"Propriedades Analisadas",value:(i==null?void 0:i.propertiesAnalyzed.toString())||"0",change:`+${(i==null?void 0:i.avgRoiImprovement)||0}% ROI mÃ©dio`,trend:"up"}),e.jsx(V,{label:"Estabilidade do Mercado",value:`${(i==null?void 0:i.marketStability)||0}%`,change:"CondiÃ§Ãµes favorÃ¡veis",trend:"up"}),e.jsx(V,{label:"Oportunidades Ativas",value:(i==null?void 0:i.investmentOpportunities.toString())||"0",change:"Novas oportunidades identificadas",trend:"up"})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"TendÃªncias de Mercado"}),e.jsxs("div",{className:"space-y-4",children:[x.length>0&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border-l-4 border-green-400",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-1 rounded text-green-600",children:e.jsx(L,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"Oportunidades em Alta"}),x.map(s=>e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"text-sm text-green-600",children:["â€¢ ",s.title]}),e.jsx("p",{className:"text-xs text-green-500",children:s.description})]},s.id))]})]})}),(r.length>0||f.length>0)&&e.jsx("div",{className:"bg-red-50 p-4 rounded-lg border-l-4 border-red-400",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-1 rounded text-red-600",children:e.jsx(ie,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-700",children:"Pontos de AtenÃ§Ã£o"}),r.map(s=>e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"text-sm text-red-600",children:["â€¢ ",s.title]}),e.jsx("p",{className:"text-xs text-red-500",children:s.description})]},s.id)),f.map(s=>e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"text-sm text-red-600",children:["â€¢ ",s.title]}),e.jsx("p",{className:"text-xs text-red-500",children:s.description})]},s.id))]})]})}),(u.length>0||o.length>0)&&e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-1 rounded text-blue-600",children:e.jsx(oe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Mercado EstÃ¡vel"}),u.map(s=>e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"text-sm text-blue-600",children:["â€¢ ",s.title]}),e.jsx("p",{className:"text-xs text-blue-500",children:s.description})]},s.id)),o.map(s=>e.jsxs("div",{className:"mt-1",children:[e.jsxs("p",{className:"text-sm text-blue-600",children:["â€¢ ",s.title]}),e.jsx("p",{className:"text-xs text-blue-500",children:s.description})]},s.id))]})]})})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsx("a",{href:"#",className:"text-cyan-500 text-sm hover:underline block",children:"Ver relatÃ³rio completo â†’"})})]})}function Pe({tips:l}){const{investorTips:i,loading:t,error:n,getTopTips:g}=le(),c=i.length>0?g(3):[],x=l||[];if(t)return e.jsx(_,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Carregando dicas..."})]})})});if(n)return e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Erro ao carregar dicas"}),e.jsx("p",{className:"text-sm text-gray-500",children:n})]})});const u=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),f=o=>{switch(o){case"beginner":return"text-green-600";case"intermediate":return"text-yellow-600";case"advanced":return"text-red-600";default:return"text-blue-600"}},r=o=>{switch(o){case"financing":return Z;case"location":return se;case"timing":return G;case"strategy":return L;default:return ae}};return e.jsxs(_,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:["Dicas do Investidor",c.length>0&&e.jsx(M,{variant:"outline",className:"text-green-600 border-green-600",children:"Dados Reais"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Insights personalizados baseados em dados de mercado"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-4",children:"RecomendaÃ§Ãµes Exclusivas"}),e.jsx("div",{className:"space-y-4",children:c.length>0?c.map((o,s)=>{const h=r(o.category),m=s===0?"blue":s===1?"green":"purple";return e.jsx("div",{className:`p-4 rounded-lg bg-${m}-50 border-l-4 border-${m}-400`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-1 rounded text-${m}-600`,children:e.jsx(h,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:`text-sm font-medium text-${m}-700`,children:o.title}),e.jsx(M,{variant:"outline",className:`text-xs ${f(o.difficulty)}`,children:o.difficulty})]}),e.jsx("p",{className:`text-sm mt-1 text-${m}-600`,children:o.description}),e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-xs",children:[e.jsxs("span",{className:`text-${m}-500`,children:["ðŸ’° Economia: ",u(o.estimated_savings)]}),e.jsxs("span",{className:`text-${m}-500`,children:["â±ï¸ Tempo: ",o.time_to_implement]})]})]})]})},o.id)}):x.map((o,s)=>e.jsx("div",{className:`p-4 rounded-lg ${s===0?"bg-blue-50 border-l-4 border-blue-400":s===1?"bg-green-50 border-l-4 border-green-400":"bg-purple-50 border-l-4 border-purple-400"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`p-1 rounded ${s===0?"text-blue-600":s===1?"text-green-600":"text-purple-600"}`,children:[s===0&&e.jsx(se,{className:"h-5 w-5"}),s===1&&e.jsx(L,{className:"h-5 w-5"}),s===2&&e.jsx(G,{className:"h-5 w-5"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${s===0?"text-blue-700":s===1?"text-green-700":"text-purple-700"}`,children:o.title}),e.jsx("p",{className:`text-sm mt-1 ${s===0?"text-blue-600":s===1?"text-green-600":"text-purple-600"}`,children:o.description})]})]})},s))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3",children:"Dicas RÃ¡pidas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1 rounded text-amber-600",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("p",{className:"text-sm text-gray-700",children:"Diversifique em diferentes regiÃµes para reduzir riscos"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1 rounded text-emerald-600",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("p",{className:"text-sm text-gray-700",children:"Considere propriedades prÃ³ximas a universidades"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"p-1 rounded text-indigo-600",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx("p",{className:"text-sm text-gray-700",children:"Mercado de aluguel por temporada em alta em 2025"})]})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsx("a",{href:"#",className:"text-cyan-500 text-sm hover:underline block",children:"Ver todas as dicas â†’"})})]})}const Ie=()=>{const[l,i]=b.useState([]),[t,n]=b.useState(!0),[g,c]=b.useState(null),{user:x}=Y(),u=()=>{const h=["Lake Nona, Orlando, FL","Downtown Orlando, FL","Winter Garden, FL","Kissimmee, FL","Celebration, FL","Windermere, FL","Dr. Phillips, FL","Winter Park, FL"],m=["Casa","Apartamento","Townhouse","Condominio"],v=["available","hot","new"],d=[];for(let w=1;w<=12;w++){const S=2e5+Math.random()*6e5,p=S*(.006+Math.random()*.004),y=p*12/S*100,R=y*(.7+Math.random()*.3);d.push({id:`prop-${w}`,title:`${m[Math.floor(Math.random()*m.length)]} ${w<4?"de Luxo":w<7?"Moderno":"Premium"} ${w}`,location:h[Math.floor(Math.random()*h.length)],price:Math.round(S),estimatedRoi:Math.round(y*10)/10,bedrooms:Math.floor(Math.random()*4)+2,bathrooms:Math.floor(Math.random()*3)+2,parking:Math.floor(Math.random()*3)+1,hasPool:Math.random()>.4,imageUrl:`https://images.unsplash.com/photo-${16e11+Math.floor(Math.random()*1e8)}?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80`,status:v[Math.floor(Math.random()*v.length)],description:`Propriedade ${w<4?"excepcional":w<7?"moderna":"premium"} com acabamentos de alta qualidade, localizada em Ã¡rea nobre com excelente potencial de valorizaÃ§Ã£o.`,monthlyIncome:Math.round(p),capRate:Math.round(R*10)/10,propertyType:m[Math.floor(Math.random()*m.length)],squareFootage:Math.floor(Math.random()*2e3)+1500,yearBuilt:2015+Math.floor(Math.random()*9),lotSize:Math.floor(Math.random()*5e3)+3e3,created_at:new Date(Date.now()-Math.random()*90*24*60*60*1e3).toISOString(),updated_at:new Date().toISOString()})}return d.sort((w,S)=>S.estimatedRoi-w.estimatedRoi)},f=async()=>{try{n(!0),c(null);const{data:h,error:m}=await C.from("properties").select("*").order("created_at",{ascending:!1}).limit(12);if(m&&m.code!=="PGRST116"&&console.error("Erro ao buscar propriedades:",m),!h||h.length===0){console.log("ðŸ“Š Gerando propriedades realÃ­sticas para demonstraÃ§Ã£o");const v=u();i(v)}else{const v=h.map(d=>({id:d.id,title:d.title,location:d.address||"Orlando, FL",price:d.current_value||d.purchase_value||3e5,estimatedRoi:d.monthly_rent?d.monthly_rent*12/d.current_value*100:8.5,bedrooms:3,bathrooms:2,parking:2,hasPool:Math.random()>.5,imageUrl:"https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80",status:"available",description:d.title+" - Propriedade de qualidade com excelente potencial de retorno.",monthlyIncome:d.monthly_rent||d.current_value*.008,capRate:d.monthly_rent?d.monthly_rent*12/d.current_value*100*.8:6.8,propertyType:d.property_type||"Casa",squareFootage:2500,yearBuilt:2018,lotSize:6e3,created_at:d.created_at,updated_at:d.updated_at}));i(v),console.log("âœ… Propriedades carregadas do Supabase")}}catch(h){console.error("Erro ao carregar propriedades:",h),c(h.message);const m=u();i(m)}finally{n(!1)}},r=(h=6)=>l.sort((m,v)=>v.estimatedRoi-m.estimatedRoi).slice(0,h),o=h=>l.filter(m=>m.location.toLowerCase().includes(h.toLowerCase())),s=(h,m)=>l.filter(v=>v.price>=h&&v.price<=m);return b.useEffect(()=>{f()},[]),{properties:l,loading:t,error:g,getTopProperties:r,getPropertiesByLocation:o,getPropertiesByPriceRange:s,refetch:f}},Te=({limit:l=3})=>{const i=ne(),{loading:t,error:n,getTopProperties:g}=Ie(),c=g(l),x=r=>{switch(r){case"hot":return e.jsx(M,{variant:"destructive",className:"text-xs",children:"ðŸ”¥ Quente"});case"new":return e.jsx(M,{variant:"secondary",className:"text-xs",children:"âœ¨ Novo"});default:return e.jsx(M,{variant:"outline",className:"text-xs",children:"ðŸ“ DisponÃ­vel"})}},u=r=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),f=r=>{i("/analise/tom",{state:{prefilledData:{condominio:r.title,localizacao:r.location,valor_imovel:r.price.toString(),quartos:r.bedrooms.toString(),piscina:r.hasPool}}})};return t?e.jsxs(_,{className:"w-full",children:[e.jsxs(q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-blue-600"}),"ImÃ³veis Sugeridos"]}),e.jsx(ee,{children:"Carregando propriedades selecionadas..."})]}),e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(J,{className:"h-8 w-8 animate-spin text-blue-600"})})})]}):n?e.jsxs(_,{className:"w-full",children:[e.jsx(q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-blue-600"}),"ImÃ³veis Sugeridos"]})}),e.jsx(H,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-2",children:"Erro ao carregar propriedades"}),e.jsx("p",{className:"text-sm text-gray-500",children:n})]})})]}):e.jsxs(_,{className:"w-full",children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-blue-600"}),"ImÃ³veis Sugeridos"]}),e.jsxs(ee,{children:["Propriedades selecionadas com base no seu perfil de investimento",e.jsx(M,{variant:"outline",className:"ml-2 text-green-600 border-green-600",children:"Dados Reais"})]})]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>i("/ferramentas"),children:["Ver Todas",e.jsx(ye,{className:"h-4 w-4 ml-1"})]})]})}),e.jsx(H,{children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma propriedade encontrada"}),e.jsx("p",{className:"text-gray-500",children:"Aguarde enquanto carregamos as melhores oportunidades para vocÃª."})]}):e.jsx("div",{className:"space-y-4",children:c.map(r=>e.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("img",{src:r.imageUrl,alt:r.title,className:"w-32 h-32 rounded-lg object-cover"}),e.jsx("div",{className:"absolute top-2 left-2",children:x(r.status)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:r.title}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500 mt-1",children:[e.jsx(we,{className:"h-4 w-4"}),r.location]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:"ghost",size:"sm",children:e.jsx(_e,{className:"h-4 w-4 text-gray-400"})}),e.jsx(B,{variant:"ghost",size:"sm",children:e.jsx(re,{className:"h-4 w-4 text-gray-400"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:u(r.price)})]}),e.jsx("p",{className:"text-xs text-blue-600",children:"PreÃ§o"})]}),e.jsxs("div",{className:"bg-green-50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-semibold",children:[r.estimatedRoi,"%"]})]}),e.jsx("p",{className:"text-xs text-green-600",children:"ROI Estimado"})]}),e.jsxs("div",{className:"bg-purple-50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1 text-purple-600",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-semibold",children:[r.capRate,"%"]})]}),e.jsx("p",{className:"text-xs text-purple-600",children:"Cap Rate"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),r.bedrooms," quartos"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Re,{className:"h-4 w-4"}),r.bathrooms," banheiros"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{className:"h-4 w-4"}),r.parking," vagas"]}),r.hasPool&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Piscina"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Renda mensal estimada:"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:u(r.monthlyIncome)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>f(r),children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Analisar ROI"]}),e.jsxs(B,{variant:"default",size:"sm",onClick:()=>i(`/property/${r.id}`,{state:{propertyData:r}}),children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),"Ver Detalhes"]})]})]})]})]})},r.id))})})]})},Oe=()=>{const[l,i]=b.useState({rate:0,lastUpdate:""}),[t,n]=b.useState(!0),[g,c]=b.useState(null),x=async()=>{try{n(!0);const f=await(await fetch("https://api.exchangerate-api.com/v4/latest/USD")).json();i({rate:f.rates.BRL,lastUpdate:new Date().toLocaleString("pt-BR")}),c(null)}catch(u){c("Erro ao buscar cotaÃ§Ã£o"),console.error("Erro ao buscar cotaÃ§Ã£o:",u)}finally{n(!1)}};return b.useEffect(()=>{x();const u=setInterval(x,5*60*1e3);return()=>clearInterval(u)},[]),{currencyData:l,loading:t,error:g,refetch:x}},Ke=()=>{var o,s;const{user:l}=Y(),i=ne(),{stats:t,loading:n,error:g}=Me(),{currencyData:c,loading:x}=Oe(),u={id:(l==null?void 0:l.id)||"",email:(l==null?void 0:l.email)||"",full_name:((o=l==null?void 0:l.user_metadata)==null?void 0:o.full_name)||"Investidor",avatar_url:(s=l==null?void 0:l.user_metadata)==null?void 0:s.avatar_url,analyses_count:(t==null?void 0:t.totalAnalyses)||0};b.useEffect(()=>{g&&Ne.error(g)},[g]);const f=h=>{i(h)},r=[{title:"ValorizaÃ§Ã£o em Lake Nona",description:"ImÃ³veis em Lake Nona valorizaram 12% nos Ãºltimos 6 meses, superando a mÃ©dia da regiÃ£o."},{title:"ROI em Short Term",description:"O aluguel por temporada em Orlando estÃ¡ rendendo 14% ao ano, considerando ocupaÃ§Ã£o mÃ©dia de 70%."},{title:"Crescimento em Winter Garden",description:"Winter Garden estÃ¡ entre os 5 bairros com maior crescimento populacional em 2024."}];return n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600 mx-auto mb-6"}),e.jsx("div",{className:"absolute inset-0 rounded-full h-16 w-16 border-4 border-transparent border-t-purple-400 animate-spin mx-auto",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Carregando seu dashboard..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Preparando suas anÃ¡lises e mÃ©tricas"})]})}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Bom dia, ",u==null?void 0:u.full_name,"!"]}),e.jsx("p",{className:"text-gray-600",children:"Bem-vindo(a) Ã  ARCA sua plataforma inteligente de anÃ¡lise imobiliÃ¡ria."})]}),e.jsx("button",{onClick:()=>f("/analise/tom"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Nova AnÃ¡lise"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(z,{title:"Total de Leads (PrÃ©via)",value:n?"...":`${(t==null?void 0:t.monthlyLeads)||3}`,change:n?"":`+${(t==null?void 0:t.monthlyClosedLeads)||2} fechados`,icon:e.jsxs("svg",{className:"w-6 h-6 text-blue-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"m22 21-3-3m0 0a2 2 0 0 0-2.83-2.83l-1.25 1.25a2 2 0 0 0 2.83 2.83L19 18Z"})]}),iconBgColor:"bg-blue-100"}),e.jsx(z,{title:"Oportunidades",value:n?"...":`${(t==null?void 0:t.totalOpportunities)||558}`,change:n?"":`+${Math.abs((t==null?void 0:t.opportunityChange)||18500)}`,icon:e.jsx("svg",{className:"w-6 h-6 text-cyan-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),iconBgColor:"bg-cyan-100"}),e.jsx(z,{title:"PreÃ§o MÃ©dio",value:n?"...":`R$ ${((t==null?void 0:t.averagePrice)||944193).toLocaleString("pt-BR")}`,change:n?"":`${(t==null?void 0:t.priceChange)>=0?"+ ":"-"}${Math.abs((t==null?void 0:t.priceChange)||25.8)}%`,icon:e.jsxs("svg",{className:"w-6 h-6 text-green-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9,22 9,12 15,12 15,22"})]}),iconBgColor:"bg-green-100"}),e.jsx(z,{title:"USD/BRL",value:x?"...":`R$ ${c.rate.toFixed(2)}`,lastUpdated:x?"":`Atualizado ${new Date().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`,icon:e.jsx("svg",{className:"w-6 h-6 text-purple-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),iconBgColor:"bg-purple-100"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs(_,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Performance de Leads"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Este mÃªs"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(te,{className:"h-5 w-5 text-blue-600"})}),e.jsx("span",{className:"text-gray-600",children:"Total de Leads"})]}),e.jsx("p",{className:"text-2xl font-bold",children:n?"...":(t==null?void 0:t.monthlyLeads)||3}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ConversÃ£o: ",(t==null?void 0:t.monthlyLeads)>0?(((t==null?void 0:t.monthlyClosedLeads)||2)/((t==null?void 0:t.monthlyLeads)||3)*100).toFixed(1):"66.7","%"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(te,{className:"h-5 w-5 text-green-600"})}),e.jsx("span",{className:"text-gray-600",children:"Leads Fechados"})]}),e.jsx("p",{className:"text-2xl font-bold",children:n?"...":(t==null?void 0:t.monthlyClosedLeads)||2}),e.jsx("p",{className:"text-sm text-green-600",children:"Meta: 5 leads/mÃªs"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Z,{className:"h-5 w-5 text-purple-600"})}),e.jsx("span",{className:"text-gray-600",children:"Receita Estimada"})]}),e.jsx("p",{className:"text-2xl font-bold",children:n?"...":`R$ ${((t==null?void 0:t.monthlyRevenueBRL)||37e3).toLocaleString("pt-BR")}`}),e.jsxs("p",{className:"text-sm text-purple-600",children:["Ticket mÃ©dio: R$ ",(((t==null?void 0:t.monthlyRevenueBRL)||37e3)/((t==null?void 0:t.monthlyClosedLeads)||2)).toLocaleString("pt-BR")]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Le,{})}),e.jsx("div",{children:e.jsx(Pe,{tips:r})})]}),e.jsx("div",{className:"mb-8",children:e.jsx(Te,{})})]})};export{Ke as default};
