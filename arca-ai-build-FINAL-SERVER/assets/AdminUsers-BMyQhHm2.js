import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as h}from"./react-vendor-DZvRB87w.js";import{U as P,x as B,g as u,D,e as p,C as F,a as te,b as re,d as A,y as le,K as ne,z as ie,B as L}from"./index-Bcg3-yyF.js";import{I as oe}from"./input-DeGpYGBS.js";import{T as ce,a as de,b as y,c as b}from"./tabs-DNLOrG2j.js";import{T as me,a as xe,b as E,c as l,d as he,e as n}from"./table-Nb046eMn.js";import{S as _,a as M,b as I,c as k,d as i}from"./select-4SbkaADg.js";import{D as ue,a as pe,b as ge,c as m,d as je}from"./dropdown-menu-Bwx_JN1Y.js";import{u as ve}from"./useRealData-D23IYPRu.js";import{T as S}from"./trending-up-DmkegI-s.js";import{C as fe}from"./credit-card-Po7wmCwq.js";import{L as Ne}from"./loader-circle-Czu_fY0g.js";import{D as we}from"./download-f6EqBvdC.js";import{P as ye}from"./plus-D1K4CKnh.js";import{S as be}from"./search-DRTCN9dC.js";import{E as Se}from"./ellipsis-DEtzPhET.js";import{S as Ce,B as Te}from"./square-pen-gPewtHGu.js";import{M as Ue}from"./mail-B4FXqTwl.js";import{C as $e}from"./circle-check-big-CWSVzH0R.js";import{m as Re}from"./proxy-CqlErGxY.js";import"./ui-vendor-Dea2Gxwc.js";import"./index-v7iOeiPF.js";import"./chevron-down-C_P1G3tD.js";import"./check-DqYQ0lV2.js";import"./chevron-up-BMvOzWH0.js";import"./chevron-right-2u11bsEk.js";import"./circle-YrizIO9s.js";const rs=()=>{const[g,G]=h.useState(""),[j,q]=h.useState("all"),[v,V]=h.useState("all"),[o,z]=h.useState("all"),{users:c,stats:d,loading:C,error:T}=ve(),f=(()=>{let s=c;return o==="free"?s=s.filter(a=>a.plan==="free"):o==="paid"&&(s=s.filter(a=>a.plan==="pro"||a.plan==="enterprise")),s.filter(a=>{var R;const w=((R=a.name)==null?void 0:R.toLowerCase().includes(g.toLowerCase()))||a.email.toLowerCase().includes(g.toLowerCase()),se=j==="all"||a.status===j,ae=v==="all"||a.plan===v;return w&&se&&ae})})(),t=c.filter(s=>s.plan==="free"),r=c.filter(s=>s.plan==="pro"||s.plan==="enterprise"),H=c.filter(s=>s.plan==="pro"),K=c.filter(s=>s.plan==="enterprise"),x=c.reduce((s,a)=>s+a.revenue,0),U=r.length>0?x/r.length:0,J=[{title:"Total de Usuários",value:d.total.toString(),change:`+${d.newThisMonth} este mês`,trend:"up",icon:P,color:"blue"},{title:"Usuários Gratuitos",value:t.length.toString(),change:`${(t.length/d.total*100).toFixed(1)}% do total`,trend:"neutral",icon:B,color:"gray"},{title:"Usuários Pagos",value:r.length.toString(),change:`${(r.length/d.total*100).toFixed(1)}% do total`,trend:"up",icon:u,color:"yellow"},{title:"Receita Total",value:`R$ ${x.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,change:`R$ ${U.toFixed(2)} por usuário pago`,trend:"up",icon:D,color:"green"}],O=[{title:"Usuários Gratuitos",value:t.length.toString(),change:`${(t.length/d.total*100).toFixed(1)}% do total`,trend:"neutral",icon:B,color:"gray"},{title:"Usuários Ativos",value:t.filter(s=>s.status==="active").length.toString(),change:`${(t.filter(s=>s.status==="active").length/t.length*100).toFixed(1)}% ativo`,trend:"up",icon:S,color:"green"},{title:"Total de Análises",value:t.reduce((s,a)=>s+a.total_analyses,0).toString(),change:`${(t.reduce((s,a)=>s+a.total_analyses,0)/t.length).toFixed(1)} por usuário`,trend:"neutral",icon:P,color:"blue"},{title:"Potencial de Conversão",value:t.filter(s=>s.total_analyses>=5).length.toString(),change:"usuários com 5+ análises",trend:"up",icon:u,color:"yellow"}],Q=[{title:"Usuários Pagos",value:r.length.toString(),change:`${H.length} Pro + ${K.length} Enterprise`,trend:"up",icon:u,color:"yellow"},{title:"Receita Total",value:`R$ ${x.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,change:`R$ ${U.toFixed(2)} por usuário`,trend:"up",icon:D,color:"green"},{title:"Receita Mensal Recorrente",value:`R$ ${(x*.1).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,change:"+12.5% vs mês anterior",trend:"up",icon:fe,color:"green"},{title:"Análises Realizadas",value:r.reduce((s,a)=>s+a.total_analyses,0).toString(),change:`${(r.reduce((s,a)=>s+a.total_analyses,0)/r.length).toFixed(1)} por usuário`,trend:"up",icon:S,color:"blue"}],W=s=>{const a={free:"bg-gray-100 text-gray-800",pro:"bg-blue-100 text-blue-800",enterprise:"bg-purple-100 text-purple-800"};return a[s]||a.free},X=s=>{const a={active:"bg-green-100 text-green-800",inactive:"bg-yellow-100 text-yellow-800",blocked:"bg-red-100 text-red-800"};return a[s]||a.active},$=s=>new Date(s).toLocaleDateString("pt-BR"),Y=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),Z=s=>({active:"Ativo",inactive:"Inativo",blocked:"Bloqueado"})[s]||s,ee=s=>({free:"Gratuito",pro:"Pro",enterprise:"Enterprise"})[s]||s,N=s=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((a,w)=>e.jsx(Re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:w*.1},children:e.jsx(F,{children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.value}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(S,{className:"w-4 h-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:a.change})]})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${a.color}-100`,children:e.jsx(a.icon,{className:`w-6 h-6 text-${a.color}-600`})})]})})})},a.title))});return C?e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(Ne,{className:"w-8 h-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Carregando usuários..."})]})}):T?e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx("p",{children:T}),e.jsx(p,{onClick:()=>window.location.reload(),className:"mt-4",children:"Tentar Novamente"})]})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciar Usuários"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie contas de usuários, planos e atividades"})]}),e.jsxs("div",{className:"mt-4 lg:mt-0 flex items-center gap-3",children:[e.jsxs(p,{variant:"outline",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(p,{variant:"arca",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Novo Usuário"]})]})]}),e.jsxs(ce,{value:o,onValueChange:z,className:"w-full",children:[e.jsxs(de,{className:"grid w-full grid-cols-3",children:[e.jsx(y,{value:"all",children:"Todos os Usuários"}),e.jsx(y,{value:"free",children:"Usuários Gratuitos"}),e.jsx(y,{value:"paid",children:"Usuários Pagos"})]}),e.jsx(b,{value:"all",className:"space-y-6",children:N(J)}),e.jsx(b,{value:"free",className:"space-y-6",children:N(O)}),e.jsx(b,{value:"paid",className:"space-y-6",children:N(Q)})]}),e.jsxs(F,{children:[e.jsx(te,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs(re,{children:["Lista de Usuários (",f.length,o==="free"&&" gratuitos",o==="paid"&&" pagos",o==="all"&&" total",")"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(oe,{placeholder:"Buscar usuários...",value:g,onChange:s=>G(s.target.value),className:"pl-10 w-64"})]}),e.jsxs(_,{value:j,onValueChange:q,children:[e.jsx(M,{className:"w-32",children:e.jsx(I,{placeholder:"Status"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"Todos"}),e.jsx(i,{value:"active",children:"Ativo"}),e.jsx(i,{value:"inactive",children:"Inativo"}),e.jsx(i,{value:"blocked",children:"Bloqueado"})]})]}),o==="all"&&e.jsxs(_,{value:v,onValueChange:V,children:[e.jsx(M,{className:"w-32",children:e.jsx(I,{placeholder:"Plano"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"Todos"}),e.jsx(i,{value:"free",children:"Gratuito"}),e.jsx(i,{value:"pro",children:"Pro"}),e.jsx(i,{value:"enterprise",children:"Enterprise"})]})]})]})]})}),e.jsxs(A,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(me,{children:[e.jsx(xe,{children:e.jsxs(E,{children:[e.jsx(l,{children:"Usuário"}),e.jsx(l,{children:"Plano"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Cadastro"}),e.jsx(l,{children:"Último Acesso"}),e.jsx(l,{children:"Análises"}),e.jsx(l,{children:"Receita"}),e.jsx(l,{className:"w-[70px]",children:"Ações"})]})}),e.jsx(he,{children:f.map(s=>e.jsxs(E,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(le,{className:"h-8 w-8",children:[e.jsx(ne,{src:s.avatar_url}),e.jsx(ie,{children:s.name?s.name.split(" ").map(a=>a[0]).join(""):s.email.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name||"Nome não informado"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx(n,{children:e.jsx(L,{className:`${W(s.plan)} border-0`,children:ee(s.plan)})}),e.jsx(n,{children:e.jsx(L,{className:`${X(s.status)} border-0`,children:Z(s.status)})}),e.jsx(n,{children:$(s.created_at)}),e.jsx(n,{children:$(s.last_access)}),e.jsxs(n,{children:[e.jsx("span",{className:"font-medium",children:s.total_analyses}),s.plan==="free"&&s.total_analyses>=5&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 text-xs bg-yellow-100 text-yellow-800 rounded",children:"Potencial"})]}),e.jsx(n,{children:e.jsx("span",{className:s.revenue>0?"font-medium text-green-600":"text-gray-500",children:Y(s.revenue)})}),e.jsx(n,{children:e.jsxs(ue,{children:[e.jsx(pe,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",children:e.jsx(Se,{className:"w-4 h-4"})})}),e.jsxs(ge,{align:"end",children:[e.jsxs(m,{children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(m,{children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Enviar Email"]}),s.plan==="free"&&e.jsxs(m,{className:"text-blue-600",children:[e.jsx(u,{className:"mr-2 h-4 w-4"}),"Promover para Pro"]}),e.jsx(je,{}),s.status==="active"?e.jsxs(m,{className:"text-red-600",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Bloquear"]}):e.jsxs(m,{className:"text-green-600",children:[e.jsx($e,{className:"mr-2 h-4 w-4"}),"Ativar"]})]})]})})]},s.id))})]})}),f.length===0&&!C&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:c.length===0?"Nenhum usuário cadastrado":"Nenhum usuário encontrado com os filtros aplicados"})})]})]})]})};export{rs as default};
