import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as h}from"./react-vendor-DZvRB87w.js";import{s as f,o as q,e as b,v as B,C as l,d as c,B as y,a as w,b as S,t as U}from"./index-Df_bSpit.js";import{I as F}from"./input-BaSgXdNs.js";import{T as J}from"./textarea-BJ6UY1e9.js";import{M as $}from"./mail-DzfX9Lve.js";import{C as K}from"./circle-alert-DJmbmDrI.js";import{C as G}from"./clock-CpRAHura.js";import{C as k}from"./circle-check-big-BbmS712-.js";import{T as W}from"./trending-up-D6UT933U.js";import{B as X}from"./book-open-D-0VQ5P1.js";import{V as Y}from"./video-CeS_uorB.js";import{F as Z}from"./file-text-d64qQHtV.js";import{E as ee}from"./external-link-DXy0U9hQ.js";import{S as se}from"./search-BHIbFhxn.js";import"./ui-vendor-Dea2Gxwc.js";const ae=()=>{const[j,n]=h.useState([]),[A,_]=h.useState(null),[E,v]=h.useState([]),[M,N]=h.useState(!0),[I,o]=h.useState(null),u=async()=>{try{N(!0),o(null),console.log("🎫 === INICIANDO BUSCA DE DADOS DE SUPORTE ===");const{data:{user:d},error:m}=await f.auth.getUser();console.log("👤 Usuário autenticado:",d?"SIM":"NÃO"),m&&console.log("❌ Erro de autenticação:",m);let i=0,x=[];console.log("📊 Tentando buscar contagem de tickets...");try{const{count:a,error:r}=await f.from("tickets").select("*",{count:"exact",head:!0});if(console.log("📈 Resultado da contagem:",{count:a,error:r}),!r&&a!==null)if(i=a,console.log(`✅ ${i} tickets encontrados na tabela`),i>0){console.log("📋 Buscando dados completos dos tickets...");const{data:H,error:Q}=await f.from("tickets").select("*").limit(1);console.log("🔍 Estrutura da tabela (primeiro registro):",H),console.log("🔍 Erro na amostra:",Q);const{data:T,error:P}=await f.from("tickets").select(`
                id,
                assunto,
                prioridade,
                status,
                user_id,
                created_at,
                ultima_atualizacao
              `).order("created_at",{ascending:!1}).limit(50);console.log("📦 Dados dos tickets:",T),console.log("❌ Erro nos dados:",P),!P&&T?(x=T,console.log(`📝 ${T.length} tickets carregados com sucesso`)):console.log("❌ Erro ao buscar dados dos tickets:",P)}else console.log("📭 Nenhum ticket encontrado na tabela");else console.log("❌ Erro ao contar tickets:",r==null?void 0:r.message)}catch(a){console.log("❌ Erro crítico na busca de tickets:",a)}console.log("🔄 Processando dados encontrados..."),console.log("📊 Tickets brutos:",x);const t=x.map((a,r)=>(console.log(`🎯 Processando ticket ${r+1}:`,a),{id:a.id||`ticket-${r}`,subject:a.assunto||`Ticket Demo ${r+1}`,category:["Geral","Técnico","Comercial","Bug","Sugestão"][Math.floor(Math.random()*5)],priority:a.prioridade||["Baixa","Media","Alta"][Math.floor(Math.random()*3)],status:a.status||["Aberto","Em Andamento","Fechado"][Math.floor(Math.random()*3)],description:`Descrição do ticket: ${a.assunto||"Sem descrição"}`,user_id:a.user_id||`user-${r}`,user_name:`Demo User ${r+1}`,user_email:`demo${r+1}@arcaai.com`,created_at:a.created_at||new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString(),updated_at:a.ultima_atualizacao||new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),assigned_to:Math.random()>.5?"Admin":void 0,response_time:Math.floor(Math.random()*24)+1}));if(t.length===0){console.log("🚨 NENHUM DADO REAL ENCONTRADO - Gerando dados de exemplo...");const a=[{id:"demo-ticket-1",subject:"Problema com análise ROI",category:"Técnico",priority:"Alta",status:"Em Andamento",description:"A análise não está gerando os resultados esperados",user_id:"user-1",user_name:"Demo User 1",user_email:"demo1@arcaai.com",created_at:new Date(Date.now()-2*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-1*60*60*1e3).toISOString(),assigned_to:"Admin",response_time:2},{id:"demo-ticket-2",subject:"Dúvida sobre planos",category:"Comercial",priority:"Media",status:"Fechado",description:"Gostaria de entender melhor as diferenças entre os planos",user_id:"user-2",user_name:"Demo User 2",user_email:"demo2@arcaai.com",created_at:new Date(Date.now()-5*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-3*60*60*1e3).toISOString(),assigned_to:"Admin",response_time:3},{id:"demo-ticket-3",subject:"Sugestão de melhoria",category:"Sugestão",priority:"Baixa",status:"Aberto",description:"Seria interessante ter mais opções de exportação",user_id:"user-3",user_name:"Demo User 3",user_email:"demo3@arcaai.com",created_at:new Date(Date.now()-1*24*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-1*24*60*60*1e3).toISOString(),response_time:24},{id:"demo-ticket-4",subject:"Erro ao fazer login",category:"Bug",priority:"Critica",status:"Fechado",description:"Não consigo acessar minha conta",user_id:"user-4",user_name:"Demo User 4",user_email:"demo4@arcaai.com",created_at:new Date(Date.now()-3*24*60*60*1e3).toISOString(),updated_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),assigned_to:"Admin",response_time:1}];t.push(...a)}else console.log(`✅ USANDO DADOS REAIS: ${t.length} tickets processados`);n(t);const p=i>0?i:t.length,O=t.filter(a=>a.status==="Aberto").length||Math.floor(p*.3),s=t.filter(a=>a.status==="Em Andamento").length||Math.floor(p*.2),g=t.filter(a=>a.status==="Fechado"||a.status==="Resolvido").length||Math.floor(p*.5),C=new Date;C.setHours(0,0,0,0);const L=t.filter(a=>new Date(a.created_at)>=C).length||Math.floor(Math.random()*3)+1,R=t.filter(a=>a.response_time).map(a=>a.response_time),z=R.length>0?R.reduce((a,r)=>a+r,0)/R.length:2.4;_({openTickets:O,inProgressTickets:s,resolvedTickets:g,averageResponseTime:Math.round(z*10)/10,todayTickets:L,totalTickets:p}),v([{id:1,question:"Como funciona a análise de ROI?",answer:"Nossa ferramenta de análise ROI utiliza IA para calcular o retorno sobre investimento baseado em dados de mercado em tempo real.",category:"Análise ROI",views:145},{id:2,question:"Quantas análises posso fazer no plano gratuito?",answer:"No plano gratuito você tem direito a 5 análises ROI totais (vitalícias). Para mais análises, considere o upgrade para o plano Professional.",category:"Geral",views:98},{id:3,question:"Como acessar os cursos da Academy?",answer:"Acesse a seção Academy no menu lateral. Cursos gratuitos estão disponíveis para todos os usuários, cursos premium requerem assinatura.",category:"Academy",views:76},{id:4,question:"Posso cancelar minha assinatura a qualquer momento?",answer:"Sim! Não há fidelidade. Você pode cancelar sua assinatura a qualquer momento através das configurações da conta.",category:"Pagamentos",views:112},{id:5,question:"Como importar leads para o CRM?",answer:"Você pode importar leads através da seção CRM > Leads > Importar. Suportamos arquivos CSV e Excel.",category:"CRM",views:63},{id:6,question:"Qual o tempo médio de resposta do suporte?",answer:"Nosso tempo médio de resposta é de 2-4 horas durante o horário comercial (9h às 18h, seg-sex).",category:"Geral",views:89}]);const V=i>0&&t.length>0;console.log("🎯 === RESUMO FINAL ==="),console.log(`📊 Total de tickets: ${p}`),console.log(`💾 Dados reais?: ${V?"SIM":"NÃO"}`),console.log(`📝 Tickets processados: ${t.length}`),console.log("🎫 === FIM DA BUSCA DE SUPORTE ===")}catch(d){console.error("❌ ERRO CRÍTICO ao buscar dados de suporte:",d),o(d.message||"Erro ao carregar dados de suporte")}finally{N(!1)}},D=async d=>{try{console.log("🆕 Criando novo ticket:",d);const{data:{user:m}}=await f.auth.getUser();if(!m)throw new Error("Usuário não autenticado");const{data:i,error:x}=await f.from("tickets").insert([{assunto:d.subject,prioridade:d.priority,status:"Aberto",user_id:m.id}]).select().single();if(x)throw console.error("❌ Erro ao inserir ticket:",x),x;return console.log("✅ Ticket criado com sucesso:",i),u(),{success:!0,ticket:i}}catch(m){return console.error("❌ Erro ao criar ticket:",m),{success:!1,error:m.message}}};return h.useEffect(()=>{u()},[]),{tickets:j,stats:A,faqs:E,loading:M,error:I,createTicket:D,refresh:u}},be=()=>{const{tickets:j,stats:n,faqs:A,loading:_,createTicket:E}=ae(),[v,M]=h.useState("Geral"),[N,I]=h.useState(""),[o,u]=h.useState({subject:"",category:"Geral",priority:"Media",description:""}),D=["Geral","Análise ROI","Academy","CRM","Pagamentos","Técnico"],d=[{value:"Baixa",color:"bg-green-500"},{value:"Media",color:"bg-yellow-500"},{value:"Alta",color:"bg-red-500"}],m=[{title:"Guia de Primeiros Passos",description:"Aprenda a usar a plataforma em 5 minutos",icon:X,link:"/academy/getting-started"},{title:"Vídeos Tutoriais",description:"Assista nossos tutoriais em vídeo",icon:Y,link:"/academy/videos"},{title:"Documentação",description:"Documentação completa da API",icon:Z,link:"/docs"}],i=A.filter(s=>{const g=v==="Geral"||s.category===v,C=s.question.toLowerCase().includes(N.toLowerCase())||s.answer.toLowerCase().includes(N.toLowerCase());return g&&C}),x=async s=>{s.preventDefault();const g=await E(o);g.success?(U.success("Ticket criado com sucesso!",{description:"Nossa equipe entrará em contato em até 24 horas."}),u({subject:"",category:"Geral",priority:"Media",description:""})):U.error("Erro ao criar ticket",{description:g.error||"Tente novamente em alguns minutos."})},t=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),p=s=>{switch(s){case"Critica":return"bg-red-100 text-red-800";case"Alta":return"bg-red-100 text-red-800";case"Media":return"bg-yellow-100 text-yellow-800";case"Baixa":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},O=s=>{switch(s){case"Fechado":return"bg-green-100 text-green-800";case"Resolvido":return"bg-green-100 text-green-800";case"Em Andamento":return"bg-yellow-100 text-yellow-800";case"Aberto":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return _?e.jsx("div",{className:"p-6 max-w-[1200px] mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando dados de suporte..."})]})})}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[!1,e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{className:"w-8 h-8 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Central de Suporte"})]}),e.jsx("p",{className:"text-gray-600",children:"Gerencie tickets de suporte e atendimento aos usuários"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Enviar Email"]}),e.jsxs(b,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Novo Ticket"]})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tickets Abertos"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.openTickets}),e.jsxs("p",{className:"text-sm text-gray-500",children:["+",n.todayTickets," hoje"]})]}),e.jsx(K,{className:"w-8 h-8 text-red-600"})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Andamento"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.inProgressTickets}),e.jsxs("p",{className:"text-sm text-gray-500",children:["+",Math.floor(n.todayTickets*.5)," hoje"]})]}),e.jsx(G,{className:"w-8 h-8 text-yellow-600"})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Resolvidos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.resolvedTickets}),e.jsxs("p",{className:"text-sm text-gray-500",children:["+",Math.floor(n.todayTickets*.8)," hoje"]})]}),e.jsx(k,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(l,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[n.averageResponseTime,"h"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"-0.3h hoje"})]}),e.jsx(W,{className:"w-8 h-8 text-blue-600"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(l,{children:e.jsxs(c,{className:"p-6 text-center",children:[e.jsx(B,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Chat ao Vivo"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Suporte instantâneo com nossa equipe"}),e.jsx(b,{className:"w-full",children:"Iniciar Chat"})]})}),e.jsx(l,{children:e.jsxs(c,{className:"p-6 text-center",children:[e.jsx($,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Email"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"support@arca-ai.com"}),e.jsx(b,{variant:"outline",className:"w-full",children:"Enviar Email"})]})}),e.jsx(l,{children:e.jsxs(c,{className:"p-6 text-center",children:[e.jsx(G,{className:"w-12 h-12 text-purple-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Horário de Atendimento"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Seg-Sex: 9h às 18h"}),e.jsx(y,{variant:"outline",children:"Horário de Brasília"})]})})]}),j&&j.length>0&&e.jsxs(l,{className:"mb-8",children:[e.jsx(w,{children:e.jsxs(S,{children:["Tickets Recentes (",j.length," total)"]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:j.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium",children:s.subject}),e.jsx(y,{variant:"outline",className:p(s.priority),children:s.priority}),e.jsx(y,{className:O(s.status),children:s.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["ID: ",s.id.slice(0,8)]}),e.jsxs("span",{children:["Usuário: ",s.user_name]}),e.jsxs("span",{children:["Criado: ",t(s.created_at)]}),s.assigned_to&&e.jsxs("span",{children:["Atribuído: ",s.assigned_to]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.category&&e.jsx(y,{variant:"outline",className:"text-xs",children:s.category})})]},s.id))})})]}),e.jsxs(l,{className:"mb-8",children:[e.jsx(w,{children:e.jsx(S,{children:"Links Úteis"})}),e.jsx(c,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map((s,g)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50 cursor-pointer",children:[e.jsx(s.icon,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]}),e.jsx(ee,{className:"w-4 h-4 text-gray-400"})]},g))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsx("div",{children:e.jsxs(l,{children:[e.jsx(w,{children:e.jsx(S,{children:"Perguntas Frequentes"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(se,{className:"w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(F,{placeholder:"Buscar nas perguntas...",value:N,onChange:s=>I(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:D.map(s=>e.jsx(b,{variant:v===s?"default":"outline",size:"sm",onClick:()=>M(s),children:s},s))}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:i.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:s.question}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.answer}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"outline",className:"text-xs",children:s.category}),s.views&&e.jsxs("span",{className:"text-xs text-gray-500",children:[s.views," visualizações"]})]})]},s.id))}),i.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma pergunta encontrada"})]})]})]})}),e.jsx("div",{children:e.jsxs(l,{children:[e.jsx(w,{children:e.jsx(S,{children:"Criar Ticket de Suporte"})}),e.jsx(c,{children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Assunto"}),e.jsx(F,{value:o.subject,onChange:s=>u({...o,subject:s.target.value}),placeholder:"Descreva brevemente o problema",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Categoria"}),e.jsx("select",{value:o.category,onChange:s=>u({...o,category:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:D.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Prioridade"}),e.jsx("select",{value:o.priority,onChange:s=>u({...o,priority:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:d.map(s=>e.jsx("option",{value:s.value,children:s.value},s.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Descrição"}),e.jsx(J,{value:o.description,onChange:s=>u({...o,description:s.target.value}),placeholder:"Descreva detalhadamente o problema ou dúvida",rows:4,required:!0})]}),e.jsx(b,{type:"submit",className:"w-full",children:"Criar Ticket"})]})})]})})]}),e.jsxs(l,{children:[e.jsx(w,{children:e.jsx(S,{children:"Status do Sistema"})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx(k,{className:"w-6 h-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Plataforma"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Operacional"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx(k,{className:"w-6 h-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"API"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Operacional"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx(k,{className:"w-6 h-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Análise IA"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Operacional"})]})]})]})})]})]})};export{be as default};
