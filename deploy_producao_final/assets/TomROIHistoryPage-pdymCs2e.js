import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as o,e as C}from"./react-vendor-DZvRB87w.js";import{u as ce,s as A,t as h,e as N,C as E,j as u,J as S}from"./index-Df_bSpit.js";import{P as de}from"./plus-Cf9uTjEE.js";import{E as me}from"./eye-CDdGoLC6.js";import{T as pe}from"./trash-2-BjNG5acF.js";import{g as R,R as ge,h as ue,b as O,W as xe,c as fe,C as ve,e as he,i as je,T as Ne,D as ye,j as P,O as Ae,k as De}from"./ui-vendor-Dea2Gxwc.js";import{F as be}from"./file-text-d64qQHtV.js";import{m as we}from"./proxy-CqlErGxY.js";const _e=()=>{const[a,s]=o.useState([]),[t,r]=o.useState(!0),[l,d]=o.useState(!1),[m,v]=o.useState(null),p=C(),{user:i}=ce(),x=o.useCallback(async()=>{if(!i){r(!1);return}try{r(!0);const{data:c,error:f}=await A.from("roi_analises").select("*").eq("user_id",i.id).order("criado_em",{ascending:!1});if(f){console.error("Error fetching analyses:",f),h.error("Erro ao carregar análises"),s([]);return}const y=(c||[]).map(n=>{var D,b,w,_;return{id:n.id,title:n.condominio||"Análise sem título",summary:n.localizacao?`Localização: ${n.localizacao}`:"Sem localização",details:{propertyValue:n.valor_imovel||0,monthlyRent:0,roi:0,location:n.localizacao||"",bedrooms:n.quartos||0,hasPool:n.piscina||!1},createdAt:n.criado_em,propertyData:{condominio:n.condominio||"",localizacao:n.localizacao||"",modelo:n.modelo||"",quartos:((D=n.quartos)==null?void 0:D.toString())||"",piscina:n.piscina||!1,valor_imovel:((b=n.valor_imovel)==null?void 0:b.toString())||"",entrada_valor:((w=n.entrada_valor)==null?void 0:w.toString())||"",entrada_percentual:((_=n.entrada_percentual)==null?void 0:_.toString())||""}}});s(y)}catch(c){console.error("Error in fetchAnalyses:",c),h.error("Erro inesperado ao carregar análises"),s([])}finally{r(!1)}},[i]);o.useEffect(()=>{x()},[x]);const oe=o.useCallback(c=>{v(c),d(!0)},[]),le=o.useCallback(async()=>{if(m)try{const{error:c}=await A.from("roi_analises").delete().eq("id",m).eq("user_id",i==null?void 0:i.id);if(c)throw c;s(f=>f.filter(y=>y.id!==m)),h.success("Análise excluída com sucesso!")}catch(c){console.error("Error deleting analysis:",c),h.error("Erro ao excluir análise")}finally{d(!1),v(null)}},[m,i==null?void 0:i.id]),ie=o.useCallback(c=>{p(`/analise/tom/${c}`)},[p]),ne=o.useCallback(()=>{p("/analise/tom")},[p]);return{analyses:a,loading:t,deleteDialogOpen:l,setDeleteDialogOpen:d,handleDelete:oe,confirmDelete:le,handleView:ie,handleBack:ne,createSampleAnalysis:async()=>{if(i)try{const c={user_id:i.id,condominio:"Residencial Exemplo",localizacao:"São Paulo, SP",valor_imovel:35e4,entrada_valor:7e4,entrada_percentual:20,piscina:!0,garagem:2,modelo:"Apartamento",quartos:3,tipo_investimento:"compra"},{error:f}=await A.from("roi_analises").insert([c]);if(f)throw f;x(),h.success("Análise de exemplo criada!")}catch(c){console.error("Error creating sample analysis:",c),h.error("Erro ao criar exemplo")}},fetchAnalyses:x}},Ce=()=>{const a=C();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Minhas Análises de ROI"}),e.jsx("p",{className:"text-gray-500",children:"Histórico de análises de retorno sobre investimento"})]}),e.jsxs(N,{onClick:()=>a("/analise/tom"),className:"flex items-center gap-2",children:[e.jsx(de,{size:16}),"Nova Análise"]})]})},Ee=({analysis:a,onView:s,onDelete:t})=>{const r=d=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d),l=d=>new Date(d).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"});return e.jsxs(E,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.title}),e.jsx("p",{className:"text-gray-500",children:a.summary})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>s(a.id),className:"flex items-center gap-1",children:[e.jsx(me,{size:16}),"Ver"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>t(a.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700",children:[e.jsx(pe,{size:16}),"Excluir"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Valor do Imóvel"}),e.jsx("p",{className:"font-semibold",children:r(a.details.propertyValue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Quartos"}),e.jsx("p",{className:"font-semibold",children:a.details.bedrooms||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Data da Análise"}),e.jsx("p",{className:"font-semibold",children:l(a.createdAt)})]})]})]})};var T="AlertDialog",[Se,ta]=fe(T,[R]),g=R(),z=a=>{const{__scopeAlertDialog:s,...t}=a,r=g(s);return e.jsx(ge,{...r,...t,modal:!0})};z.displayName=T;var Re="AlertDialogTrigger",Oe=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,l=g(t);return e.jsx(De,{...l,...r,ref:s})});Oe.displayName=Re;var Pe="AlertDialogPortal",I=a=>{const{__scopeAlertDialog:s,...t}=a,r=g(s);return e.jsx(ue,{...r,...t})};I.displayName=Pe;var Te="AlertDialogOverlay",k=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,l=g(t);return e.jsx(Ae,{...l,...r,ref:s})});k.displayName=Te;var j="AlertDialogContent",[ze,Ie]=Se(j),ke=je("AlertDialogContent"),$=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,children:r,...l}=a,d=g(t),m=o.useRef(null),v=O(s,m),p=o.useRef(null);return e.jsx(xe,{contentName:j,titleName:M,docsSlug:"alert-dialog",children:e.jsx(ze,{scope:t,cancelRef:p,children:e.jsxs(ve,{role:"alertdialog",...d,...l,ref:v,onOpenAutoFocus:he(l.onOpenAutoFocus,i=>{var x;i.preventDefault(),(x=p.current)==null||x.focus({preventScroll:!0})}),onPointerDownOutside:i=>i.preventDefault(),onInteractOutside:i=>i.preventDefault(),children:[e.jsx(ke,{children:r}),e.jsx(Me,{contentRef:m})]})})})});$.displayName=j;var M="AlertDialogTitle",V=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,l=g(t);return e.jsx(Ne,{...l,...r,ref:s})});V.displayName=M;var q="AlertDialogDescription",H=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,l=g(t);return e.jsx(ye,{...l,...r,ref:s})});H.displayName=q;var $e="AlertDialogAction",F=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,l=g(t);return e.jsx(P,{...l,...r,ref:s})});F.displayName=$e;var L="AlertDialogCancel",B=o.forwardRef((a,s)=>{const{__scopeAlertDialog:t,...r}=a,{cancelRef:l}=Ie(L,t),d=g(t),m=O(s,l);return e.jsx(P,{...d,...r,ref:m})});B.displayName=L;var Me=({contentRef:a})=>{const s=`\`${j}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${j}\` by passing a \`${q}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${j}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{var r;document.getElementById((r=a.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(s)},[s,a]),null},Ve=z,qe=I,G=k,W=$,U=F,Y=B,J=V,Q=H;const He=Ve,Fe=qe,K=o.forwardRef(({className:a,...s},t)=>e.jsx(G,{className:u("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t}));K.displayName=G.displayName;const X=o.forwardRef(({className:a,...s},t)=>e.jsxs(Fe,{children:[e.jsx(K,{}),e.jsx(W,{ref:t,className:u("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]}));X.displayName=W.displayName;const Z=({className:a,...s})=>e.jsx("div",{className:u("flex flex-col space-y-2 text-center sm:text-left",a),...s});Z.displayName="AlertDialogHeader";const ee=({className:a,...s})=>e.jsx("div",{className:u("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s});ee.displayName="AlertDialogFooter";const ae=o.forwardRef(({className:a,...s},t)=>e.jsx(J,{ref:t,className:u("text-lg font-semibold",a),...s}));ae.displayName=J.displayName;const se=o.forwardRef(({className:a,...s},t)=>e.jsx(Q,{ref:t,className:u("text-sm text-muted-foreground",a),...s}));se.displayName=Q.displayName;const te=o.forwardRef(({className:a,...s},t)=>e.jsx(U,{ref:t,className:u(S(),a),...s}));te.displayName=U.displayName;const re=o.forwardRef(({className:a,...s},t)=>e.jsx(Y,{ref:t,className:u(S({variant:"outline"}),"mt-2 sm:mt-0",a),...s}));re.displayName=Y.displayName;const Le=({open:a,onOpenChange:s,onConfirm:t})=>e.jsx(He,{open:a,onOpenChange:s,children:e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx(ae,{children:"Excluir Análise"}),e.jsx(se,{children:"Tem certeza que deseja excluir esta análise? Esta ação não pode ser desfeita."})]}),e.jsxs(ee,{children:[e.jsx(re,{children:"Cancelar"}),e.jsx(te,{onClick:t,className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})}),Be=({onCreateNew:a})=>e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-gray-100 rounded-full",children:e.jsx(be,{size:32,className:"text-gray-400"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma análise encontrada"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Você ainda não realizou nenhuma análise de ROI. Comece criando uma nova análise agora."}),e.jsx(N,{onClick:a,children:"Criar Nova Análise"})]}),Ge=()=>e.jsx("div",{className:"space-y-4",children:[1,2,3].map(a=>e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 w-32 bg-gray-200 rounded"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-8 w-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-8 w-16 bg-gray-200 rounded"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"})]})]})]})},a))}),We=()=>{const{analyses:a,loading:s,deleteDialogOpen:t,setDeleteDialogOpen:r,handleDelete:l,confirmDelete:d,handleView:m,handleBack:v}=_e();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ce,{}),e.jsx("div",{className:"space-y-4",children:s?e.jsx(Ge,{}):a.length===0?e.jsx(Be,{onCreateNew:v}):a.map(p=>e.jsx(Ee,{analysis:p,onView:m,onDelete:l},p.id))}),e.jsx(Le,{open:t,onOpenChange:r,onConfirm:d})]})},ra=()=>e.jsx(we.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"p-6 max-w-[1200px] mx-auto",children:e.jsx(We,{})});export{ra as default};
