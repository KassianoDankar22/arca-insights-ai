import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as n}from"./react-vendor-DZvRB87w.js";import{j as h,X as ne,T as ce,e as m,v as de,C as $,d as z,a as me,b as xe,y as I,K as k,z as H,B as x}from"./index-Df_bSpit.js";import{I as he}from"./input-BaSgXdNs.js";import{T as ge}from"./textarea-BJ6UY1e9.js";import{T as ue,a as je,b as V,c,d as pe,e as d}from"./table-CfxSGWBn.js";import{S as y,a as b,b as w,c as C,d as r}from"./select-DWYjgQBo.js";import{D as fe,a as ve,b as Ne,c as T,d as ye}from"./dropdown-menu-DPYtsa-V.js";import{R as be,k as we,h as Ce,C as G,j as Te,T as K,D as X,O as J}from"./ui-vendor-Dea2Gxwc.js";import{a as Se}from"./useRealData-BiNFJK86.js";import{C as De}from"./clock-CpRAHura.js";import{C as O}from"./circle-check-big-BbmS712-.js";import{T as _e}from"./trending-up-D6UT933U.js";import{L as Re}from"./loader-circle-Dnz5ZzbO.js";import{M as U}from"./mail-DzfX9Lve.js";import{m as Ae}from"./proxy-CqlErGxY.js";import{S as Ee}from"./search-BHIbFhxn.js";import{E as Be}from"./ellipsis-DtsklKbr.js";import{E as Me}from"./eye-CDdGoLC6.js";import{U as Fe}from"./user-Ddd9JpRl.js";import{S as Le}from"./send-GbuuznKv.js";import"./index-v7iOeiPF.js";import"./chevron-down-Bc7oyTHl.js";import"./check-Cr6J53Lh.js";import"./chevron-up-BR0CPyY0.js";import"./chevron-right-BDoRpBXC.js";import"./circle-Ldu75Sri.js";const q=be,Pe=we,$e=Ce,Q=n.forwardRef(({className:l,...i},o)=>e.jsx(J,{ref:o,className:h("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",l),...i}));Q.displayName=J.displayName;const W=n.forwardRef(({className:l,children:i,...o},u)=>e.jsxs($e,{children:[e.jsx(Q,{}),e.jsxs(G,{ref:u,className:h("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",l),...o,children:[i,e.jsxs(Te,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));W.displayName=G.displayName;const Y=({className:l,...i})=>e.jsx("div",{className:h("flex flex-col space-y-1.5 text-center sm:text-left",l),...i});Y.displayName="DialogHeader";const Z=n.forwardRef(({className:l,...i},o)=>e.jsx(K,{ref:o,className:h("text-lg font-semibold leading-none tracking-tight",l),...i}));Z.displayName=K.displayName;const ee=n.forwardRef(({className:l,...i},o)=>e.jsx(X,{ref:o,className:h("text-sm text-muted-foreground",l),...i}));ee.displayName=X.displayName;const ms=()=>{const[l,i]=n.useState(""),[o,u]=n.useState("all"),[j,se]=n.useState("all"),[p,ae]=n.useState("all"),[t,f]=n.useState(null),[v,S]=n.useState(""),{tickets:D,stats:g,loading:_,error:R}=Se(),N=D.filter(s=>{const a=s.title.toLowerCase().includes(l.toLowerCase())||s.user_profiles.name.toLowerCase().includes(l.toLowerCase())||s.user_profiles.email.toLowerCase().includes(l.toLowerCase()),le=o==="all"||s.status===o,ie=j==="all"||s.priority===j,oe=p==="all"||s.category===p;return a&&le&&ie&&oe}),te=[{title:"Tickets Abertos",value:g.open.toString(),change:"+3 hoje",icon:ce,color:"red"},{title:"Em Andamento",value:g.inProgress.toString(),change:"+2 hoje",icon:De,color:"yellow"},{title:"Resolvidos",value:g.resolved.toString(),change:"+8 hoje",icon:O,color:"green"},{title:"Tempo Médio",value:g.avgTime,change:"-0.3h",icon:_e,color:"blue"}],A=s=>{const a={tecnico:"bg-blue-100 text-blue-800",comercial:"bg-green-100 text-green-800",sugestao:"bg-purple-100 text-purple-800",bug:"bg-red-100 text-red-800"};return a[s]||a.tecnico},E=s=>{const a={baixa:"bg-gray-100 text-gray-800",media:"bg-yellow-100 text-yellow-800",alta:"bg-orange-100 text-orange-800",critica:"bg-red-100 text-red-800"};return a[s]||a.media},B=s=>{const a={aberto:"bg-red-100 text-red-800",em_andamento:"bg-yellow-100 text-yellow-800",resolvido:"bg-green-100 text-green-800",fechado:"bg-gray-100 text-gray-800"};return a[s]||a.aberto},M=s=>({tecnico:"Técnico",comercial:"Comercial",sugestao:"Sugestão",bug:"Bug"})[s]||s,F=s=>({baixa:"Baixa",media:"Média",alta:"Alta",critica:"Crítica"})[s]||s,L=s=>({aberto:"Aberto",em_andamento:"Em Andamento",resolvido:"Resolvido",fechado:"Fechado"})[s]||s,P=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),re=()=>{console.log("Enviando resposta:",v),S(""),f(null)};return _?e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(Re,{className:"w-8 h-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Carregando tickets..."})]})}):R?e.jsx("div",{className:"p-6 max-w-7xl mx-auto",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx("p",{children:R}),e.jsx(m,{onClick:()=>window.location.reload(),className:"mt-4",children:"Tentar Novamente"})]})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Suporte"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie tickets de suporte e atendimento aos usuários"})]}),e.jsxs("div",{className:"mt-4 lg:mt-0 flex items-center gap-3",children:[e.jsxs(m,{variant:"outline",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Enviar Email"]}),e.jsxs(m,{variant:"arca",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Novo Ticket"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:te.map((s,a)=>e.jsx(Ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1},children:e.jsx($,{children:e.jsx(z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:s.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.value}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.change})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${s.color}-100`,children:e.jsx(s.icon,{className:`w-6 h-6 text-${s.color}-600`})})]})})})},s.title))}),e.jsxs($,{children:[e.jsx(me,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs(xe,{children:["Tickets de Suporte (",N.length," total)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(he,{placeholder:"Buscar tickets...",value:l,onChange:s=>i(s.target.value),className:"pl-10 w-64"})]}),e.jsxs(y,{value:o,onValueChange:u,children:[e.jsx(b,{className:"w-32",children:e.jsx(w,{placeholder:"Status"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"Todos"}),e.jsx(r,{value:"aberto",children:"Aberto"}),e.jsx(r,{value:"em_andamento",children:"Em Andamento"}),e.jsx(r,{value:"resolvido",children:"Resolvido"}),e.jsx(r,{value:"fechado",children:"Fechado"})]})]}),e.jsxs(y,{value:j,onValueChange:se,children:[e.jsx(b,{className:"w-32",children:e.jsx(w,{placeholder:"Prioridade"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"Todas"}),e.jsx(r,{value:"baixa",children:"Baixa"}),e.jsx(r,{value:"media",children:"Média"}),e.jsx(r,{value:"alta",children:"Alta"}),e.jsx(r,{value:"critica",children:"Crítica"})]})]}),e.jsxs(y,{value:p,onValueChange:ae,children:[e.jsx(b,{className:"w-32",children:e.jsx(w,{placeholder:"Categoria"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"Todas"}),e.jsx(r,{value:"tecnico",children:"Técnico"}),e.jsx(r,{value:"comercial",children:"Comercial"}),e.jsx(r,{value:"sugestao",children:"Sugestão"}),e.jsx(r,{value:"bug",children:"Bug"})]})]})]})]})}),e.jsxs(z,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(ue,{children:[e.jsx(je,{children:e.jsxs(V,{children:[e.jsx(c,{children:"Ticket"}),e.jsx(c,{children:"Usuário"}),e.jsx(c,{children:"Categoria"}),e.jsx(c,{children:"Prioridade"}),e.jsx(c,{children:"Status"}),e.jsx(c,{children:"Responsável"}),e.jsx(c,{children:"Atualizado"}),e.jsx(c,{className:"w-[70px]",children:"Ações"})]})}),e.jsx(pe,{children:N.map(s=>e.jsxs(V,{children:[e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",s.id," • ",s.message_count," mensagens"]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{className:"h-8 w-8",children:[e.jsx(k,{src:s.user_profiles.avatar_url}),e.jsx(H,{children:s.user_profiles.name.split(" ").map(a=>a[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.user_profiles.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.user_profiles.email})]})]})}),e.jsx(d,{children:e.jsx(x,{className:`${A(s.category)} border-0`,children:M(s.category)})}),e.jsx(d,{children:e.jsx(x,{className:`${E(s.priority)} border-0`,children:F(s.priority)})}),e.jsx(d,{children:e.jsx(x,{className:`${B(s.status)} border-0`,children:L(s.status)})}),e.jsx(d,{children:e.jsx("span",{className:"text-sm text-gray-600",children:s.assigned_to||"Não atribuído"})}),e.jsx(d,{children:P(s.updated_at)}),e.jsx(d,{children:e.jsxs(fe,{children:[e.jsx(ve,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(Be,{className:"w-4 h-4"})})}),e.jsxs(Ne,{align:"end",children:[e.jsx(q,{children:e.jsx(Pe,{asChild:!0,children:e.jsxs(T,{onSelect:a=>{a.preventDefault(),f(s)},children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Ver Detalhes"]})})}),e.jsxs(T,{children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Atribuir"]}),e.jsx(ye,{}),e.jsxs(T,{children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Enviar Email"]})]})]})})]},s.id))})]})}),N.length===0&&!_&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:D.length===0?"Nenhum ticket de suporte":"Nenhum ticket encontrado com os filtros aplicados"})})]})]}),t&&e.jsx(q,{open:!!t,onOpenChange:()=>f(null),children:e.jsxs(W,{className:"max-w-2xl",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:t.title}),e.jsxs(ee,{children:["Ticket #",t.id," • ",P(t.created_at)]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:`${A(t.category)} border-0`,children:M(t.category)}),e.jsx(x,{className:`${E(t.priority)} border-0`,children:F(t.priority)}),e.jsx(x,{className:`${B(t.status)} border-0`,children:L(t.status)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Descrição:"}),e.jsx("p",{className:"text-gray-600",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{className:"h-10 w-10",children:[e.jsx(k,{src:t.user_profiles.avatar_url}),e.jsx(H,{children:t.user_profiles.name.split(" ").map(s=>s[0]).join("")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.user_profiles.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.user_profiles.email})]})]}),t.last_message&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Última mensagem:"}),e.jsx("p",{className:"text-gray-600",children:t.last_message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Responder:"}),e.jsx(ge,{placeholder:"Digite sua resposta...",value:v,onChange:s=>S(s.target.value),rows:4}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"arca",onClick:re,disabled:!v.trim(),children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Enviar Resposta"]}),e.jsxs(m,{variant:"outline",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Resolver Ticket"]})]})]})]})]})})]})};export{ms as default};
