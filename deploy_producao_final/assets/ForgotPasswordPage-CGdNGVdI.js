import{j as e}from"./supabase-vendor-vwXl956e.js";import{r as t,e as L}from"./react-vendor-DZvRB87w.js";import{L as x,C as u,a as g,b as j,c as f,d as b,i as N,e as l,A as F,t as i,s as w}from"./index-DpL_m2zY.js";import{I}from"./input-DGm6H34X.js";import{A as v,a as D}from"./AnimatedBorderInput-DGVD0-HQ.js";import{m as y}from"./proxy-CqlErGxY.js";import{K as c}from"./key-CZZZlNpk.js";import{C}from"./circle-alert-CuOU8fz6.js";import{L as G}from"./loader-circle-DRQIsUld.js";import"./ui-vendor-Dea2Gxwc.js";const Q=()=>{const[s,k]=t.useState(""),[d,o]=t.useState(!1),[m,S]=t.useState(""),[P,T]=t.useState(!1),h=L(),z=()=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(let n=0;n<8;n++)r+=a.charAt(Math.floor(Math.random()*a.length));return"Temp"+r},A=async()=>{if(!s){i.error("Por favor, insira seu email");return}o(!0);try{const{data:a}=await w.from("usuarios").select("id").eq("email",s).single();if(!a){i.error("Email não encontrado no sistema"),o(!1);return}const r=z(),{data:n,error:p}=await w.functions.invoke("reset-user-password",{body:{userId:a.id,newPassword:r,userEmail:s}});if(p)throw p;S(r),T(!0),i.success("Senha temporária gerada com sucesso!")}catch(a){console.error("Erro ao gerar senha temporária:",a),i.error("Não foi possível gerar senha temporária. Entre em contato com o suporte.")}finally{o(!1)}},E=()=>{navigator.clipboard.writeText(m),i.success("Senha copiada para a área de transferência!")};return P?e.jsx(v,{children:e.jsxs(y.div,{className:"w-full max-w-md p-4 z-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsx("div",{className:"flex justify-center mb-10",children:e.jsx(x,{className:"h-20"})}),e.jsxs(u,{className:"backdrop-blur-sm bg-white/90 dark:bg-zinc-900/80 shadow-xl border-white/20 dark:border-zinc-700/30",children:[e.jsxs(g,{children:[e.jsx(j,{className:"text-center",children:"Senha Temporária Gerada"}),e.jsx(f,{className:"text-center",children:"Use esta senha para fazer login e depois altere para uma senha de sua preferência"})]}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(c,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"Sua nova senha temporária:"})]}),e.jsx("div",{className:"bg-white p-3 rounded border font-mono text-lg tracking-wider text-center border-dashed border-green-300",children:m})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-blue-800 text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Próximos passos:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsx("li",{children:"Copie a senha acima"}),e.jsx("li",{children:"Vá para a tela de login"}),e.jsxs("li",{children:["Use seu email: ",e.jsx("strong",{children:s})]}),e.jsx("li",{children:"Digite a senha temporária"}),e.jsx("li",{children:"Após o login, vá em Configurações para alterar sua senha"})]})]})]})})]}),e.jsxs(N,{className:"flex flex-col space-y-3",children:[e.jsxs(l,{onClick:E,className:"w-full bg-green-600 hover:bg-green-700",children:[e.jsx(c,{className:"mr-2 h-4 w-4"}),"Copiar Senha"]}),e.jsx(l,{onClick:()=>h("/login"),className:"w-full",children:"Ir para Login"})]})]})]})}):e.jsx(v,{children:e.jsxs(y.div,{className:"w-full max-w-md p-4 z-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsx("div",{className:"flex justify-center mb-10",children:e.jsx(x,{className:"h-20"})}),e.jsxs(u,{className:"backdrop-blur-sm bg-white/90 dark:bg-zinc-900/80 shadow-xl border-white/20 dark:border-zinc-700/30",children:[e.jsxs(g,{children:[e.jsx(j,{children:"Recuperar Senha"}),e.jsx(f,{children:"Digite seu email para gerar uma nova senha temporária"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),e.jsx(D,{children:e.jsx(I,{id:"email",type:"email",placeholder:"seu@email.com",value:s,onChange:a=>k(a.target.value),required:!0,className:"border-0 focus-visible:ring-0 bg-transparent"})})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-blue-800 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Como funciona:"}),e.jsx("p",{children:"Será gerada uma senha temporária que você poderá usar imediatamente para fazer login. Depois, altere para uma senha de sua preferência."})]})]})})]}),e.jsxs(N,{className:"flex flex-col space-y-3",children:[e.jsx(l,{onClick:A,className:"w-full",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Gerando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"mr-2 h-4 w-4"}),"Gerar Nova Senha"]})}),e.jsxs(l,{type:"button",variant:"ghost",className:"w-full",onClick:()=>h("/login"),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Voltar para Login"]})]})]})]})})};export{Q as default};
