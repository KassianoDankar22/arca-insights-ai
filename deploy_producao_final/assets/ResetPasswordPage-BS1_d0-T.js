import{j as a}from"./supabase-vendor-vwXl956e.js";import{r as i,e as P,j as z}from"./react-vendor-DZvRB87w.js";import{t as e,L as h,C as u,a as x,b as p,c as f,i as j,e as l,d as L,A,s as _}from"./index-DpL_m2zY.js";import{I as g}from"./input-DGm6H34X.js";import{A as w,a as b}from"./AnimatedBorderInput-DGVD0-HQ.js";import{m as v}from"./proxy-CqlErGxY.js";import{L as F}from"./loader-circle-DRQIsUld.js";import{L as E}from"./lock-CHnASIte.js";import"./ui-vendor-Dea2Gxwc.js";const U=()=>{const[r,N]=i.useState(""),[t,y]=i.useState(""),[c,d]=i.useState(!1),[k,C]=i.useState(!0),n=P(),[m]=z();i.useEffect(()=>{m.get("token")||(C(!1),e.error("Link de recuperação inválido ou expirado"))},[m]);const S=async s=>{if(s.preventDefault(),!r||!t){e.error("Por favor, preencha todos os campos");return}if(r!==t){e.error("As senhas não coincidem");return}if(r.length<6){e.error("A senha deve ter pelo menos 6 caracteres");return}d(!0);try{const{error:o}=await _.auth.updateUser({password:r});if(o)throw o;e.success("Senha atualizada com sucesso!"),n("/login",{state:{message:"Sua senha foi atualizada com sucesso. Faça login com sua nova senha."}})}catch(o){console.error("Erro ao atualizar senha:",o),e.error(o.message||"Erro ao atualizar senha")}finally{d(!1)}};return k?a.jsx(w,{children:a.jsxs(v.div,{className:"w-full max-w-md p-4 z-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("div",{className:"flex justify-center mb-10",children:a.jsx(h,{className:"h-20"})}),a.jsxs(u,{className:"backdrop-blur-sm bg-white/90 dark:bg-zinc-900/80 shadow-xl border-white/20 dark:border-zinc-700/30",children:[a.jsxs(x,{children:[a.jsx(p,{children:"Nova Senha"}),a.jsx(f,{children:"Digite sua nova senha abaixo"})]}),a.jsxs("form",{onSubmit:S,children:[a.jsxs(L,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"newPassword",className:"text-sm font-medium",children:"Nova Senha"}),a.jsx(b,{children:a.jsx(g,{id:"newPassword",type:"password",placeholder:"Digite sua nova senha",value:r,onChange:s=>N(s.target.value),required:!0,className:"border-0 focus-visible:ring-0 bg-transparent"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Confirmar Nova Senha"}),a.jsx(b,{children:a.jsx(g,{id:"confirmPassword",type:"password",placeholder:"Confirme sua nova senha",value:t,onChange:s=>y(s.target.value),required:!0,className:"border-0 focus-visible:ring-0 bg-transparent"})})]})]}),a.jsxs(j,{className:"flex flex-col space-y-4",children:[a.jsx(l,{type:"submit",className:"w-full shadow-[0_4px_14px_0_rgb(0,118,255,39%)] hover:shadow-[0_6px_20px_rgba(0,118,255,23%)] hover:bg-[rgba(0,118,255,0.9)] px-8 py-2 bg-[#0070f3] rounded-md text-white font-light transition duration-200 ease-linear",disabled:c,children:c?a.jsxs(a.Fragment,{children:[a.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"Atualizando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(E,{className:"mr-2 h-4 w-4"}),"Atualizar Senha"]})}),a.jsxs(l,{type:"button",variant:"ghost",className:"w-full",onClick:()=>n("/login"),children:[a.jsx(A,{className:"mr-2 h-4 w-4"}),"Voltar para Login"]})]})]})]})]})}):a.jsx(w,{children:a.jsxs(v.div,{className:"w-full max-w-md p-4 z-10",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("div",{className:"flex justify-center mb-10",children:a.jsx(h,{className:"h-20"})}),a.jsxs(u,{className:"backdrop-blur-sm bg-white/90 dark:bg-zinc-900/80 shadow-xl border-white/20 dark:border-zinc-700/30",children:[a.jsxs(x,{children:[a.jsx(p,{children:"Link Inválido"}),a.jsx(f,{children:"O link de recuperação de senha é inválido ou expirou."})]}),a.jsx(j,{children:a.jsx(l,{type:"button",className:"w-full",onClick:()=>n("/forgot-password"),children:"Solicitar Novo Link"})})]})]})})};export{U as default};
